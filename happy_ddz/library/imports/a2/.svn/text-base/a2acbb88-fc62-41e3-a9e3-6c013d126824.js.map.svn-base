{"version":3,"sources":["../../../../../../assets/Script/hall/utils/assets/Script/hall/utils/LoginBtnManager.js"],"names":["hall","loginBtnManager","showLoginBtn","btnWidth","btnHeight","btnToBottom","canShowUserInfoBtn","sysInfo","wx","getSystemInfoSync","screenWidth","screenHeight","bi","button","createUserInfoButton","type","image","ty","SystemInfo","cdnPath","style","left","top","width","height","show","onTap","res","ddz","LOGD","JSON","stringify","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeAuthorizationStart","errMsg","hide","destroyHideBtn","destroyTableBtn","wxUserInfo","NotificationCenter","trigger","EventType","GET_USER_INFO","clickStatEventTypeAuthorizationSuccess","clickStatEventTypeAuthorizationFailed","oldAuhor","hasOwnProperty","showHideAuthorizeBtn","callFun","btnToLeft","hideButton","TuyooSDK","wechatLogin","showTableAuthorizeBtn","TableButton","LOCATION_SIGN","SELF","tableAuthor","onlyAuthorizeAndLogin","authorize","scope","success","fail","START_AUTHORIZATION_FAILED","needReLogin","complete"],"mappings":"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","file":"LoginBtnManager.js","sourceRoot":"../../../../../../assets/Script/hall/utils","sourcesContent":["/**\n * Created by xujing on 2018/5/30.\n * 登录按钮管理类\n */\nhall.loginBtnManager = {\n\n    showLoginBtn:function () {\n\n        var btnWidth = 390;\n        var btnHeight = 119;\n        var btnToBottom = 140;\n\n        if (this.canShowUserInfoBtn()){\n\n            var sysInfo = wx.getSystemInfoSync();\n            var screenWidth = sysInfo.screenWidth;\n            var screenHeight = sysInfo.screenHeight;\n\n            var bi = screenWidth/640;\n\n            btnWidth = 390 * bi;\n            btnHeight = 119 * bi;\n\n            var button = wx.createUserInfoButton({\n                type: 'image',\n                // text: '进入游戏',\n                image : ty.SystemInfo.cdnPath + 'res/raw-assets/resources/main/loginBtn.png',\n                style: {\n                    left: (screenWidth - btnWidth)/2,\n                    top: screenHeight - btnHeight/2 - btnToBottom,\n                    width: btnWidth,\n                    height: btnHeight\n                }\n            });\n\n            button.show();\n\n            button.onTap(function (res) {\n                ddz.LOGD('UserInfoButton onTap ',JSON.stringify(res));\n                // ty.TuyooSDK.login();\n                //{\"errMsg\":\"getUserInfo:fail auth deny\"} 拒绝\n                //{\"errMsg\":\"getUserInfo:ok  接受\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationStart, ['授权开始!']);\n                if (res.errMsg == 'getUserInfo:ok'){\n                    //接受\n                    button.hide();\n                    hall.loginBtnManager.destroyHideBtn();\n                    hall.loginBtnManager.destroyTableBtn();\n                    ty.wxUserInfo = true;\n                    ty.NotificationCenter.trigger(ddz.EventType.GET_USER_INFO, true);\n                    ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationSuccess, ['授权成功!']);\n                }\n                else{\n                    ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationFailed, ['授权失败']);\n                }\n            });\n        }\n        else{\n            // var btnLogin = new cc.Node('Sprite');\n            // var sp = btnLogin.addComponent(cc.Sprite);\n            //\n            // var containerRect = cc.rect(0, 0, btnWidth, btnHeight);\n            //\n            // cc.eventManager.addListener({\n            //     event: cc.EventListener.TOUCH_ONE_BY_ONE,\n            //     swallowTouches: true,\n            //     onTouchBegan: function(touch, event) {\n            //         var pos = btnLogin.convertToNodeSpace(touch.getLocation());\n            //         return cc.rectContainsPoint(containerRect, pos);\n            //     },\n            //     onTouchEnded: function(touch, event) {\n            //         ddz.LOGD('hall.loginBtnManager ','进入游戏按钮点击');\n            //         ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationStart, ['授权开始!']);\n            //         wx.getUserInfo({\n            //             withCredentials:true,\n            //             success: function(res) {\n            //                 ddz.LOGD('wx.getUserInfo ','授权成功!');\n            //                 ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationSuccess, ['授权成功!']);\n            //                 // ty.TuyooSDK.loginTuyooWithCode(code, res.userInfo, res.iv, res.encryptedData);\n            //                 ty.wxUserInfo = true;\n            //                 ty.NotificationCenter.trigger(ddz.EventType.GET_USER_INFO, res);\n            //                 btnLogin.destroy();\n            //             },\n            //             fail:function (res) {\n            //                 ddz.LOGD('wx.getUserInfo ','授权失败!');\n            //                 ty.NotificationCenter.trigger(ddz.EventType.START_AUTHORIZATION_FAILED);\n            //                 ddz.needReLogin = true;\n            //                 hall.MsgBoxManager.showToast({title : \"授权失败,请手动进行授权!\"});\n            //                 ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationFailed, ['授权失败']);\n            //             }\n            //         });\n            //\n            //     },\n            //     onTouchMoved: function(touch, event) {\n            //\n            //     }\n            // }, btnLogin);\n            //\n            // cc.loader.load({url: ty.SystemInfo.cdnPath + 'res/raw-assets/resources/main/loginBtn.png', type: 'png'}, function (err, texture) {\n            //     if (!err) {\n            //         sp.spriteFrame =  new cc.SpriteFrame(texture);\n            //         btnLogin.x = 320;\n            //         btnLogin.y = btnHeight/2 + btnToBottom;\n            //         btnLogin.parent = cc.director.getScene();\n            //     }\n            //     else {\n            //         //加载失败\n            //     }\n            // });\n            //\n            // this.btnLogin = btnLogin;\n            this.oldAuhor();\n        }\n    },\n\n    /**\n     * 是否可以显示授权按钮\n     * @returns {boolean}\n     */\n    canShowUserInfoBtn:function () {\n        return wx.hasOwnProperty('createUserInfoButton');\n    },\n\n    /**\n     * 显示隐藏的授权按钮\n     */\n    showHideAuthorizeBtn:function (callFun) {\n\n        var btnWidth = 160;\n        var btnHeight = 120;\n        var btnToLeft = 160;\n\n        if (this.canShowUserInfoBtn()){\n\n            var sysInfo = wx.getSystemInfoSync();\n            var screenWidth = sysInfo.screenWidth;\n            var screenHeight = sysInfo.screenHeight;\n\n            var bi = screenWidth/640;\n\n            btnWidth = btnWidth * bi;\n            btnHeight = btnHeight * bi;\n\n            hall.loginBtnManager.hideButton = wx.createUserInfoButton({\n                type: 'image',\n                image : ty.SystemInfo.cdnPath + 'res/raw-assets/resources/main/hidebtn.png?3',\n                style: {\n                    left: screenWidth - btnWidth - btnToLeft * bi,\n                    top: screenHeight - btnHeight,\n                    width: btnWidth,\n                    height: btnHeight\n                }\n            });\n\n            hall.loginBtnManager.hideButton.show();\n\n            hall.loginBtnManager.hideButton.onTap(function (res) {\n                ddz.LOGD('UserInfoButton onTap ',JSON.stringify(res));\n                // ty.TuyooSDK.login();\n                //{\"errMsg\":\"getUserInfo:fail auth deny\"} 拒绝\n                //{\"errMsg\":\"getUserInfo:ok  接受\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationStart, ['授权开始!']);\n                if (res.errMsg == 'getUserInfo:ok'){\n                    //接受\n                    if (callFun){\n                        callFun();\n                    }\n                    hall.loginBtnManager.destroyHideBtn();\n                    ty.wxUserInfo = true;\n                    // ty.NotificationCenter.trigger(ddz.EventType.GET_USER_INFO, false);\n                    ty.TuyooSDK.wechatLogin();\n                    ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationSuccess, ['授权成功!']);\n                }\n                else{\n                    ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationFailed, ['授权失败']);\n                }\n            });\n        }\n    },\n\n    destroyHideBtn:function () {\n        if (hall.loginBtnManager.hideButton){\n            hall.loginBtnManager.hideButton.hide();\n            hall.loginBtnManager.hideButton = null;\n        }\n    },\n\n    /**\n     * 显示隐藏的授权按钮\n     */\n    showTableAuthorizeBtn:function (callFun) {\n\n        var btnWidth = 150;\n        var btnHeight = 120;\n        var btnToBottom = 120;\n\n        if (this.canShowUserInfoBtn()){\n\n            var sysInfo = wx.getSystemInfoSync();\n            var screenWidth = sysInfo.screenWidth;\n            var screenHeight = sysInfo.screenHeight;\n\n            var bi = screenWidth/640;\n\n            btnWidth = btnWidth * bi;\n            btnHeight = btnHeight * bi;\n\n            hall.loginBtnManager.TableButton = wx.createUserInfoButton({\n                type: 'image',\n                image : ty.SystemInfo.cdnPath + 'res/raw-assets/resources/main/hidebtn.png?3',\n                style: {\n                    left: 0,\n                    top: screenHeight - btnHeight - btnToBottom * bi,\n                    width: btnWidth,\n                    height: btnHeight\n                }\n            });\n\n            hall.loginBtnManager.TableButton.show();\n\n            hall.loginBtnManager.TableButton.onTap(function (res) {\n                ddz.LOGD('UserInfoButton onTap ',JSON.stringify(res));\n                // ty.TuyooSDK.login();\n                //{\"errMsg\":\"getUserInfo:fail auth deny\"} 拒绝\n                //{\"errMsg\":\"getUserInfo:ok  接受\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationStart, ['授权开始!','table']);\n                if (res.errMsg == 'getUserInfo:ok'){\n                    //接受\n                    if (callFun){\n                        callFun(ddz.LOCATION_SIGN.SELF);\n                    }\n                    hall.loginBtnManager.destroyTableBtn();\n                    ty.wxUserInfo = true;\n                    ty.tableAuthor = true;\n                    // ty.NotificationCenter.trigger(ddz.EventType.GET_USER_INFO, false);\n                    ty.TuyooSDK.wechatLogin();\n                    ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationSuccess, ['授权成功!','table']);\n                }\n                else{\n                    ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationFailed, ['授权失败','table']);\n                }\n            });\n        }\n    },\n\n    destroyTableBtn:function () {\n        if (hall.loginBtnManager.TableButton){\n            hall.loginBtnManager.TableButton.hide();\n            hall.loginBtnManager.TableButton = null;\n        }\n    },\n\n\n\n    onlyAuthorizeAndLogin:function (callFun) {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationStart, ['授权开始!']);\n        wx.authorize({\n            scope : \"scope.userInfo\",\n            success : function () {\n                if (callFun){\n                    callFun();\n                }\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationSuccess, ['授权成功!']);\n                ty.wxUserInfo = true;\n                ty.TuyooSDK.wechatLogin();\n            },\n            fail:function () {\n                ty.NotificationCenter.trigger(ddz.EventType.START_AUTHORIZATION_FAILED);\n                ddz.needReLogin = true;\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationFailed, ['授权失败']);\n            },\n            complete:function () {\n            }\n        });\n    },\n\n    oldAuhor:function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationStart, ['授权开始!']);\n        wx.authorize({\n            scope : \"scope.userInfo\",\n            success : function () {\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationSuccess, ['授权成功!']);\n                ty.wxUserInfo = true;\n                ty.NotificationCenter.trigger(ddz.EventType.GET_USER_INFO, true);\n            },\n            fail:function () {\n                ty.NotificationCenter.trigger(ddz.EventType.START_AUTHORIZATION_FAILED);\n                ddz.needReLogin = true;\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeAuthorizationFailed, ['授权失败']);\n            },\n            complete:function () {\n            }\n        });\n    },\n    // showLoginBtn:function () {\n    //     this.oldAuhor();\n    // }\n};"]}
{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/window/assets/Script/ComponentScript/window/ddz_revivalWindow.js"],"names":["cc","Class","extends","Component","properties","backBg","default","type","Button","titleLabel","Label","contentRichText","RichText","centerButton","centerRichText","ignoreButton","ignoreRichText","matchName","failCondition","matchDes","sharePoint","conditionType","requestCount","nowCount","adCount","adIds","nowAdId","toNext","setContentWithFailCondition","resurgenceCondition","ddz","Share","shareKeywordReplace","repeatNumber","hadNumber","string","title","contentString","hall","GlobalFuncs","replaceKeyWordInString","content","buttonText1","indexOf","centerString","buttonText2","setMatchInfo","ME","matchInfo","getMatchDesByMatchId","matchModel","_curWaitInfo","matchId","setRewardAndCompersation","isWin","chipNumber","multiple","isOnShare","config","gameModel","rewardAnduchangConfig","rewardConfig","buChangConfig","percentage","setCenterRichText","btnText","stageIndex","getCurWaitInfo","curArenaConfig","getArenaMatchConfigJson","toString","sharePointValue","i","stages","index","stage","canBack","feeCount","backFeeCount","shareRewardOnceCount","getRewardCount","Math","ceil","LOGD","onLoad","that","scheduleOnce","ani","node","getComponent","Animation","play","isShowingMatchRevivalPanel","animation","ty","NotificationCenter","listen","EventType","ARENA_SEND_MATCH_BACK","close","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","REWARD_VIDEO_COMPLETE","finishShowRewardVideo","REWARD_VIDEO_COMPLETE_ERROR","errorShowRewardVideo","UPDATE_WINLOSESHAREREWARD","reciveWinLoseShareReward","onShareType","clickStatShareTypeRevial","reultType","resultType","holk","getDiamondToRevival","result","playZuanShi","rewardChip","onClose","isEnded","LOGW","getWinLoseShareReward","parseInt","parArr","errMsg","MsgBoxManager","showToast","waitGetRevial","matchType","needCount","curCount","matchBackNextLevel","destroy","getDiamondCountNeeded","needCountR","shareToGetreward","SharePointType","firstFail","onClickCenterButton","event","number","TCP","connectStatus","CONNECT_STATUS_OK","AudioHelper","playEffect","EffectPath_mp3","button_click_sound","shareWithType","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeButtonClick","adId","getRandomNumberBefore","length","adManager","showRewardedVideo","matchGiveUp","roomId","onBlack","onDestroy","matchRevivalPanel","ignoreScope","unscheduleAllCallbacks"],"mappings":"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","file":"ddz_revivalWindow.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        backBg : {\n            default : null,\n            type  : cc.Button\n        },\n        titleLabel : cc.Label,\n        contentRichText : cc.RichText,\n        centerButton : cc.Button,\n        centerRichText : cc.RichText,\n        ignoreButton : cc.Button,\n        ignoreRichText : cc.RichText,\n        //\n        // isGreenHand : false, //是否是新手复活\n        // isOnShare : false, //是否处于分享状态\n        // isWin : false\n        matchName : \"\",\n        failCondition : null,\n\n        matchDes : null,\n        sharePoint : \"\",\n\n        conditionType : \"\",\n        requestCount : 1,\n        nowCount : 0,\n        adCount : 1,\n\n        adIds : [],\n        nowAdId : '',\n\n        toNext : false\n\n    },\n\n// {\n//     \"failCountMin\": 2,\n//     \"failCountMax\": 4,\n//     \"resurgenceCondition\": {\n//     \"conditionType\": \"share\",\n//         \"requestCount\": 1\n// },\n//     \"title\": \"提示\",\n//     \"content\": \"晋级失败\\n分享游戏给朋友即可免费复活\",\n//     \"buttonText1\": \"分享\",\n//     \"buttonText2\": \"点击放弃>\"\n// },\n    setContentWithFailCondition : function (failCondition,matchName) {\n        this.failCondition = failCondition;\n        this.matchName = matchName;\n        this.conditionType = failCondition.resurgenceCondition.conditionType;\n        this.toNext = failCondition.resurgenceCondition.toNext;\n        this.requestCount = failCondition.resurgenceCondition.requestCount;\n        ddz.Share.shareKeywordReplace.repeatNumber = this.requestCount;\n        this.nowCount = 0;\n        ddz.Share.shareKeywordReplace.hadNumber = this.nowCount;\n        this.adIds = failCondition.resurgenceCondition.adIds;\n        this.titleLabel.string = failCondition.title || \"提示\";\n        var contentString = hall.GlobalFuncs.replaceKeyWordInString(failCondition.content);\n        this.contentRichText.string = \"<color=#1A6951>\"+contentString+\"</c>\";\n\n        if (this.failCondition.resurgenceCondition.requestCount > 1 &&  failCondition.buttonText1.indexOf(\"hadNumber/repeatNumber\") ==-1){\n            failCondition.buttonText1 += \"(hadNumber/repeatNumber)\";\n        }\n\n        var centerString = hall.GlobalFuncs.replaceKeyWordInString(failCondition.buttonText1);\n        this.centerRichText.string = \"<color=#FFFFFF>\"+centerString+\"</c>\";\n        this.ignoreRichText.string = \"<color=#1A6951>\"+failCondition.buttonText2+\"</c>\";\n\n        if(this.matchName == \"arena\"){\n            this.setMatchInfo();\n            var matchDes = hall.ME.matchInfo.getMatchDesByMatchId(ddz.matchModel._curWaitInfo.matchId);\n            this.matchDes = matchDes;\n        }\n    },\n\n    setRewardAndCompersation : function (isWin,chipNumber,multiple,adCount) {\n        this.isOnShare = false;\n        var config = ddz.gameModel.rewardAnduchangConfig;\n        this.adCount = adCount;\n        if (isWin) {  // 奖励\n            if (!config) {\n                this.adIds = [\"adunit-8bde7ac62d379503\"];\n            }else {\n                this.adIds = config.rewardConfig.adIds;\n            }\n            this.conditionType = \"reward\";\n            this.matchName = \"reward\";\n            this.contentRichText.string = \"<color=#1A6951>恭喜你! 本局共赢 </c><img src='ddz_mall_coin_icon' height=36 width=36/>\" +\n                \"<color=#1A6951>\"+ chipNumber + \"</c><br/><color=#1A6951>现在观看广告可获 \"+ multiple + \"倍奖励哦~</c>\";\n        }else {  // 补偿\n            if (!config) {\n                this.adIds = [\"adunit-8bde7ac62d379503\"];\n            }else {\n                this.adIds = config.buChangConfig.adIds;\n            }\n            this.conditionType = \"compensation\";\n            this.matchName = \"compensation\";\n            var percentage = multiple * 100;\n            percentage = percentage + \"%\";\n            this.contentRichText.string = \"<color=#1A6951>本局共输 </c><img src='ddz_mall_coin_icon' height=36 width=36/>\" +\n                \"<color=#1A6951>\"+ chipNumber + \"</c><br/><color=#1A6951>现在观看广告可获 \"+ percentage + \"补偿哦~~</c>\";\n        }\n\n        this.setCenterRichText();\n        this.ignoreRichText.string = \"<color=#1A6951>点击放弃></c>\";\n    },\n\n    setCenterRichText:function(){\n        var btnText = \"看广告领取\";\n        if (this.adCount > 1){\n            btnText = \"看广告领取 (\" + this.nowCount + \"/\" + this.adCount +\")\";\n        }\n        this.centerRichText.string = \"<color=#ffffff>\"+ btnText +\"</c>\";\n    },\n\n// * @param matchDes\n// * @param stageIndex\n// */\n    setMatchInfo: function() {\n        var matchDes = hall.ME.matchInfo.getMatchDesByMatchId(ddz.matchModel._curWaitInfo.matchId);\n        this.matchDes = matchDes;\n        this.stageIndex = ddz.matchModel.getCurWaitInfo().stageIndex;\n        var curArenaConfig = ddz.gameModel.getArenaMatchConfigJson()[this.matchDes.matchId.toString()];\n        var sharePointValue = curArenaConfig[\"reviveSharePoint\"];\n        this.sharePoint = sharePointValue;\n        // var leftCount = ddz.ShareRecord[this.sharePoint.toString()] && ddz.ShareRecord[this.sharePoint.toString()].leftCount;\n        for(var i in this.matchDes.stages) {\n            if(this.matchDes.stages[i].index == this.stageIndex) {\n                var stage = this.matchDes.stages[i];\n                if(stage.canBack == 1) {\n                    this.feeCount = stage.backFeeCount;\n                    this.shareRewardOnceCount = 1;\n                    if(curArenaConfig[\"shareRewardOnce\"][\"type\"] == 'diamond') {\n                        this.shareRewardOnceCount = curArenaConfig[\"shareRewardOnce\"][\"count\"];\n                    }\n                    this.getRewardCount = Math.ceil(this.feeCount/this.shareRewardOnceCount);\n                } else {\n                    hall.LOGD(\"arena revive\",\"something error\");\n                }\n            }\n        }\n    },\n\n    onLoad : function () {\n\n        var that = this;\n        this.scheduleOnce(function () {\n            var ani = that.node.getComponent(cc.Animation);\n            ani.play('btnTick');\n        }, 1);\n\n        ddz.matchModel.isShowingMatchRevivalPanel = true;\n        var animation = this.getComponent(cc.Animation);\n        animation.play('tipsWindowNode');\n        ty.NotificationCenter.listen(ddz.EventType.ARENA_SEND_MATCH_BACK, this.close, this);\n\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n        ty.NotificationCenter.listen(ddz.EventType.REWARD_VIDEO_COMPLETE,this.finishShowRewardVideo,this);\n        ty.NotificationCenter.listen(ddz.EventType.REWARD_VIDEO_COMPLETE_ERROR,this.errorShowRewardVideo,this);\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_WINLOSESHAREREWARD,this.reciveWinLoseShareReward,this);\n    },\n\n    playAnimationAfterShareWithType : function (type) {\n        this.isOnShare = false;\n        if (!type){\n            return;\n        }\n        if (type != ddz.Share.onShareType.clickStatShareTypeRevial) {\n            return;\n        }\n        var reultType = ddz.Share.resultType;\n        switch (reultType) {\n            case 1:\n                if(!this.failCondition.resurgenceCondition.holk ||  this.failCondition.resurgenceCondition.holk == 0){\n                    this.nowCount ++;\n                    this.getDiamondToRevival();\n                    return;\n                }else {\n                }\n                break;\n            case 2:\n                if(!this.failCondition.resurgenceCondition.holk ||  this.failCondition.resurgenceCondition.holk == 0){\n                    this.nowCount ++;\n                    this.getDiamondToRevival();\n                    return;\n                }else {\n                }\n                break;\n            case 3:\n                this.nowCount ++;\n                break;\n            default:\n                break;\n        }\n\n        ddz.Share.resultType = 0;\n        this.getDiamondToRevival();\n    },\n\n    reciveWinLoseShareReward : function (result) {\n        ddz.GlobalFuncs.playZuanShi(false,this,result.rewardChip,true);\n        this.onClose();\n    },\n\n    finishShowRewardVideo : function (isEnded) {\n        hall.LOGW(\"=====\",\"===================\"+isEnded);\n        this.isOnShare = false;\n\n        if(isEnded){\n            this.nowCount ++;\n            if(this.conditionType == \"reward\"){\n                this.setCenterRichText();\n                if (this.nowCount == this.adCount){\n                    ddz.gameModel.getWinLoseShareReward(parseInt(1));\n                }\n            }else if(this.conditionType == \"compensation\"){\n                this.setCenterRichText();\n                if (this.nowCount == this.adCount){\n                    ddz.gameModel.getWinLoseShareReward(parseInt(0));\n                }\n            }else {\n                this.getDiamondToRevival();\n            }\n        }\n    },\n    errorShowRewardVideo : function (parArr) {\n        var errMsg = '广告播放失败,但您仍可复活!';\n        hall.MsgBoxManager.showToast({title:errMsg});\n        this.finishShowRewardVideo(parseInt(parArr[1]));\n    },\n\n    getDiamondToRevival : function () {\n        ddz.Share.shareKeywordReplace.hadNumber = this.nowCount;\n        var centerString = hall.GlobalFuncs.replaceKeyWordInString(this.failCondition.buttonText1);\n        this.centerRichText.string = \"<color=#FFFFFF>\"+centerString+\"</c>\";\n        hall.LOGW(\"=====\",\"===================\"+this.nowCount);\n        if(this.nowCount >= this.requestCount){\n            if(this.matchName == \"arena\"){\n                ddz.waitGetRevial = {\n                    sharePoint: this.sharePoint,\n                    matchType: 'arena',\n                    matchDes : this.matchDes,\n                    type : 'waitRecive',\n                    needCount : this.getRewardCount,\n                    curCount : 0\n                };\n            }else {\n                if (this.toNext){\n                    ddz.matchModel.matchBackNextLevel();\n                    this.node.destroy();\n                    return;\n                }\n                else{\n                    var needCount = ddz.matchModel.getDiamondCountNeeded();\n                    ddz.waitGetRevial = {\n                        type : 'waitRecive',\n                        curCount : 0,\n                        needCount : needCount\n                    };\n                }\n            }\n            var needCountR = ddz.waitGetRevial.needCount;\n            //发送得钻石的消息\n            for (var i = 0; i < needCountR; i++){\n                ddz.gameModel.shareToGetreward(ddz.waitGetRevial.sharePoint || ddz.Share.SharePointType.firstFail);\n            }\n            this.node.destroy();\n        }\n        // ddz.matchModel.matchBack(this.matchDes.roomId, this.matchDes.matchId);\n    },\n\n    onClickCenterButton:function (event,number) {\n        // hall.LOGW(null,\"============onClickCenterButton=============\"+number);\n        if (ty.TCP.connectStatus != ty.TCP.CONNECT_STATUS_OK){\n            hall.MsgBoxManager.showToast({title : \"正在登录，请稍候\"});\n            ddz.LOGD(null, \"TCP is not ok! Please wait!\");\n            return;\n        }\n        if(this.isOnShare){\n            return;\n        }\n        this.isOnShare = true;\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.button_click_sound, false);\n        if(this.conditionType == \"share\"){\n            ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeRevial);\n        }else if(this.conditionType == \"ad\"){\n            //测试代码\n            // if (this.toNext){\n            //     ddz.matchModel.matchBackNextLevel();\n            //     this.node.destroy();\n            //     return;\n            // }\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n                [\"watchVideo\",this.matchName]);\n            var adId = this.adIds[hall.GlobalFuncs.getRandomNumberBefore(this.adIds.length)];\n            this.nowAdId = adId;\n            hall.adManager.showRewardedVideo(adId,this.matchName);\n        }else if(this.conditionType == \"reward\"){\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n                [\"watchVideo\",\"reward\"]);\n            var adId = this.adIds[hall.GlobalFuncs.getRandomNumberBefore(this.adIds.length)];\n            this.nowAdId = adId;\n            hall.adManager.showRewardedVideo(adId,\"reward\");\n        }else if(this.conditionType == \"compensation\"){\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n                [\"watchVideo\",\"compensation\"]);\n            var adId = this.adIds[hall.GlobalFuncs.getRandomNumberBefore(this.adIds.length)];\n            this.nowAdId = adId;\n            hall.adManager.showRewardedVideo(adId,\"compensation\");\n        }\n    },\n    close: function() {\n        this.node.destroy();\n    },\n\n    onClose:function (event) {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"abandonWatchVideo\",this.matchName]);\n        if(this.matchName == \"arena\"){\n            ddz.matchModel.matchGiveUp(this.matchDes.roomId, this.matchDes.matchId);\n        }\n        this.isOnShare = false;\n        this.node.destroy();\n    },\n\n    onBlack : function () {\n\n    },\n    onDestroy : function () {\n        ddz.matchRevivalPanel = null;\n        ddz.matchModel.isShowingMatchRevivalPanel = false;\n        ty.NotificationCenter.ignoreScope(this);\n        this.unscheduleAllCallbacks();\n    }\n});\n"]}
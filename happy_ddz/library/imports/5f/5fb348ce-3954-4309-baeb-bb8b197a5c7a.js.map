{"version":3,"sources":["../../../../../../assets/Script/ddz/msg_handler/assets/Script/ddz/msg_handler/PlayingNetMsg.js"],"names":["ddz","PlayingNetMsg","cc","Class","ctor","_TAG","_playController","arguments","_setListenMsg","destroy","ty","NotificationCenter","ignoreScope","listen","EventType","RECIVE_QUICK_START","onQuickStart","RECIVE_TABLE_INFO","onTableInfo","UPDATE_MULTI","onUpdateMulti","MSG_TABLE_CALL","_onTableCall","MSG_TODO_QUICK_START","onTodoTaskQuickStart","ACTION_DUIJU_LIUSHUI","onHistory","user","params","_resultController","_destroy","_reset","hall","GlobalFuncs","_isAction","actionSrc","dst","argument","LOGW","stat","state","playscene","trigger","REMOVE_MATCHING","info","tableinfo","tableInfo","oldScenType","getSceneType","parseTableInfo","newSceneType","Enums","SceneType","FRIEND","toFriend","changeBg","LOGD","setType","PlayType","PLAY_TYPE_LAIZI","PLAY_TYPE_JINGDIAN","PLAY_TYPE_HUANLE","hasOwnProperty","updateTableState","_refreshMultipleLabel","_tableState","normalInfo","m_call","_setCardsTipVisible","key","_mySeatIndex","parseMySeatInfo","curScene","director","getScene","name","isLimit","wx","getSetting","success","res","authSetting","_parsePartnerInfo","m_state","_friendPanel","disbind","refreshDisbindState","deleteDisbindState","refresh","setBtnInviteState","Boolean","_leftSeatinfo","hasData","_rightSeatinfo","TableState","TABLEDSTAT_IDLE","isMode","PlayMode","PLAY_MODE_REPLAY","MsgFactory","getReady","roomId","tableId","MATCH","showStage","matchModel","getStageIndex","_isOnReady","TABLEDSTAT_PLAYING","changePlayerAvatar","_startPlay","isLaizi","_changeLaiZi","TABLEDSTAT_CALLING","_startJiaodz","nowop","m_nowop","isMyTurn","leftTime","_tableInfo","config","m_optime","m_passtime","FriendOpTimeOut","_operateController","showPlay","_resetTopCardType","updateJiaodzFromTableInfo","setClockVisible","hideAll","con","GetNextIndex","_rightPlayerController","_leftPlayerController","showTopCards","USE_NEW_CARD_NOTE","_initMyCards","_resetExtraCards","_flipExtraCards","showBaseLaiZi","_refreshCardsLayer","_mySeatinfo","model","m_robot","setIsInTrust","hideStage","ARENA","_arenaPanel","refreshShow","msgCache","dump","nextId","rkey","seatInfo","ruid","parseSeatInfo","refreshWithUserInfo","SeatState","SEATDZSTAT_READY","setPrepareVisible","UPDATE_PLAYER_INFO","pos","type","reset","preIndex","getPreIndex","lkey","luid","result","_roomId","seatId","tableChatModel","mySeatId","PLAY_MODE_SINGLE","isStatus","PlayStatus","PLAY_STATUS_GAMEOVER","check","errorMsg","MsgBoxManager","showToast","title","isReplay","action","JSON","stringify","onActionReady","onActionGameReady","onActionNext","onActionChat","onActionCall","onActionGameStart","onActionCard","onActionRb","onActionGameWin","onActionWildCard","ACTION_FT_REQ_DISBIND","ACTION_FT_REQ_DISBIND_ANSWER","ACTION_FT_REQ_DISBIND_RESULT","ACTION_FT_DISBIND","onActionCardNote"],"mappings":"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","file":"PlayingNetMsg.js","sourceRoot":"../../../../../../assets/Script/ddz/msg_handler","sourcesContent":["/*\nFunction :\n\t封装客户端解析网络信息相关的东西\n\t这么封装好吗？\n\t优点：1，网络消息相关的处理都放到这个文件中，后续在查找，修改时会缩小范围；\n\t          2，对于不同的玩法需要处理的消息可以进行差异化处理；\n\t缺点：此部分还需要和界面频繁交互，刷新界面的展示效果，通过user()获取使用者（playController），从而\n\t          使得这个类、playcontroller和其他类形成了一个网状结构，比较复杂。\n\t          如果把这个类中需要做的和界面相关的事情都在playController中封装一个接口，将网状结构降为星状结构显得\n\t          太过繁琐；\n\n\t1，onTableInfo中的消息\n\t2，onTableSit消息\n*/\nddz.PlayingNetMsg = cc.Class({\n\n\tctor: function() {\n\t\tthis._TAG = 'ddz.PlayingNetMsg';\n\t\tthis._playController = arguments[0];\n\t\tthis._setListenMsg();\n\t},\n\n\tdestroy: function() {\n\t\tty.NotificationCenter.ignoreScope(this);\n\t},\n\n\t_setListenMsg: function() {\n\t\t//快速开始\n\t\tty.NotificationCenter.listen(ddz.EventType.RECIVE_QUICK_START, this.onQuickStart, this);\n\t\t//牌桌信息\n\t\tty.NotificationCenter.listen(ddz.EventType.RECIVE_TABLE_INFO, this.onTableInfo, this);\n\t\t// 倍数更新\n\t\tty.NotificationCenter.listen(ddz.EventType.UPDATE_MULTI, this.onUpdateMulti, this);\n\t\t//整个打牌流程，包括准备，叫地主，出牌，胜利等等...，根据action区分\n\t\tty.NotificationCenter.listen(ddz.EventType.MSG_TABLE_CALL, this._onTableCall, this); //网络消息\n\t\t// 监听todo quickstart\n\t\tty.NotificationCenter.listen(ddz.EventType.MSG_TODO_QUICK_START, this.onTodoTaskQuickStart, this); //网络消息\n\n\t\tty.NotificationCenter.listen(ddz.EventType.ACTION_DUIJU_LIUSHUI, this.onHistory, this);\n\t},\n\n\t//使用方\n\tuser: function() {\n\t\treturn this._playController;\n\t},\n\n\t// 在ToDotask的界面里点击快速开始了，隐藏结算页面\n\tonTodoTaskQuickStart: function(params) {\n\t\tif (this.user()._resultController) {\n\t\t\tthis.user()._resultController._destroy();\n\t\t\tthis.user()._reset();\n\t\t}\n\t},\n\n\tonHistory: function () {\n\t\thall.GlobalFuncs.onHistory();\n\t},\n\n\t//判断actiton的类型\n\t_isAction: function(actionSrc, dst) {\n\t\treturn actionSrc == dst;\n\t},\n\n\tonTableInfo: function(argument) {\n\n\t\thall.LOGW('',\"========onTableInfo=========state===\"+\"===\"+argument.stat.state);\n\t\t//虽然进的单机场，但是仍有可能收到消息（断线重连的），所以单机模式下屏蔽掉\n\t\t//todo : 在下一步的重构时，可以在生成playController时不生成此类的对象即可\n\t\tvar playscene = this.user();\n\t\tty.NotificationCenter.trigger(ddz.EventType.REMOVE_MATCHING);  // 去掉队列加载弹窗\n\n\t\tvar info = argument;\n\t\tvar tableinfo = playscene.tableInfo();\n\t\tvar oldScenType = playscene.tableInfo().getSceneType();\n\t\ttableinfo.parseTableInfo(info);\n\t\tvar newSceneType = playscene.tableInfo().getSceneType();\n\n\n\t\t//比赛场与好友房切换处理,在已经存在的牌桌中跳转到好友桌\n\t\tif (oldScenType != null && oldScenType != ddz.Enums.SceneType.FRIEND && newSceneType == ddz.Enums.SceneType.FRIEND){\n\t\t\t//此时是从比赛场进好友桌\n\t\t\tplayscene.toFriend();\n\t\t}\n\n\t\tif (newSceneType == ddz.Enums.SceneType.FRIEND){\n\t\t\tplayscene.changeBg(1);\n\t\t\tplayscene._reset();\n\t\t}\n\t\tddz.LOGD(\"\",\"file = [PlayingNetMsg] fun = [onTableInfo] type = \" + playscene.tableInfo().getSceneType());\n\n\t\tif (info[\"playMode\"] == \"wild\") { //根据返回的tableInfo刷新type...因为游戏尚未开始，影响到的只是标题栏，只需要刷新标题栏即可\n\t\t\tplayscene.setType(ddz.Enums.PlayType.PLAY_TYPE_LAIZI);\n\t\t}\n\t\telse {\n\t\t\tif (info[\"config\"][\"grab\"] == 0) {\n\t\t\t\tplayscene.setType(ddz.Enums.PlayType.PLAY_TYPE_JINGDIAN);\n\t\t\t} else {\n\t\t\t\tplayscene.setType(ddz.Enums.PlayType.PLAY_TYPE_HUANLE);\n\t\t\t}\n\t\t}\n\n\t\tif (info.hasOwnProperty(\"stat\")) {\n\t\t\tplayscene.updateTableState(info);\n\t\t}\n\n\t\tddz.LOGD(this._TAG, \"in _onTableInfo\");\n\t\tplayscene._refreshMultipleLabel(false, true, info['ftInfo'] && playscene._tableState.normalInfo.m_call > -1);\n\t\tplayscene._setCardsTipVisible(false);\n\n\t\t//parse seat info\n\t\tvar key = \"seat\" + playscene._mySeatIndex;\n\t\tplayscene.parseMySeatInfo(info[key]);\n\n\t\tvar curScene = cc.director.getScene();\n\t\tif (curScene.name == \"TableScene\" && !info[key].isLimit) {\n\t\t\twx.getSetting({\n\t\t\t\tsuccess:function(res) {\n\t\t\t\t\tif (!res.authSetting['scope.userInfo']) {\n\t\t\t\t\t\t//把授权按钮显示在头像位置\n\t\t\t\t\t\t// hall.loginBtnManager.showTableAuthorizeBtn();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//解析对家的信息\n\t\tthis._parsePartnerInfo(info);\n\n\t\tvar state = playscene._tableState.normalInfo.m_state;\n\n\t\t// if (playscene.tableInfo().ftInfo && playscene.tableInfo().ftInfo.allComplete){\n\t\t// \t//如果存在好友场信息,并且已经全部打完了,就要弹出对局面板\n\t\t// \thall.GlobalFuncs.onShowDetail();\n\t\t// }\n\n\t\tif (playscene._friendPanel) {\n\t\t\tif(playscene.tableInfo().disbind){\n\t\t\t\tplayscene._friendPanel.refreshDisbindState(playscene.tableInfo().disbind);\n\t\t\t}else {\n\t\t\t\tplayscene._friendPanel.deleteDisbindState();\n\t\t\t}\n\t\t\tplayscene._friendPanel.refresh();\n\t\t\tplayscene._friendPanel.setBtnInviteState(!Boolean(playscene._leftSeatinfo.hasData && playscene._rightSeatinfo.hasData));\n\t\t}\n\n\n\t\tif (state == ddz.Enums.TableState.TABLEDSTAT_IDLE) {\n\t\t\tif (!playscene.isMode(ddz.Enums.PlayMode.PLAY_MODE_REPLAY)) {\n\n\t\t\t\tif (playscene.tableInfo().getSceneType() != ddz.Enums.SceneType.FRIEND){\n\t\t\t\t\t//给服务器发ready消息\n\t\t\t\t\t//比赛场和金币场要自动发送ready,好友场需要手动发送\n\t\t\t\t\tddz.MsgFactory.getReady(playscene.tableInfo().roomId(), playscene.tableInfo().tableId(), playscene._mySeatIndex);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tplayscene.changeBg(1);\n\t\t\t}\n\n\t\t\t//如果都坐滿了,就删除匹配面板\n\t\t\tif (newSceneType == ddz.Enums.SceneType.MATCH && playscene._leftSeatinfo.hasData && playscene._rightSeatinfo.hasData){\n\t\t\t\tty.NotificationCenter.trigger(ddz.EventType.REMOVE_MATCHING);\n\t\t\t\tplayscene.showStage(ddz.matchModel.getStageIndex());\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (newSceneType == ddz.Enums.SceneType.MATCH) {\n\t\t\t\tty.NotificationCenter.trigger(ddz.EventType.REMOVE_MATCHING);\n\t\t\t\tplayscene.changeBg(ddz.matchModel.getStageIndex());\n\t\t\t}\n\n\t\t\t//当前为断线重连，需要做以下事情：  每次托管或者网络卡都可能会收到\n\t\t\tddz.LOGD(this._TAG, \"is reconnect.......\");\n\t\t\tplayscene._isOnReady = true;\n\t\t\tif (state == ddz.Enums.TableState.TABLEDSTAT_PLAYING) { //已经开始游戏\n\t\t\t\tplayscene.changePlayerAvatar(false); //变身\n\t\t\t\tplayscene._startPlay();\n\t\t\t\tif (playscene.isLaizi()){\n\t\t\t\t\tplayscene._changeLaiZi = true;\n\t\t\t\t}\n\t\t\t} else if (state == ddz.Enums.TableState.TABLEDSTAT_CALLING) { //正在叫地主\n\t\t\t\tplayscene._startJiaodz();\n\t\t\t}\n\n\t\t\tvar nowop = playscene._tableState.normalInfo.m_nowop;\n\t\t\t//轮到我操作\n\t\t\tvar isMyTurn = nowop == playscene._mySeatIndex;\n\t\t\tvar leftTime = playscene._tableInfo.config.m_optime - playscene._tableInfo.config.m_passtime;\n\t\t\tif (playscene.tableInfo().getSceneType() == ddz.Enums.SceneType.FRIEND){\n\t\t\t\tleftTime = ddz.FriendOpTimeOut;\n\t\t\t}\n\n\t\t\tif (isMyTurn) {\n\n\t\t\t\tif (state == ddz.Enums.TableState.TABLEDSTAT_PLAYING) { //显示出牌界面\n\t\t\t\t\tplayscene._operateController.showPlay(playscene._resetTopCardType());\n\t\t\t\t} else if (state == ddz.Enums.TableState.TABLEDSTAT_CALLING) { //显示叫地主界面\n\t\t\t\t\tplayscene.updateJiaodzFromTableInfo();\n\t\t\t\t}\n\t\t\t\tplayscene._operateController.setClockVisible(true, leftTime);\n\n\t\t\t} else {\n\t\t\t\tplayscene._operateController.hideAll(); //清空操作栏\n\n\t\t\t\tvar con = nowop == ddz.GlobalFuncs.GetNextIndex(playscene._mySeatIndex) ?\n\t\t\t\t\tplayscene._rightPlayerController :\n\t\t\t\t\tplayscene._leftPlayerController;\n\n\t\t\t\tcon.setClockVisible(true, leftTime);\n\t\t\t}\n\n\t\t\tplayscene.showTopCards();\n\t\t\tty.NotificationCenter.trigger(ddz.EventType.USE_NEW_CARD_NOTE);\n\t\t\tplayscene._initMyCards(); //创建card\n\t\t\tplayscene._resetExtraCards(); //刷新底牌\n\t\t\tif (state == ddz.Enums.TableState.TABLEDSTAT_PLAYING) {\n\t\t\t\t//已开始游戏\n\t\t\t\tplayscene._flipExtraCards(false, true); //显示底牌\n\t\t\t\tplayscene.showBaseLaiZi();\n\t\t\t}\n\t\t\t\n\t\t\tplayscene._refreshCardsLayer(); //把牌放入界面\n\t\t\tplayscene._resetTopCardType(!isMyTurn); //重置需要管的手牌\n\n\t\t\t//看是否托管\n\t\t\tif (playscene._mySeatinfo.model.m_robot == 1) {\n\t\t\t\tddz.LOGD(this._TAG, '托管状态 _tableInfo');\n\t\t\t\tplayscene.setIsInTrust(true);\n\t\t\t}\n\t\t\tplayscene.hideStage();\n\t\t}\n\n\t\tif(playscene.tableInfo().getSceneType() == ddz.Enums.SceneType.ARENA) {\n\t\t\tty.NotificationCenter.trigger(ddz.EventType.REMOVE_MATCHING);\n\t\t\tif(playscene._arenaPanel) {\n\t\t\t\tplayscene._arenaPanel.refreshShow();\n\t\t\t}\n\t\t}\n\t\tddz.msgCache.dump();\n\t\t// ddz.tableInfoModel.clean();\n\t},\n\n\t_parsePartnerInfo: function(info) {\n\t\tvar playscene = this.user();\n\n\t\t//信息一定带有seat1, seat2, seat3字段，如果已有玩家，则更新信息\n\t\tvar nextId = ddz.GlobalFuncs.GetNextIndex(playscene._mySeatIndex);\n\t\tvar rkey = \"seat\" + nextId;\n        var seatInfo = info[rkey];\n\t\tif (info.hasOwnProperty(rkey)) {\n\t\t\tddz.LOGD(this._TAG, 'parse right user info in tableInfo');\n\t\t\tvar ruid = seatInfo[\"uid\"];\n\t\t\tif (ruid != 0) { //如果uid不为0，则表明有玩家\n\t\t\t\tplayscene._rightSeatinfo.parseSeatInfo(seatInfo, nextId);\n\t\t\t\tplayscene._rightPlayerController.refreshWithUserInfo();\n                if (playscene._rightSeatinfo.model.m_state == ddz.Enums.SeatState.SEATDZSTAT_READY){\n                    playscene._rightPlayerController.setPrepareVisible(true);\n                }\n\t\t\t\tty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'right', type:'sit'});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tplayscene._rightPlayerController.reset(true);\n\t\t\t\tty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'right', type:'leave'});\n\t\t\t}\n\t\t}else {\n\t\t\tty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'right', type:'none'});\n\t\t}\n\n\t\tvar preIndex = ddz.GlobalFuncs.getPreIndex(playscene._mySeatIndex);\n\t\tvar lkey = \"seat\" + preIndex;\n        seatInfo = null;\n\t\tif (info.hasOwnProperty(lkey)) {\n            seatInfo = info[lkey];\n\t\t\tddz.LOGD(this._TAG, 'parse left user info in tableInfo');\n\t\t\tvar luid = seatInfo[\"uid\"];\n\t\t\tif (luid != 0) {\n\t\t\t\tplayscene._leftSeatinfo.parseSeatInfo(seatInfo, preIndex);\n\t\t\t\tplayscene._leftPlayerController.refreshWithUserInfo();\n                if (playscene._leftSeatinfo.model.m_state == ddz.Enums.SeatState.SEATDZSTAT_READY){\n                    playscene._leftPlayerController.setPrepareVisible(true);\n                }\n                ty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'left', type:'sit'});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tplayscene._leftPlayerController.reset(true);\n\t\t\t\tty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'left', type:'leave'});\n\t\t\t}\n\t\t}else {\n\t\t\tty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'left', type:'none'});\n\t\t}\n\n\t\tif (playscene._friendPanel){\n\t\t\tplayscene._friendPanel.setBtnInviteState(!Boolean(playscene._leftSeatinfo.hasData && playscene._rightSeatinfo.hasData));\n\t\t}\n\t},\n\n\tonQuickStart: function(argument) {\n\n\t\tvar result = argument;\n\t\tthis.user()._roomId = result[\"roomId\"]; //有可能没有传roomId进来，在此处需要更新\n\t\tvar seatId = result[\"seatId\"];\n\t\tddz.LOGD(this._TAG, \"on quick start in play controller...seatId = \" + seatId);\n\t\tif (null != seatId && typeof(seatId) != 'undefined' && seatId != 0) {\n\t\t\tthis.user()._mySeatIndex = seatId;\n\t\t\tddz.tableChatModel.mySeatId = seatId;\n\t\t} else {\n\t\t\tddz.LOGD(this._TAG, 'SEATID in msg quickstart ERROR - ' + seatId);\n\t\t}\n\t},\n\n\tonUpdateMulti: function(params) {\n\t\tddz.LOGD(this._TAG, \"更新倍数\");\n\t\tthis.user()._refreshMultipleLabel(params[0], params[1]);\n\t},\n\n\t_onTableCall: function(argument) {\n\t\tvar playscene = this.user();\n\t\tif (playscene.isMode(ddz.Enums.PlayMode.PLAY_MODE_SINGLE)) {\n\t\t\treturn;\n\t\t}\n\t\tif(playscene.tableInfo().tableId() == 0) {\t//从进入牌桌前发quick_start改成进入牌桌后才发,则必须保证处理tablecall必须在已经收到了tableinfo之后\n\t\t\treturn;\n\t\t}\n\n\t\t// ddz.LOGD(null, \"on table call in play controller: \" + JSON.stringify(argument));\n\t\tif (playscene.isStatus(ddz.Enums.PlayStatus.PLAY_STATUS_GAMEOVER)) {\n\t\t\treturn;\n\t\t}\n\t\t//{\"cmd\":\"table_call\",\"error\":{\"info\":\"该房间不支持互动表情\",\"code\":1}}\n\t\tvar check = argument;\n\t\tif (typeof(check['error']) != 'undefined') {\n\t\t\tvar errorMsg = check['error']['info'];\n\t\t\tif (typeof(errorMsg) == 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tddz.LOGD(this._TAG, \"error msg is = \" + errorMsg);\n\n\t\t\thall.MsgBoxManager.showToast({title : errorMsg});\n\t\t\treturn;\n\t\t}\n\t\tif(playscene.isReplay() == false){\n\t\t\t// ddz.Replayer.record(argument);\t\n\t\t}\n\n\t\tvar result = argument[\"result\"];\n\t\tvar action = result[\"action\"];\n\n\t\tddz.LOGD(null, \"on table call in play controller: \" + JSON.stringify(argument));\n\n\t\tif (result.hasOwnProperty(\"stat\")) {\n\t\t\tplayscene.updateTableState(result);\n\t\t}\n\n\t\tif (this._isAction(action, \"ready\")) {\n\t\t\t//（1）当某玩家准备后，服务器广播该玩家的 准备 消息。所有玩家收到此消息后，在牌桌上更新准备玩家的状态\n\t\t\tplayscene.onActionReady(result[\"seatId\"]);\n\t\t} else if (this._isAction(action, \"game_ready\")) {\n\t\t\t//（2）玩家都准备后，服务器广播 游戏已准备好 的消息。\n\t\t\t//玩家解析服务器返回的所有玩家的牌。非自己的牌，目前只用作计数表现吧\n\t\t\t//解析底牌\n\t\t\tplayscene.onActionGameReady(result);\n\t\t} else if (this._isAction(action, \"next\")) {\n\t\t\t//（3）轮到谁叫地主\n\t\t\t//（6）轮到谁出牌\n\t\t\tplayscene.onActionNext(result);\n\t\t} else if (this._isAction(action, \"smilies\")) {\n\t\t\t//游戏互动表情\n\t\t\tplayscene.onActionChat(result);\n\t\t} else if (this._isAction(action, \"call\")) {\n\t\t\t//（4）谁叫了几分，广播给所有玩家\n\t\t\tplayscene.onActionCall(result);\n\t\t} else if (this._isAction(action, \"game_start\")) {\n\t\t\t//（5）叫完地主后，游戏开始 ，服务器返回开宝箱相关信息\n\t\t\t//然后处理next协议（6），告诉轮到谁出牌\n\t\t\tplayscene.onActionGameStart(result);\n\t\t} else if (this._isAction(action, \"card\")) {\n\t\t\t//(7)解析刚才是谁打了什么牌，以便在牌桌上显示\n\t\t\tplayscene.onActionCard(result);\n\t\t} else if (this._isAction(action, \"rb\")) {\n\t\t\t//somebody被托管\n\t\t\tplayscene.onActionRb(result);\n\t\t\tddz.LOGD(null, this._TAG, \"action == rb\");\n\t\t} else if (this._isAction(action, \"game_win\")) {\n\t\t\t//游戏结束\n\t\t\tddz.LOGD(this._TAG, \"action == game_win\");\n\t\t\tplayscene.onActionGameWin(result);\n\t\t} else if (this._isAction(action, \"wild_card\")) {\n\t\t\t//解析癞子牌\n\t\t\tddz.LOGD(this._TAG, \"action == wild_card\");\n\t\t\tplayscene.onActionWildCard(result);\n\t\t}\n\t\telse if (this._isAction(action, \"ft_req_disbind\")) {\n\t\t\tddz.LOGD(this._TAG, \"action == ft_req_disbind\"+ JSON.stringify(result));\n\t\t\tty.NotificationCenter.trigger(ddz.EventType.ACTION_FT_REQ_DISBIND,result);\n\t\t}\n\t\telse if (this._isAction(action, \"ft_req_disbind_answer\")) {\n\t\t\tddz.LOGD(this._TAG, \"action == ft_req_disbind_answer\"+ JSON.stringify(result));\n\t\t\tty.NotificationCenter.trigger(ddz.EventType.ACTION_FT_REQ_DISBIND_ANSWER,result);\n\t\t}\n\t\telse if (this._isAction(action, \"ft_req_disbind_result\")) {\n\t\t\tddz.LOGD(this._TAG, \"action == ft_req_disbind_result\"+ JSON.stringify(result));\n\t\t\tty.NotificationCenter.trigger(ddz.EventType.ACTION_FT_REQ_DISBIND_RESULT,result);\n\t\t}\n\t\telse if (this._isAction(action, \"ft_disbind\")) {\n\t\t\tddz.LOGD(this._TAG, \"action == ft_disbind\"+ JSON.stringify(result));\n\t\t\tty.NotificationCenter.trigger(ddz.EventType.ACTION_FT_DISBIND,result);\n\t\t}\n\t\telse if (this._isAction(action, \"newCardNote\")) {\n\t\t\tddz.LOGD(this._TAG, \"action == newCardNote\"+ JSON.stringify(result));\n\t\t\tplayscene.onActionCardNote(result);\n\t\t}\n\t}\n});"]}
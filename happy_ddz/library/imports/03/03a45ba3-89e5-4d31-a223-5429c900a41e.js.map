{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/Scenes/assets/Script/ComponentScript/Scenes/DdzTableScene.js"],"names":["DdzTableAniPlayer","require","DdzTableChatAni","cc","Class","extends","Component","ctor","ddz","GlobalFuncs","drawGameCanvas","_TAG","_leftPlayerController","_rightPlayerController","_leftChatController","_rightChatController","_operateController","_cardsBreakline","_mDizhuCalled","_cards","_selectedCards","_touchedCards","_playedCards","_extraCards","_isUserInteractive","_isInTrust","_status","Enums","PlayStatus","PLAY_STATUS_PREPARE","_touchCardIndexBegin","_touchCardIndexEnd","_multiNum","_leftSeatinfo","SeatInfo","_rightSeatinfo","_mySeatinfo","_mySeatIndex","_showCardIndex","_changeLaiZi","_tableInfo","_TableInfo","_tableState","_TableState","_topCardType","_playTips","_tipNum","_netMsgHandler","_mode","PlayMode","PLAY_MODE_NET","_type","PlayType","PLAY_TYPE_JINGDIAN","_roomId","cardPool","_laiziBaseCard","_cardAniPlayer","_chatAniPlayer","properties","stageTag","Node","cardPrefab","default","type","Prefab","arenaMatchPrefab","cardSmallPrefab","friendPrefab","goldPrefab","throughPrefab","cardsContainer","playedCardArea","cardsTip","Label","controlPanel","myAvatar","myHead","boor","landlord","leftPlayerPanel","rightPlayerPanel","bottomPlayerPanel","extraCardsNode","laiZiCardsNode","btnCancelInStruct","Button","lblStage","ColorBg","faPai","aniNode","chatNode","playModeNode","head_left","head_regiht","opNode","goldInfoNode","goldInfoLabel","ledNode","ledBg","Sprite","ledRichText","RichText","ledTextLength","dizhuHat","dizhuHatSprite","ddz_maozi_1","ddz_maozi_2","dizhuHatSpriteFrame","SpriteFrame","jipaiqi","setGoldInfo","_info","node","active","string","showGoldInfo","hideGoldInfo","changeBg","stageIndex","curIndex","Math","max","getComponent","changeBgColor","floor","showStage","value","numStr","LOGD","hideStage","_arenaPanel","disableChatBtn","setChatButtonActive","onLoad","gameModel","isLoadTableScene","winSize","view","getFrameSize","width","height","scale","_cardBaseScale","ty","UserInfo","systemType","SYSTEMTYPE","iPhoneXType","wid","Widget","top","widL","initWithPar","LOCATION_SIGN","LEFT","RIGHT","init","AudioHelper","playMusic","MusicPath_mp3","table_background_music","SystemInfo","tableBgMusicVolume","on","_cancelDeposite","NotificationCenter","listen","EventType","SHOW_GAME_WIN_ANI","_onShoGameWinAni","RESET_TABLE","_reset","REMOVE_TABLE_ANI","onRemoveAni","CHANGE_TO_SHOW_FROM_HODE","changeToShowFromHide","GAME_HIDE","onGameHide","CLICK_HEAD_BTN","onClickHeadBtn","SHOW_LAIZI_ON_TABLE","showLaiZiCardOnTable","CONVERSION_SUCCESS","onConversionSuccess","CMD_LED_RECEIVE","playLed","USE_NEW_CARD_NOTE","userJiPaiQi","UPDATE_SELF_HEAD_IMAGE","changeSelfHead","OPEN_DIVERSION","openDiversion","NodePool","i","put","instantiate","smallCard","smallCardCom","push","setPosition","addChild","FIRSTLINECARDY","CARD_BIG_SIZE","PlayingNetMsg","quickStartModel","cache","onQuickStart","tableInfoModel","onTableInfo","myCardNote","isClickJiPaiQi","_initUI","backButtonH","getBackButtonPositionY","y","initAdManager","CREATE_TABLE_AD","createTableAd","createCrossButton","showCrossButton","hall","AdManagerTYWX","size","director","getWinSize","getAdNodeByTag","showAdNode","showAd","x","_isAdManagerCreated","scheduleOnce","laiZiCardNode","createNewCard","m_laiziNumber","cordCom","setDiZhuTag","showMask","returnCard","showBaseLaiZi","_changeHandLaiZiCards","bind","playMode","tableInfo","_mixID","mixId","MsgFactory","getQuickStart","userId","GameId","getRoomId","staticSystemInfo","version","result","model","gameWorld","m_ledBeWork","_ledList","m_ledTableList","ledListSort","sort","grade","_moveTime","that","_playLed","data","shift","length","index","color","text","getContentSize","text_size","text_size_length","setContentSize","ceil","stopAllActions","delay","delayTime","action","_move","moveTo","p","_delay","sequence","callFunc","runAction","onClickCenterButton","BiLog","clickStat","clickStatEventType","clickStatEventTypeButtonClick","shareType","Share","onShareType","clickStatShareTypeGetDiamondHall","shareWithType","isLaizi","laiziCard","resetWithNum","removeAllChildren","dizhuWin","dizhuIndex","normalInfo","m_dizhu","myIndex","widx","table_result_music","EffectPath_mp3","table_victory","aniName","table_lose","playLose","playWin","_flipExtraCards","bAnimation","bUpside","tmp","num","cardNode","get","card","start","onDestroy","ignoreScope","Timer","cancelTimer","showTableBannerAd","adManager","destroyWidthBannerAd","destroy","clean","shut","off","TOUCH_END","_bgGroundTouch","stopMusic","matchResultPanel","arenaResultPanel","msgCache","blocked","_myChatController","_arenaPanelNode","_goldPanelNode","_goldPanel","_throughPanelNode","_throughPanel","_friendPanel","detailsModel","clearDetail","loginBtnManager","destroyTableBtn","hideAdNode","sxAdManager","hide","_createPlayerNode","containerRect","rect","eventManager","addListener","event","EventListener","TOUCH_ONE_BY_ONE","swallowTouches","onTouchBegan","touch","pos","convertToNodeSpace","getLocation","rectContainsPoint","isTouchOnCards","_onTouchBegan","onTouchEnded","touchCardsEnd","onTouchMoved","touchCardsMoved","toFriend","toGold","toArenaMatch","toThrough","m_state","TableState","TABLEDSTAT_IDLE","_refreshMultipleLabel","winnerCount","matchModel","getCurWinnerCount","getSceneType","SceneType","MATCH","bc","getTableBannerConfigJson","btc","getTableTopBannerConfigJson","isTop","showMatchBanner","getGoldTableBannerConfigJson","showGoldBanner","getMatchTableBannerConfigJson","showArenaMatchBanner","_config","SHOW_TABLE_BANNER","bottomNode","getChildByName","bw","bottom","gold_bottom","gw","canShowTableBanner","setTimer","showTableTopBannerAd","rightNode","br","leftNode","bl","exNode","ex","fapaiNode","fapai","stageNode","stage","canShowTableTopBanner","showBannerAd","eventTouch","_point","_playBuchu","_clearSelectedCards","isAcceptGameWin","_waitShowJiaoDiZhu","Reset","setStatus","_setCardsTipVisible","_cardsOriginX","_cardsIntervalX","cardCom","pop","_clearPlayedCards","reset","showPrepare","setChatNode","showDizhuHat","to_pos","getPreIndex","setDizhuHead","GetNextIndex","showDizhuHatOrigin","completeHatAni","dizhuPos","from_pos","midy","midx","abs","midPoint","controlPoints1","bezierToDst1","bezierTo","scaleChange","scaleTo","spawn","spriteFrame","changePlayerAvatar","hasAnimation","refreshAvatarForeFriend","refreshAvatarForeFriendOrigin","isDiZhu","nextCallBack","getEmoPos","requestAnimationFrame","avatarCom","isLimit","setAvatarUrl","ME","udataInfo","m_purl","url","m_name","name","_getPosFromIndex","cardIndex","posx","posy","cardsOriginX","firstLineCardCount","firstLineOriginX","secondLineOriginX","_rankCardsWithLaizi","lz_point","m_cardLaizi","lz_number","len","SortCardFunc","isType","PLAY_TYPE_LAIZI","isHuanle","PLAY_TYPE_HUANLE","isReplay","PLAY_MODE_REPLAY","isStatus","val","_isDizhu","isMode","mySeatinfo","setType","updateTableState","info","parseTableState","getMultiple","table_config","config","normal","multiNum","m_bomb","pow","mcc","m_call","mct","m_chuntian","TABLEDSTAT_PLAYING","mbc","m_bcmulti","m_bUpdatebcMulti","mshow","m_show","maxmulti","m_maxMulti","bWithAnimation","bUseServerData","forceUpdate","updateMultiple","getBaseScore","bVisible","tipType","arguments","str","PlayCardsTip","PLAYCARDSTIP_ILLEGAL","PLAYCARDSTIP_NOCARD","PLAYCARDSTIP_PLAY","parseMySeatInfo","parseSeatInfo","_startPlay","removeAllPrepare","PLAY_STATUS_PLAYING","_startJiaodz","hideAll","PLAY_STATUS_JIAODZ","refreshOtherPlayerCardsNum","leftNum","m_card","changeShowLeftNum","rightNum","updateJiaodzFromTableInfo","showJiaodz","leftCall","showJiaodzOnlyNumber","rightCall","setPrepareVisible","lblMsg","_finishJiaodz","_startInsertExtra","getIsMale","m_sex","PlayerSexEnum","SEX_MALE","_classicJiaodz","call","audioName","playEffect","callFen","callNode","setClockVisible","params","roomId","tableId","getTableCall","happyJiaodz","file","_returnAllCards","_initMyCards","cards","_refreshCardsLayer","_resetExtraCards","extra","objectInfo","m_baseCard","_refreshLayoutData","_getCardCountInLine","secondLineCardCount","maxCount","GetCardsOriginInterval","cardsLayerWidth","getBoundingBox","cardWidth","firstLineWidth","secondLineWidth","_checkInFirstLineCards","_checkInSecondLineCards","canShowTag","showTag","setZIndex","_resetTopCardType","bNoshowCardstip","m_topseat","m_topCard","JSON","stringify","types","RobotGlobal","judgeType","findWinCardsFromArray","showTopCards","topSeatId","mySeatId","leftid","rightid","controller","bdizhu","TABLEDSTAT_CALLING","playTopCards","_insertExtraCards","seatInfo","_number","newcards","nc","parent","poker","old_pos","getPosition","move","_oldP","setIsInTrust","isin","_resetPlayerCardsWithLaizi","resetCardsWithLaizi","point","numberToPoint","_findCards","return_arr","lz_pos","tip_number","j","card_number","clickChatButton","_userInfo","_player_info","_player_info_type","_fuhao_user_info","to","_tableId","user_info","m_playinfo","fuhao_user_info","m_playinfo_type","loader","loadRes","err","prefab","_userChatL","setArguments","updatePos","updatePersonalInfo","_userChatR","SELF","hideChat","playTip","up","btnPlay","interactable","playAnimationSoundByCardType","bMale","userPosition","sound","special_effect","getType","PaixingType","ROCKET","playRocket","trigger","BET_SCORE_CHANGE_ANI","BOMB_CARD","playBomb","AIRCRAFT_CARD","playPlane","AIRCRAFT_SINGLE_CARD","AIRCRAFT_DOUBLE_CARD","SHUNZI_CARD","playShunZi","LIANDUI_CARD","playLianDui","THREE_ONE_CARD","THREE_CARD","THREE_TWO_CARD","BOMB_TWO_CARD","BOMB_TWO_TWO_CARD","Playing_cards","_sendPlayCardInfo","m_ccrc","_playCards","MsgBoxManager","showToast","title","checkLarger","dump","isLargerThan","PLAY_MODE_SINGLE","getCards","_playCardsFromServer","isMale","showBuchuSprite","filename","playCards","_playCardsInternal","_runPlayCardsAction","_groupCards","cardGroup","curSubArr","curPoint","allCardCount","lineCardCount","nextCount","_reorderCardsLayer","des","setOldPosition","scard","FindInArray","splice","audio","leftCardsNum","startY","startX","breakline","splitWidth","tox","toy","cardNum","showDropEffect","withOutAni","isValid","down","startDeposite","button_click_sound","_isTrustEnable","m_roomId","m_tableId","onActionWildCard","self","setLaizi","playChooseLaiziAnimation","playLaiZi","convertToWorldSpace","onActionChat","CHAT_COOLING_TIMER_RIGHT","_call_right","isCooling","CHAT_COOLING_TIMER_LEFT","_call_left","emoId","startFunc","_preFabNode","_callFunc","gStartFunc","playFlower","playDiamond","playEgg","playBrick","playFlowerFly","playDiamondFly","playEggFly","playBrickFly","onActionReady","sid","SeatState","SEATDZSTAT_READY","FRIEND","setBtnReadyState","onActionGameReady","ftInfo","parseGameReady","curRound","clickStatEventTypeStartFriendGame","shareKeywordReplace","inviteFriendID","totalRound","displayName","goodCard","mycards","saveDic","myCards","baseCard","basecard","setInLocalStorage","ORIGINCARDS","rcards","lcards","playCardAni","rc","allTime","addCardToPlayer","upDateGoldInfo","GAME_READY","UPDATE_CARD_NOTE","animationCom","Animation","ani","getAnimationState","play","stopCardAni","isPlaying","stop","timeGap","PLAY_STATUS_GAMEOVER","showCallPanel","click_cards","showClock","getOpTime","time","FriendOpTimeOut","onActionNext","_onOneGameCircle","bNoCard","showPlay","hideClock","leftindex","userIndex","setLblMsg","onActionCall","nextIndex","preIndex","showCallNode","m_grab","onActionGameStart","hasOwnProperty","showTboxGetReward","firstUseJiPaiQiPoint","shareToGetreward","SharePointType","firstUseJiPaiQi","seatId","getCradNote","onActionCardNote","isOpen","OPEN_JIPAIJI","cardNoteCount","onActionCard","cardTypd","sortedCards","card_types","AI","sordPlayCards","playCardsInFriend","onActionRb","robots","tips","_clearTouchedCards","onActionGameWin","new_gift_reward","canShowMatchRevivalPanel","isOncePlay","ReadStringFromLocalStorage","ONCEPLAYGAME","throughCount","playcount","dzwin","CLOSE_JIPAIJI","isFlow","playGameFlow","isGameFlow","getMatchDes","checkOldVersion","getStageIndex","matchSignin","matchChallenge","playModel","isChunTian","playChunTian","isDiZhuWin","results","parseGameWin","clickStatEventTypeEndFriendGame","onShowDetail","_startGameOverAnimation","SET_BOX_TYPE","rightindex","updateAllScore","mySeatIndex","_showCardsWhenGameOver","showResult","base","SINGLE_SCORE_BASE","sceneType","ARENA","m_base","m_roommulti","m_basemulti","setNotShowCards","left_cards","showCards","right_cards","_getIndexFromPos","firstLineIndex","secondLineIndex","tc","tmpi","begin","end","startpos","endpos","hitArea","hitSecond","_selectLegalTouchCards","touchCardsCount","nIndex","oneLongest","_findLongestFromSelectedCards","searchOneLongest","slice","hasSelect","cardOne","h","rocketWin","DOUBLE_CARD","pc","getPCArrayByPoint","nPoint","nCount","numberToValue","m","count","_isInShunzi","mypos","myVal","_value","minCnt","judgeCardVal","largerCnt","shutMatchResult","_friendPanelNode","setTableScene","setBtnInviteState","Boolean","hasData","disbind","refreshDisbindState","deleteDisbindState","seatList","seats","nextId","ruid","UPDATE_PLAYER_INFO","NORMAL","tableinfo","_goldInfo","roomName","m_couponrule","update","dt","triggerFristMsg"],"mappings":"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","file":"DdzTableScene.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/Scenes","sourcesContent":["var DdzTableAniPlayer = require('DdzTableAniPlayer');\nvar DdzTableChatAni = require('DdzTableChatAni');\n\n/**\n * 牌桌组件\n */\ncc.Class({\n    extends: cc.Component,\n\n    ctor : function () {\n        ddz.GlobalFuncs.drawGameCanvas();\n\n        this._TAG = \"DdzTableScene\";\n\n        this._leftPlayerController = null;\n        this._rightPlayerController = null;\n\n        this._leftChatController = null;\n        this._rightChatController = null;\n\n        this._operateController = null;\n\n        this._cardsBreakline = 10;\n\n        this._mDizhuCalled = false; //仅用于抢地主模式，表示地主是否被叫\n\n        this._cards = [];\n        this._selectedCards = [];\n        this._touchedCards = [];\n        this._playedCards = [];\n        this._extraCards = [];\n        this._isUserInteractive = false; //玩家是否可以操作手牌\n        this._isInTrust = false; //是否处于托管状态\n        this._status = ddz.Enums.PlayStatus.PLAY_STATUS_PREPARE;\n        this._touchCardIndexBegin = -1;\n        this._touchCardIndexEnd = -1;\n        this._multiNum = 1;\n\n        //座位相关\n        this._leftSeatinfo = new ddz.SeatInfo();\n        this._rightSeatinfo = new ddz.SeatInfo();\n        this._mySeatinfo = new ddz.SeatInfo();\n        this._mySeatIndex = 0;\n        this._showCardIndex = 0;\n        this._changeLaiZi = false;\n\n        //table数据\n        this._tableInfo = new ddz._TableInfo();\n        this._tableState = new ddz._TableState();\n\n        //打牌逻辑存储\n        this._topCardType = null; //需要管的牌型，只能是一个牌型.不需要在每次table_info里面topcard有变动的时候都去转换，只在需要用到的时候转换\n        this._playTips = null; //轮到玩家操作时会自动寻找所有能管得上的手牌，如果没有，则进行提示，如果有，点提示按钮的时候用\n        this._tipNum = 0; //每次点提示按钮都会切换下一个提示牌，当收到下次该我出牌时重置回0\n\n        this._netMsgHandler = null;\n\n        this._mode = ddz.Enums.PlayMode.PLAY_MODE_NET;\n        this._type = ddz.Enums.PlayType.PLAY_TYPE_JINGDIAN; //经典，欢乐，比赛，癞子   联网版由服务器消息决定\n\n        this._roomId = null;\n\n        this.cardPool = null;\n        this._laiziBaseCard = null;\n\n        this._cardAniPlayer = new DdzTableAniPlayer(this);\n        this._chatAniPlayer = new DdzTableChatAni(this);\n    },\n\n    properties: {\n        // waitingNode : cc.Node,\n        stageTag : cc.Node,\n        cardPrefab : {\n            default : null,\n            type : cc.Prefab\n        },\n        arenaMatchPrefab: cc.Prefab,\n        cardSmallPrefab : cc.Prefab,\n        friendPrefab : cc.Prefab,\n        goldPrefab : cc.Prefab,\n        throughPrefab : cc.Prefab,\n        cardsContainer : cc.Node,   //手牌区\n        playedCardArea : cc.Node,   //出牌区\n        cardsTip : cc.Label,\n        controlPanel : cc.Node,\n        myAvatar : cc.Node,\n        myHead : cc.Node,\n        boor : cc.Node,\n        landlord : cc.Node,\n        leftPlayerPanel : cc.Node,\n        rightPlayerPanel : cc.Node,\n        bottomPlayerPanel : cc.Node,\n        extraCardsNode : cc.Node,\n        laiZiCardsNode : cc.Node,\n        btnCancelInStruct : cc.Button,\n        lblStage : cc.Label,\n        ColorBg: cc.Node,\n        faPai: cc.Node,\n        aniNode: cc.Node,\n        chatNode: cc.Node,\n        playModeNode: cc.Node,\n        head_left: cc.Node,\n        head_regiht: cc.Node,\n\n        opNode : cc.Node,\n        goldInfoNode: cc.Node,\n        goldInfoLabel: cc.Label,\n        ledNode: cc.Node,\n        ledBg : cc.Sprite,\n        ledRichText : cc.RichText,\n        ledTextLength : cc.RichText,\n        dizhuHat : cc.Node,\n        dizhuHatSprite : cc.Sprite,\n        ddz_maozi_1 : cc.Node,\n        ddz_maozi_2 : cc.Node,\n        dizhuHatSpriteFrame : [cc.SpriteFrame],\n\n        jipaiqi : cc.Node,\n    },\n\n    setGoldInfo:function(_info){\n        this.goldInfoLabel.node.active = true;\n        this.goldInfoLabel.string = _info;\n    },\n\n    showGoldInfo:function(){\n        this.goldInfoNode.active = true;\n    },\n\n    hideGoldInfo:function () {\n        this.goldInfoNode.active = false;\n    },\n\n    changeBg:function (stageIndex) {\n        var curIndex = Math.max(0,stageIndex);\n        this.ColorBg.getComponent(\"ColorBg\").changeBgColor(Math.floor(curIndex/3)); //修改背影颜色\n    },\n\n    showStage:function (value) {\n        this.changeBg(value);\n        var curIndex = Math.max(0,value-1);\n        this.stageTag.active = true;\n        var numStr = \"一二三四五六七\"[curIndex];\n        this.lblStage.string = \"第\" + numStr + \"关\";\n\n        // this.myAvatar.active = true;\n        this.myHead.active = true;\n        // var myAvatarM = this.myAvatar.getComponent(\"Avatar\");\n        // myAvatarM.hideDizhuHat();\n\n\n        ddz.LOGD(this._TAG, \"设置当前是第几关:\" + numStr);\n    },\n\n    hideStage:function () {\n        if (this.stageTag){\n            this.stageTag.active = false;\n        }\n\n        if (this._arenaPanel){\n            this._arenaPanel.disableChatBtn();\n            // return;\n        }\n        this._leftPlayerController.setChatButtonActive(true);\n        this._rightPlayerController.setChatButtonActive(true);\n        this._operateController.setChatButtonActive(true);\n    },\n\n\n    onLoad : function() {\n\n        ddz.GlobalFuncs.drawGameCanvas();\n        ddz.gameModel.isLoadTableScene = false;\n        var winSize = cc.view.getFrameSize();\n        if (winSize.width / winSize.height >= 10/16){\n            //宽屏分辨率适配\n            var scale = 0.7;\n            this.leftPlayerPanel.scale = scale;\n            this.rightPlayerPanel.scale = scale;\n            this.bottomPlayerPanel.scale = scale;\n            this.stageTag.scale = scale;\n            this.extraCardsNode.scale = scale;\n            this.laiZiCardsNode.scale = scale;\n            this.faPai.scale = scale;\n        }\n\n        this._cardBaseScale = this.playedCardArea.scale;\n\n        this.faPai.active = false;\n        // this.myAvatar.active = false;\n        this.myHead.active = false;\n\n\n        if(ty.UserInfo.systemType == ty.UserInfo.SYSTEMTYPE.iPhoneXType){\n            var wid = this.leftPlayerPanel.getComponent(cc.Widget);\n            wid.top = 30;\n            var widL = this.rightPlayerPanel.getComponent(cc.Widget);\n            widL.top = 30;\n        }\n\n        // var size = cc.director.getWinSize();\n        // ddz.LOGD(null, \"当前的分辨率：w: \" + size.width + \", h：\" + size.height);\n        //\n        this._leftPlayerController = this.leftPlayerPanel.getComponent(\"PlayerPanel\");\n        this._leftPlayerController.initWithPar(true, false, this, ddz.LOCATION_SIGN.LEFT);\n\n        this._rightPlayerController = this.rightPlayerPanel.getComponent(\"PlayerPanel\");\n        this._rightPlayerController.initWithPar(false, false, this, ddz.LOCATION_SIGN.RIGHT);\n\n        this._operateController = this.controlPanel.getComponent(\"ControlPanel\");\n        this._operateController.init(this);\n\n        this._leftPlayerController.setChatButtonActive(false);\n        this._rightPlayerController.setChatButtonActive(false);\n        this._operateController.setChatButtonActive(false);\n\n        ddz.AudioHelper.playMusic(ddz.MusicPath_mp3.table_background_music, true, ty.SystemInfo.tableBgMusicVolume);\n\n        this.btnCancelInStruct.node.active = false;\n        this.btnCancelInStruct.node.on(\"click\" , this._cancelDeposite, this);\n\n        ty.NotificationCenter.listen(ddz.EventType.SHOW_GAME_WIN_ANI, this._onShoGameWinAni, this);\n        ty.NotificationCenter.listen(ddz.EventType.RESET_TABLE, this._reset, this);\n        ty.NotificationCenter.listen(ddz.EventType.REMOVE_TABLE_ANI, this.onRemoveAni, this);\n        ty.NotificationCenter.listen(ddz.EventType.CHANGE_TO_SHOW_FROM_HODE, this.changeToShowFromHide, this);\n        ty.NotificationCenter.listen(ddz.EventType.GAME_HIDE, this.onGameHide, this);\n        \n        ty.NotificationCenter.listen(ddz.EventType.CLICK_HEAD_BTN, this.onClickHeadBtn, this);\n        ty.NotificationCenter.listen(ddz.EventType.SHOW_LAIZI_ON_TABLE, this.showLaiZiCardOnTable, this);\n        ty.NotificationCenter.listen(ddz.EventType.CONVERSION_SUCCESS,this.onConversionSuccess,this);\n\n        ty.NotificationCenter.listen(ddz.EventType.CMD_LED_RECEIVE, this.playLed,this);\n        ty.NotificationCenter.listen(ddz.EventType.USE_NEW_CARD_NOTE, this.userJiPaiQi,this);\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SELF_HEAD_IMAGE, this.changeSelfHead,this);\n\n        ty.NotificationCenter.listen(ddz.EventType.OPEN_DIVERSION, this.openDiversion,this);\n\n        //初始化对象池,添加27张手牌\n        this.cardPool = new cc.NodePool();\n\n        var i;\n        for (i = 0; i < 27; i++){\n            this.cardPool.put(cc.instantiate(this.cardPrefab));\n        }\n\n        //初始化三张小牌\n        var smallCard, smallCardCom;\n\n        for (i = 0; i < 3; i++){\n            smallCard = cc.instantiate(this.cardSmallPrefab);\n            smallCardCom = smallCard.getComponent('Card');\n            this._extraCards.push(smallCardCom);\n\n            smallCard.setPosition(60 * (i-1), 0);\n            this.extraCardsNode.addChild(smallCard);\n\n            smallCard.active = false;\n        }\n\n        //添加癞子底牌\n        smallCard = cc.instantiate(this.cardSmallPrefab);\n        smallCardCom = smallCard.getComponent('Card');\n\n        this._laiziBaseCard = smallCardCom;\n        smallCard.setPosition(0, 0);\n        this.laiZiCardsNode.addChild(smallCard);\n        smallCard.active = false;\n\n        this.FIRSTLINECARDY = this.cardsContainer.height - ddz.CARD_BIG_SIZE.height;\n\n        this._netMsgHandler = new ddz.PlayingNetMsg(this);\n\n        if (ddz.quickStartModel.cache){\n            //牌桌创建之前,有可能quick_start\n            this._netMsgHandler.onQuickStart(ddz.quickStartModel.cache);\n            ddz.quickStartModel.cache = null;\n        }\n\n        if (ddz.tableInfoModel.cache){\n            //牌桌创建之前,有可能table_info已经存在了(断线重连的情况)\n            this._netMsgHandler.onTableInfo(ddz.tableInfoModel.cache);\n            // ddz.tableInfoModel.cache = null;\n        }\n\n        this.myCardNote = [];\n        ddz.isClickJiPaiQi = false;\n        this.jipaiqi.active = false;\n        this._initUI();\n\n        var backButtonH = ddz.GlobalFuncs.getBackButtonPositionY();\n        if (backButtonH && backButtonH != 0){\n            this.ledNode.y = backButtonH + 8;\n        }\n        this.initAdManager();\n        // ty.NotificationCenter.listen(ty.EventType.GET_AD_MSG_SUCCESS,this.showCrossButton,this);\n        ty.NotificationCenter.listen(ty.EventType.CREATE_TABLE_AD,this.createTableAd,this);\n        // wx.getSetting({\n        //     success:function(res) {\n        //         if (!res.authSetting['scope.userInfo']) {\n        //             //把授权按钮显示在头像位置\n        //             hall.loginBtnManager.showTableAuthorizeBtn(this.clickChatButton);\n        //         }\n        //     }\n        // });\n        this.openDiversion();\n    },\n\n    openDiversion:function(){\n        // hall.sxAdManager.show(0,0,1);\n        // var size = cc.director.getWinSize();\n        // hall.sxAdManager.setPosition(70,70);\n    },\n\n    createTableAd:function(){\n        this.createCrossButton();\n        this.showCrossButton();\n    },\n\n    initAdManager:function(){\n        if(hall && hall.AdManagerTYWX){\n            hall.AdManagerTYWX.init();\n            // ty.NotificationCenter.listen(ty.EventType.GET_ADMANAGER_ICON_INFO_SUCCESS, this.createCrossButton, this);\n        }\n    },\n\n    createCrossButton: function(){\n        if(hall && hall.AdManagerTYWX){\n            var size = cc.director.getWinSize();\n            // hall.AdManagerTYWX.showAd(cc.p(posX, posY));\n            if (hall.AdManagerTYWX.getAdNodeByTag(\"tableAdNode\")) {\n                hall.AdManagerTYWX.getAdNodeByTag(\"tableAdNode\").showAdNode();\n            }else {\n                hall.AdManagerTYWX.showAd({x:size.width - 70,y:size.height/2 + 80},\"tableAdNode\");\n            }\n\n            this._isAdManagerCreated = true;\n        }\n    },\n\n    showCrossButton: function(){\n        if(hall && hall.AdManagerTYWX){\n            if(this._isAdManagerCreated){\n                // if(Global.mainLayer != null || Global.rankLayer != null){\n                //     return;\n                // }\n                if (hall.AdManagerTYWX.getAdNodeByTag(\"tableAdNode\")) {\n                    hall.AdManagerTYWX.getAdNodeByTag(\"tableAdNode\").showAdNode();\n                }\n\n            }else{\n                this.scheduleOnce(this.showCrossButton, 1)\n            }\n        }\n    },\n\n    showLaiZiCardOnTable:function () {\n        //创建一张牌,显示在中心点\n        var laiZiCardNode = this.createNewCard(this._tableState.m_laiziNumber);\n        laiZiCardNode.x = -laiZiCardNode.width/2;\n        laiZiCardNode.y = -laiZiCardNode.height/2;\n        var cordCom = laiZiCardNode.getComponent('Card');\n        cordCom.setDiZhuTag(false);\n        cordCom.showMask(false);\n        this.node.addChild(laiZiCardNode);\n\n        this.scheduleOnce(function () {\n            this.returnCard(laiZiCardNode);\n            this.showBaseLaiZi();\n            this._changeHandLaiZiCards();\n        }.bind(this), 1.5);\n    },\n\n    onConversionSuccess:function(){\n        var playMode = this.tableInfo().playMode;\n        var _mixID = this.tableInfo().mixId;\n        hall.MsgFactory.getQuickStart(ty.UserInfo.userId, ddz.GameId, ddz.quickStartModel.getRoomId(), hall.staticSystemInfo.version, null, null, null,null,_mixID,playMode);\n    },\n\n    playLed : function (result) {\n        var model = hall.gameWorld.model;\n        model.m_ledBeWork = true;\n        var _ledList = model.m_ledTableList; // {\"text\": result[i].text, \"color\": cc.color(result[i].color), \"size\": 22}\n\n        var ledListSort = function(){\n            _ledList = _ledList.sort(function(x,y){\n                return x[0].grade - y[0].grade;\n            })\n            // ddz.LOGD(\"\",\"file = [DdzTableScene] fun = [ledListSort] _ledList = \" + JSON.stringify(_ledList));\n        };\n\n        var _moveTime = 1;\n        var that = this;\n        var _playLed = function(){\n            ledListSort();\n            var data = _ledList.shift();\n            if (data && data.length > 0) {\n                that.ledNode.active = true;\n                var index = 0;\n                that.ledRichText.string = \"<color=#\" + data[0].color+ \">\"+ data[0].text + \"</color>\";\n                that.ledTextLength.string = \"<color=#\" + data[0].color+ \">\"+ data[0].text + \"</color>\";\n                var size = that.ledBg.node.getContentSize();\n                var text_size = that.ledRichText.node.getContentSize();\n                var text_size_length = that.ledTextLength.node.getContentSize();\n                size.width = text_size.width + 90;\n                if (text_size_length.width < text_size.width) {\n                    size.width = text_size_length.width + 90;\n                }\n                that.ledBg.node.setContentSize(size);\n                if (text_size.height > size.height) {\n                    index = Math.ceil(text_size.height/size.height);\n                }\n                that.ledRichText.node.y = size.height/2;\n                that.playModeNode.stopAllActions();\n                var delay = cc.delayTime(30);\n                var action;\n\n                if (index > 1) {\n                    for (var i = 0; i < index; i++) {\n                        var _move = cc.moveTo(_moveTime, cc.p(60,size.height/2 + i*size.height));\n                        var _delay = cc.delayTime((i+1)*4);\n                        action = cc.sequence(_delay,cc.callFunc(function(){\n                            that.ledRichText.node.runAction(_move);\n                        },that),cc.callFunc(function(){\n                            if (i == index) {\n                                that.playModeNode.runAction(cc.sequence(cc.delayTime(3),\n                                    cc.callFunc(function(){\n                                        that.ledNode.active = false;\n                                        }),\n                                    delay,\n                                    cc.callFunc(function(){\n                                        _playLed();\n                                    }, that)));\n                            }\n                        },that));\n                        that.playModeNode.runAction(action);\n                    }\n                }else {\n                    action = cc.sequence(cc.delayTime(5),\n                        cc.callFunc(function(){\n                            that.ledNode.active = false;\n                    }),\n                        delay,\n                        cc.callFunc(function(){\n                        _playLed();\n                    }, that));\n                    that.playModeNode.runAction(action);\n                }\n            }else {\n                that.ledNode.active = false;\n                model.m_ledBeWork = false;\n                // model.m_ledTableList = [];\n            }\n        };\n        _playLed();\n    },\n    \n    // 点击tips 邀请好友按钮\n    onClickCenterButton:function(){\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"mallInvite\"]);\n        var shareType = ddz.Share.onShareType.clickStatShareTypeGetDiamondHall;\n        ddz.Share.shareWithType(shareType);\n    },\n\n    showBaseLaiZi:function () {\n        if (this.isLaizi()){\n            this.extraCardsNode.x = -50;\n            var laiziCard = this._laiziBaseCard;\n            laiziCard.resetWithNum(this._tableState.m_laiziNumber);\n            laiziCard.node.active = true;\n        }\n    },\n\n    onRemoveAni:function () {\n        this.aniNode.removeAllChildren();\n    },\n\n    _onShoGameWinAni:function (dizhuWin) {\n        var dizhuIndex = this._tableState.normalInfo.m_dizhu;\n        var myIndex = this._mySeatIndex;\n\n        var widx = 0;\n        var table_result_music = ddz.EffectPath_mp3.table_victory;\n        var aniName;\n        if (dizhuWin){\n            if (myIndex == dizhuIndex){\n                aniName = \"shengli\";\n            }\n            else{\n                aniName = \"shibai\";\n                widx = 1;\n            }\n        }\n        else{\n            if (myIndex == dizhuIndex){\n                aniName = \"shibai\";\n                widx = 1;\n            }\n            else{\n                aniName = \"shengli\";\n            }\n        }\n\n        if (widx == 1){\n            table_result_music = ddz.EffectPath_mp3.table_lose;\n            this._cardAniPlayer.playLose();\n        }\n        else{\n            this._cardAniPlayer.playWin();\n        }\n        ddz.AudioHelper.playMusic(table_result_music, false);\n\n        // this.myRole.setAnimation(0, aniName, true);\n    },\n\n    _flipExtraCards: function (bAnimation, bUpside) {\n        ddz.LOGD(this._TAG, \"flip extra cards....\");\n        var tmp;\n        for (var index = 0; index < 3; index++) {\n            tmp = this._extraCards[index];\n            tmp.node.active = bUpside;\n        }\n    },\n\n    /**\n     * 创建一张新手牌(也有可能是从池中取出来的)\n     * @param num 数值\n     */\n    createNewCard : function (num) {\n        var cardNode;\n        if (this.cardPool.size() > 0){\n            cardNode = this.cardPool.get();\n        }\n        else{\n            cardNode = cc.instantiate(this.cardPrefab);\n        }\n        cardNode.getComponent('Card').resetWithNum(num);\n        return cardNode;\n    },\n\n    /**\n     * 手牌不用了,归还牌池\n     * @param card\n     */\n    returnCard:function (card) {\n        this.cardPool.put(card);\n    },\n\n    start : function () {\n\n    },\n\n    // update (dt) {},\n\n    onDestroy:function () {\n        ty.NotificationCenter.ignoreScope(this);\n        ty.Timer.cancelTimer(this, this.showTableBannerAd);\n        hall.adManager.destroyWidthBannerAd();\n        this.tableInfo().destroy();\n        ddz.tableInfoModel.clean();\n        this._netMsgHandler.destroy();\n        this._netMsgHandler = null;\n        this._cardAniPlayer.shut();\n        this._cardAniPlayer = null;\n        this._chatAniPlayer.shut();\n        this._chatAniPlayer = null;\n        this.node.off(cc.Node.EventType.TOUCH_END, this._bgGroundTouch, this);\n        ddz.AudioHelper.stopMusic();\n        ddz.matchResultPanel = null;\n        ddz.arenaResultPanel = null;\n        ddz.msgCache.blocked = true;\n        hall.gameWorld.model.m_ledTableList = [];\n        // 当前场景已经销毁,chatNode 不在重复清理节点\n        if (this._rightChatController){\n            this._rightChatController = null;\n        }\n        if (this._leftChatController){\n            this._leftChatController = null;\n        }\n        if (this._myChatController){\n            this._myChatController = null;\n        }\n\n        if (this._arenaPanelNode){\n            this._arenaPanelNode = null;\n            this._arenaPanel = null;\n        }\n\n        if (this._goldPanelNode){\n            this._goldPanelNode = null;\n            this._goldPanel = null;\n        }\n\n        if (this._throughPanelNode){\n            this._throughPanelNode = null;\n            this._throughPanel = null;\n        }\n\n        if (this._friendPanel){\n            this._friendPanel = null;\n        }\n\n        ddz.detailsModel.clearDetail();\n        hall.loginBtnManager.destroyTableBtn();\n\n        if (hall.AdManagerTYWX && hall.AdManagerTYWX.getAdNodeByTag(\"tableAdNode\")) {\n            hall.AdManagerTYWX.getAdNodeByTag(\"tableAdNode\").hideAdNode();\n        }\n\n        if (hall.sxAdManager) {\n            hall.sxAdManager.hide();\n        }\n    },\n    \n    /*===========*/\n\n    _initUI: function() { //先创建自身的UI，再创建子容器的UI，因为原来代码土，子容器用到了父容器内容，不先创建自身的，会出错\n\n        this._createPlayerNode();\n        //测试代码\n        this._isUserInteractive = true;\n\n        var that = this;\n        var containerRect = cc.rect(0, 0, this.cardsContainer.width, this.cardsContainer.height);\n        cc.eventManager.addListener({\n            event: cc.EventListener.TOUCH_ONE_BY_ONE,\n            swallowTouches: true,\n            onTouchBegan: function(touch, event) {\n                if (!that._isUserInteractive || that._isInTrust) {\n                    return false;\n                }\n                var pos = that.cardsContainer.convertToNodeSpace(touch.getLocation());\n                if (cc.rectContainsPoint(containerRect, pos) && that.isTouchOnCards(pos)) {\n                    return that._onTouchBegan(pos);\n                }\n                return false;\n            },\n            onTouchEnded: function(touch, event) {\n                if (!that._isUserInteractive || that._isInTrust) {\n                    return;\n                }\n                that.touchCardsEnd();\n                // var pos = that.cardsContainer.convertToNodeSpace(touch.getLocation());\n                // if (cc.rectContainsPoint(containerRect, pos) && that.isTouchOnCards(pos)) {\n                //     return that._onTouchBegan(pos);\n                // }\n            },\n            onTouchMoved: function(touch, event) {\n                if (!that._isUserInteractive || that._isInTrust) {\n                    return;\n                }\n                var pos = that.cardsContainer.convertToNodeSpace(touch.getLocation());\n                if (cc.rectContainsPoint(containerRect, pos)) {\n                    if (that.isTouchOnCards(pos)) {\n                        that.touchCardsMoved(pos);\n                    }\n                }\n            }\n        }, this.cardsContainer);\n\n\n        this.toFriend();\n        this.toGold();\n        this.toArenaMatch();\n        this.toThrough();\n        this.node.on(cc.Node.EventType.TOUCH_END, this._bgGroundTouch, this);\n\n        if (this._tableState.normalInfo.m_state != ddz.Enums.TableState.TABLEDSTAT_IDLE){\n            this._refreshMultipleLabel(false, true, true);\n        }\n\n        var winnerCount = ddz.matchModel.getCurWinnerCount();\n\n        // banner 广告\n        if (this.tableInfo().getSceneType() == ddz.Enums.SceneType.MATCH){\n            //检查配置是否开启\n            var bc = ddz.gameModel.getTableBannerConfigJson();\n            var btc = ddz.gameModel.getTableTopBannerConfigJson();\n            var isTop = false;\n\n            // var bottomNode = this.node.getChildByName('playerBottom');\n            // var bw = bottomNode.getComponent(cc.Widget);\n            // bw.bottom = 190;\n            this.jipaiqi.active = true;\n\n            var winnerCount = ddz.matchModel.getCurWinnerCount();\n            if (bc){\n                if (bc.start) {\n                    if (winnerCount >= bc.start) {\n                        isTop = false;\n                        this.showMatchBanner(bc,isTop);\n                    }\n                }else {\n                    isTop = false;\n                    this.showMatchBanner(bc,isTop);\n                }\n            }else if (btc){\n                if (btc.start) {\n                    if (winnerCount >= bc.start) {\n                        isTop = true;\n                        this.showMatchBanner(btc,isTop);\n                    }\n                }else {\n                    isTop = true;\n                    this.showMatchBanner(btc,isTop);\n                }\n            }\n\n        }else if (this._goldPanel) {\n            var bc = ddz.gameModel.getGoldTableBannerConfigJson();\n            if (bc) {\n                if (bc.start) {\n                    if (winnerCount >= bc.start) {\n                        this.showGoldBanner(bc);\n                    }\n                }else {\n                    this.showGoldBanner(bc);\n                }\n            }\n        }else if (this._arenaPanel){\n            var bc = ddz.gameModel.getMatchTableBannerConfigJson();\n            if (bc) {\n                if (bc.start) {\n                    if (winnerCount >= bc.start) {\n                        this.showArenaMatchBanner(bc);\n                    }\n                }else {\n                    this.showArenaMatchBanner(bc);\n                }\n            }\n        }else if (this._friendPanel){\n            // hall.adManager.destroyBannerAd();\n            hall.adManager.destroyWidthBannerAd();\n            // hall.adManager.destroyResurgenceBannerAd();\n        }else {\n            // hall.adManager.destroyBannerAd();\n            hall.adManager.destroyWidthBannerAd();\n            // hall.adManager.destroyResurgenceBannerAd();\n        }\n    },\n\n    // 金币场banner广告\n    showGoldBanner:function(_config,isTop){\n        if (!isTop) {\n            ty.NotificationCenter.listen(ddz.EventType.SHOW_TABLE_BANNER, this.showTableBannerAd,this);\n            var bottomNode = this.node.getChildByName('playerBottom');\n            var bw = bottomNode.getComponent(cc.Widget);\n            bw.bottom = 190;\n\n            var gold_bottom = this._goldPanelNode.getChildByName('bottomNode');\n            var gw = gold_bottom.getComponent(cc.Widget);\n            gw.bottom = 155;\n\n            hall.adManager.canShowTableBanner = true;\n            this.showTableBannerAd();\n            ty.Timer.setTimer(this, this.showTableBannerAd, _config.delay);\n        }\n    },\n\n    // arena比赛场banner广告\n    showArenaMatchBanner:function(_config,isTop){\n        if (!isTop) {\n            ty.NotificationCenter.listen(ddz.EventType.SHOW_TABLE_BANNER, this.showTableBannerAd,this);\n            var bottomNode = this.node.getChildByName('playerBottom');\n            var bw = bottomNode.getComponent(cc.Widget);\n            bw.bottom = 190;\n\n            var gold_bottom = this._arenaPanelNode.getChildByName('bottomNode');\n            var gw = gold_bottom.getComponent(cc.Widget);\n            gw.bottom = 155;\n\n            hall.adManager.canShowTableBanner = true;\n            this.showTableBannerAd();\n            ty.Timer.setTimer(this, this.showTableBannerAd, _config.delay);\n        }\n    },\n\n    // 比赛场banner广告\n    showMatchBanner:function(_config,isTop){\n        if (!isTop){\n            ty.NotificationCenter.listen(ddz.EventType.SHOW_TABLE_BANNER, this.showTableBannerAd,this);\n\n            hall.adManager.canShowTableBanner = true;\n            this.showTableBannerAd();\n            ty.Timer.setTimer(this, this.showTableBannerAd, _config.delay);\n        }else {\n            ty.NotificationCenter.listen(ddz.EventType.SHOW_TABLE_BANNER, this.showTableTopBannerAd,this);\n            var rightNode = this.node.getChildByName('playerRight');\n            var br = rightNode.getComponent(cc.Widget);\n            br.top = 90;\n            var leftNode = this.node.getChildByName('playerLeft');\n            var bl = leftNode.getComponent(cc.Widget);\n            bl.top = 90;\n\n            var exNode = this.node.getChildByName('ExtraCardsNode');\n            var ex = exNode.getComponent(cc.Widget);\n            ex.top = 156;\n\n            var fapaiNode = this.node.getChildByName('fapai');\n            var fapai = fapaiNode.getComponent(cc.Widget);\n            fapai.top = 353;\n\n            var stageNode = this.node.getChildByName('stageTag');\n            var stage = stageNode.getComponent(cc.Widget);\n            stage.top = 538;\n\n            hall.adManager.canShowTableTopBanner = true;\n            this.showTableTopBannerAd();\n            ty.Timer.setTimer(this, this.showTableTopBannerAd, _config.delay);\n        }\n    },\n\n    showTableBannerAd:function () {\n        if (hall.adManager.canShowTableBanner){\n            hall.adManager.showBannerAd('adunit-811cc4e234425489');\n        }\n    },\n\n    showTableTopBannerAd:function () {\n        if (hall.adManager.canShowTableTopBanner && !ddz.matchResultPanel){\n            // hall.adManager.showTopBannerAd('adunit-811cc4e234425489');\n        }\n    },\n\n    _bgGroundTouch:function (eventTouch) {\n        if (eventTouch.touch._point.y > 100){\n            if(this.cardsTip.string == \"没有牌能大过上家\"){\n                this._operateController._playBuchu();\n            }else {\n                this._clearSelectedCards();\n            }\n        }\n    },\n\n    _reset: function() {\n\n        this.dizhuHat.active = false;\n        this.dizhuHat.x = 0;\n        this.dizhuHat.y = 50;\n        this.myCardNote = [];\n        this.onRemoveAni();\n        ddz.gameModel.isAcceptGameWin = false;\n        this._waitShowJiaoDiZhu = false;\n\n        this.jipaiqi.active = false;\n\n        this.faPai.active = false;\n        this._showCardIndex = 0;\n        this._tableState.Reset();\n        this._multiNum = 1;\n        this._mDizhuCalled = false;\n        this.setStatus(ddz.Enums.PlayStatus.PLAY_STATUS_PREPARE);\n\n        this._topCardType = null;\n        this._playTips = null;\n        this._tipNum = 0;\n        this._setCardsTipVisible(false);\n\n        this.goldInfoNode.active = false;\n        this._changeLaiZi = false;\n\n        this.goldInfoLabel.node.active = false;\n\n        //触摸相关\n        this._cardsOriginX = 0;\n        this._cardsIntervalX = 0;\n        this._cardsBreakline = 10;\n        this._touchCardIndexBegin = -1;\n        this._touchCardIndexEnd = -1;\n\n        //手牌\n        var cardCom;\n        while (this._cards.length > 0){\n            cardCom = this._cards.pop();\n            this.returnCard(cardCom.node);\n        }\n\n        //////////////////////////////////////////////////////////底牌,显示背面\n        for (i = 0; i < this._extraCards.length; i++) {\n            var card = this._extraCards[i];\n            //初始是翻面状态\n            card.node.active = false;\n        }\n\n        this.extraCardsNode.x = 0;\n        this._laiziBaseCard.node.active = false;\n\n        this._selectedCards = [];\n        this._touchedCards = [];\n        this._clearPlayedCards();\n\n        //座位信息\n        if (!this._friendPanel) {\n            this._leftSeatinfo.clean();\n            this._rightSeatinfo.clean();\n        }\n\n        if (this._leftPlayerController) {\n            this._leftPlayerController.reset();\n        }\n        if (this._rightPlayerController) {\n            this._rightPlayerController.reset();\n        }\n        \n        this.myAvatar.active = false;\n        this.myHead.active = false;\n        // var myAvatarM = this.myAvatar.getComponent(\"Avatar\");\n        // myAvatarM.hideDizhuHat();\n        if (this._friendPanel){\n            // this.myAvatar.active = true;\n            this.myHead.active = true;\n        }\n        if (this._goldPanel){\n            // this.myAvatar.active = true;\n            this.myHead.active = true;\n            this._goldPanel.reset();\n        }\n        if (this._throughPanel){\n            // this.myAvatar.active = true;\n            this._throughPanel.reset();\n        }\n        \n\n        if (this._arenaPanel){\n            // this.myAvatar.active = true;\n            this.myHead.active = true;\n            this._arenaPanel.reset();\n        }\n\n\n        this._leftPlayerController.setChatButtonActive(false);\n        this._rightPlayerController.setChatButtonActive(false);\n        this._operateController.setChatButtonActive(false);\n\n        this._operateController.showPrepare(false); //联网玩法默认已经准备\n\n        this._isUserInteractive = false; //玩家是否可以操作手牌\n        this._isInTrust = false; //是否处于托管状态\n        this.btnCancelInStruct.node.active = this._isInTrust;\n\n        this.head_left.stopAllActions();\n        this.head_regiht.stopAllActions();\n        if (this._rightChatController) {\n            this._rightChatController.setChatNode(false,true);\n        }\n        if (this._leftChatController) {\n            this._leftChatController.setChatNode(false,true);\n        }\n        if (this._myChatController){\n            this._myChatController.setChatNode(false,true);\n        }\n    },\n\n    showDizhuHat : function (to_pos) {\n        // this.dizhuHatSprite.spriteFrame = this.dizhuHatSpriteFrame[0];\n        // this.dizhuPos = to_pos;\n        // this.dizhuHat.active = true;\n        // var animation = this.dizhuHat.getComponent(cc.Animation);\n        // var anim1 = animation.getAnimationState('maozi1');\n        // anim1.on('finished', this.completeHatAni,this);\n        // anim1.play();\n        //\n        var dizhuIndex = this._tableState.normalInfo.m_dizhu\n        if (dizhuIndex == this._mySeatIndex) {\n            this.boor.active = false;\n            this.landlord.active = true;\n        }else if (dizhuIndex == ddz.GlobalFuncs.getPreIndex(this._mySeatIndex)) { //\n            this._leftPlayerController.setDizhuHead();\n        }else if (dizhuIndex == ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex)) { //\n            this._rightPlayerController.setDizhuHead();\n        }\n    },\n    showDizhuHatOrigin : function (to_pos) {\n        // this.dizhuHatSprite.spriteFrame = this.dizhuHatSpriteFrame[1];\n        //\n        // this.ddz_maozi_1.opacity = 0;\n        // this.ddz_maozi_2.opacity = 0;\n        //\n        // this.dizhuPos = to_pos;\n        // this.dizhuHat.active = true;\n        // this.dizhuHat.x = to_pos.x;\n        // this.dizhuHat.y = to_pos.y ;\n\n        var dizhuIndex = this._tableState.normalInfo.m_dizhu\n        if (dizhuIndex == this._mySeatIndex) {\n            this.boor.active = false;\n            this.landlord.active = true;\n        }else if (dizhuIndex == ddz.GlobalFuncs.getPreIndex(this._mySeatIndex)) { //\n            this._leftPlayerController.setDizhuHead();\n        }else if (dizhuIndex == ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex)) { //\n            this._rightPlayerController.setDizhuHead();\n        }\n    },\n    completeHatAni : function () {\n        var to_pos = this.dizhuPos;\n        // to_pos.y += 50;\n        var from_pos = cc.p(0,50);\n        var midy;\n        var midx;\n\n        if (Math.abs(to_pos.x - from_pos.x) < 100){\n            midx = to_pos.x + 200;\n            midy = from_pos.y + (to_pos.y - from_pos.y)/2;\n        }else if (Math.abs(to_pos.y - from_pos.y) < 100){\n            midx = (to_pos.x - from_pos.x) / 2;\n            midy = from_pos.y;\n        }else {\n            midx = -200;\n            midy = from_pos.y + (to_pos.y - from_pos.y)/2 + 100;\n        }\n        ddz.LOGD(\"\", \"曲线运动中间点 midx = \" + midx + \"  midy = \" + midy );\n        var midPoint = cc.p(midx, midy);\n        var controlPoints1 = [     from_pos,     midPoint,     to_pos   ];\n        var bezierToDst1 = cc.bezierTo(0.7, controlPoints1);\n\n        var scaleChange = cc.scaleTo(0.7,1,1);\n\n        this.dizhuHat.runAction(cc.sequence(cc.spawn(bezierToDst1,scaleChange), cc.callFunc(function () {\n            this.dizhuHatSprite.spriteFrame = this.dizhuHatSpriteFrame[1];\n        }, this)));\n    },\n\n    /**\n     * 变身\n     */\n    changePlayerAvatar : function (hasAnimation) {\n\n        // if (this._friendPanel){\n            if(hasAnimation){\n                this._leftPlayerController.refreshAvatarForeFriend();\n                this._rightPlayerController.refreshAvatarForeFriend();\n            }else {\n                this._leftPlayerController.refreshAvatarForeFriendOrigin();\n                this._rightPlayerController.refreshAvatarForeFriendOrigin();\n            }\n        \n            // this.myAvatar.active = true;\n            this.myHead.active = true;\n            var isDiZhu = this._mySeatIndex == this._tableState.normalInfo.m_dizhu;\n            // var myAvatarM = this.myAvatar.getComponent(\"Avatar\");\n            if(isDiZhu){\n                var that = this;\n                var nextCallBack = function () {\n                    var to_pos = that.getEmoPos(that._mySeatIndex);\n                    if(hasAnimation){\n                        that.showDizhuHat(to_pos);\n                    }else {\n                        that.showDizhuHatOrigin(to_pos);\n                    }\n                };\n                requestAnimationFrame(nextCallBack);\n\n            }\n            return;\n        // }\n        \n        /**\n         * 动态加载sp动画\n         */\n        // cc.loader.loadRes(spDataPath, sp.SkeletonData, function (err, skeletonData) {\n        //     this.myRole.skeletonData = skeletonData;\n        //     this.myRole.setAnimation(0, ddz.ROLE_ACTION.CHANGTAI, true);\n        //     var scX = 0.7;\n        //     var scY = 0.7;\n        //     if (spDataPath == \"spine/ddz_newoneself_nongmin\"){\n        //         scX = -0.7;\n        //     }\n        //     else if (spDataPath == \"spine/ddz_newoneself_dizhupo\"){\n        //         //地主婆用小比例\n        //         scX = 0.6;\n        //         scY = 0.6;\n        //     }\n        //     this.myRole.node.scaleX = scX;\n        //     this.myRole.node.scaleY = scY;\n        // }.bind(this));\n    },\n\n\n    _createPlayerNode: function() {\n        // var nameStr = hall.GlobalFuncs.SliceStringToLength(hall.ME.getName(), 10);\n        if (this.myAvatar) {\n            var avatarCom = this.myAvatar.getComponent(\"Avatar\");\n            // avatarCom.setPlayerName(nameStr);\n            if (ddz.gameModel.isLimit) {\n                avatarCom.setAvatarUrl(hall.ME.udataInfo.m_purl);\n            }\n            this.myAvatar.active = false;\n        }\n        this.myHead.active = true;\n        this.boor.active = true;\n        this.landlord.active = false;\n    },\n\n    changeSelfHead:function(data){\n        if (this.myAvatar) {\n            var avatarCom = this.myAvatar.getComponent(\"Avatar\");\n            avatarCom.setAvatarUrl(data.url);\n            hall.ME.udataInfo.m_purl = data.url;\n            hall.ME.udataInfo.m_name = data.name;\n        }\n    },\n\n\n    _getPosFromIndex: function(index) {\n\n        var cardIndex, posx, posy, cardsOriginX;\n\n        if (index < this.firstLineCardCount){\n            cardsOriginX = this.firstLineOriginX;\n            posy = this.FIRSTLINECARDY;\n            cardIndex = index;\n        }\n        else{\n            cardsOriginX = this.secondLineOriginX;\n            posy = 0;\n            cardIndex = index - this.firstLineCardCount;\n        }\n\n        posx = cardsOriginX + this._cardsIntervalX * cardIndex;\n        return cc.p(posx, posy);\n    },\n\n    // 有癞子时从新对手牌进行排序\n    _rankCardsWithLaizi: function() {\n        var lz_point = this._tableState.normalInfo.m_cardLaizi;\n        var lz_number = this._tableState.m_laiziNumber;\n        var len = this._cards.length;\n        for (var i = 0; i < len; i++) {\n            if (this._cards[i]._info._point - 1 == lz_point) {\n                this._cards[i].resetWithNum(lz_number);\n            }\n        }\n        this._cards.sort(ddz.GlobalFuncs.SortCardFunc);\n    },\n\n    isLaizi: function() {\n        return this.isType(ddz.Enums.PlayType.PLAY_TYPE_LAIZI);\n    },\n    isHuanle: function() {\n        return this.isType(ddz.Enums.PlayType.PLAY_TYPE_HUANLE);\n    },\n\n    isReplay: function() {\n        return this._mode == ddz.Enums.PlayMode.PLAY_MODE_REPLAY;\n    },\n\n    //为状态提供两个接口\n    isStatus: function(val) {\n        return this._status == val;\n    },\n    setStatus: function(val) {\n        this._status = val;\n    },\n    isType: function(val) {\n        return this._type == val;\n    },\n    //我是不是地主\n    _isDizhu: function(index) {\n        return this._tableState.normalInfo.m_dizhu == index;\n    },\n\n    isMode: function(val) {\n        return this._mode == val;\n    },\n\n    tableInfo: function() {\n        return this._tableInfo;\n    },\n    mySeatinfo: function() {\n        return this._mySeatinfo;\n    },\n    setType: function(val) {\n        this._type = val;\n    },\n\n    updateTableState: function(info) {\n        // ddz.LOGD(this._TAG, \"table state is : \" + JSON.stringify(info[\"stat\"]));\n        this._tableState.parseTableState(info[\"stat\"]);\n    },\n\n    /**\n     * 获取倍数\n     * @returns {number}\n     */\n    getMultiple:function () {\n        var table_config = this._tableInfo.config;\n\n        var normal = this._tableState.normalInfo;\n        var multiNum = 1;\n        //炸弹\n        var bc = normal.m_bomb;\n        if (bc > 0) {\n            multiNum *= Math.pow(2, bc);\n        }\n        //抢地主加倍\n        var mcc = normal.m_call;\n        if (mcc > 0) {\n            multiNum *= mcc;\n        }\n        //春天\n        var mct = normal.m_chuntian;\n        if (mct > 0) {\n            multiNum *= mct;\n        }\n        if (normal.m_state == ddz.Enums.TableState.TABLEDSTAT_PLAYING) {\n            //底牌\n            var mbc = normal.m_bcmulti;\n            if (mbc > 0) {\n                multiNum *= mbc;\n            }\n            this._tableState.m_bUpdatebcMulti = false;\n        }\n\n        //明牌加倍\n        var mshow = normal.m_show;\n        if (mshow > 0) {\n            multiNum *= mshow;\n        }\n        var maxmulti = table_config.m_maxMulti;//如果有封顶,就用封顶\n        if (maxmulti > 0 && multiNum >= maxmulti) {\n            multiNum = maxmulti;\n        }\n\n        return multiNum;\n    },\n\n    //刷新倍数的label字符串\n    //bUseServerData表示用服务器数据，而不使用客户端统计数据\n    _refreshMultipleLabel: function(bWithAnimation, bUseServerData, forceUpdate) {\n        // 单机的基数固定为100\n        if (bUseServerData) {\n            var multiNum = this.getMultiple();\n            if (this._multiNum != multiNum || forceUpdate) {\n                if (bWithAnimation){\n                    // ddz.AudioHelper.playEffect(ddz.EffectPath_mp3[\"multiple\"], false);\n                }\n                this._multiNum = multiNum;\n\n                if (this._friendPanel){\n                    this._friendPanel.updateMultiple(this.getBaseScore(), this._multiNum);\n                }\n\n                if (this._goldPanel){\n                    this._goldPanel.updateMultiple(this.getBaseScore(), this._multiNum);\n                }\n\n                if (this._arenaPanel){\n                    this._arenaPanel.updateMultiple(this.getBaseScore(), this._multiNum);\n                }\n\n                if (this._throughPanel){\n                    this._throughPanel.updateMultiple(this.getBaseScore(), this._multiNum);\n                }\n            }\n        }\n    },\n\n    /**\n     * 设置是否显示，或者显示的是出牌不符合规则，还是没有牌大的过上家\n     * @param bVisible\n     * @param tipType\n     * @private\n     */\n    _setCardsTipVisible: function(bVisible, tipType) {\n        if (arguments.length > 1) {\n            this.cardsTip.node.active = true;\n            var str = \" \";\n            if (tipType == ddz.Enums.PlayCardsTip.PLAYCARDSTIP_ILLEGAL){\n                str = \"出牌不符合规则\";\n            }\n            else if (tipType == ddz.Enums.PlayCardsTip.PLAYCARDSTIP_NOCARD){\n                str = \"没有牌能大过上家\";\n            }\n            else if (tipType == ddz.Enums.PlayCardsTip.PLAYCARDSTIP_PLAY){\n                str = \"请选择要出的牌\";\n            }\n            this.cardsTip.string = str;\n        }\n        else{\n            this.cardsTip.node.active = bVisible;\n        }\n    },\n\n    parseMySeatInfo: function(info) {\n        this._mySeatinfo.parseSeatInfo(info, this._mySeatIndex);\n    },\n\n    _startPlay: function() {\n        // ddz.LOGD(this._TAG, \"start play now\");\n        this._isUserInteractive = true;\n        this.removeAllPrepare();\n        //在刚开始一定不用播剩2、1张的音效；在短线重连后播放意义不大；在取消托管后也会进到这，主要是\n        //不要再取消托管时重复播放剩余张数的音效\n\n        this.setStatus(ddz.Enums.PlayStatus.PLAY_STATUS_PLAYING);\n    },\n\n    //开始叫地主\n    _startJiaodz: function() {\n        ddz.LOGD(this._TAG, \"start jiaodz now\");\n        this.removeAllPrepare();\n\n        this._operateController.hideAll();\n        this.setStatus(ddz.Enums.PlayStatus.PLAY_STATUS_JIAODZ);\n\n       this.refreshOtherPlayerCardsNum();\n    },\n\n    refreshOtherPlayerCardsNum : function () {\n        if(this._leftPlayerController){\n            var leftNum = this._leftSeatinfo.model.m_card.length;\n            if(leftNum && leftNum != 0){\n                this._leftPlayerController.changeShowLeftNum(leftNum);\n            }\n        }\n        if(this._rightPlayerController){\n            var rightNum = this._rightSeatinfo.model.m_card.length;\n            if(rightNum && rightNum != 0){\n                this._rightPlayerController.changeShowLeftNum(rightNum);\n            }\n        }\n    },\n\n    updateJiaodzFromTableInfo : function () {\n        this._operateController.showJiaodz(this._tableState.normalInfo.m_call);\n        if(this._leftPlayerController){\n            var leftCall = this._leftSeatinfo.model.m_call;\n            this._leftPlayerController.showJiaodzOnlyNumber(leftCall);\n\n        }\n        if(this._rightPlayerController){\n            var rightCall = this._rightSeatinfo.model.m_call;\n            this._rightPlayerController.showJiaodzOnlyNumber(rightCall);\n        }\n    },\n\n    removeAllPrepare:function () {\n        this._leftPlayerController.setPrepareVisible(false);\n        this._rightPlayerController.setPrepareVisible(false);\n        this._operateController.lblMsg.string = \" \";\n        if(this.playedCardArea){\n            this.playedCardArea.removeAllChildren();//清除出牌区手牌\n        }\n    },\n\n\n    _finishJiaodz: function() {\n        ddz.LOGD(this._TAG, \"finish jiaodz in play controller\");\n        this.removeAllPrepare();\n        this._startInsertExtra();\n    },\n\n    getIsMale:function () {\n        //有问题,容错\n        if(hall.ME && hall.ME.udataInfo ){\n            return hall.ME.udataInfo.m_sex == ddz.Enums.PlayerSexEnum.SEX_MALE;\n        }\n        return true;\n    },\n\n    //经典玩法叫地主后回调\n    _classicJiaodz: function(call) {\n        if (this.faPai.active) {\n            //播放发牌动画时,不能叫分\n            return;\n        }\n        var audioName = '';\n        audioName = this.getIsMale() ? \"man_\" : \"female_\";\n        audioName += call > 0 ? call + \"_point\" : \"not_call\";\n        ddz.LOGD(this._TAG, 'playEffect=' + audioName);\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3[audioName], false);\n        var callFen  = call > 0 ? call + \"分\" : \"不叫\";\n\n        this._operateController.callNode.active = false;\n\n        //根据叫的分设置\n        this._operateController.lblMsg.string = callFen;\n\n        this._mySeatinfo.model.m_call = call;\n        this._operateController.setClockVisible(false);\n        if (this.isReplay() == false) {\n            //发送叫分给服务器\n            var params = {\n                'seatId': this._mySeatIndex,\n                'call': call,\n                \"roomId\": this._tableInfo.roomId(),\n                \"tableId\": this._tableInfo.tableId()\n            };\n            ddz.MsgFactory.getTableCall(\"call\", params);\n        }\n    },\n\n    happyJiaodz: function(call) {\n        // if (this._mDizhuCalled) {\n        //     this._refreshMultipleLabel(true, false);\n        // }\n\n        var file = this.getIsMale() ? \"man_\" : \"female_\";\n        var callFen;\n        if (this._mDizhuCalled) { //抢地主\n            if (call == 0) { //不抢\n                callFen = '不抢';\n                file += \"not_rob\";\n            } else {\n                callFen = '抢地主';\n                file += \"rob_dizhu\";\n            }\n        } else { //叫地主\n            if (call == 0) { //不叫\n                callFen = '不叫';\n                file += \"not_call\";\n            } else { //叫地主\n                callFen = '叫地主';\n                file += \"call_dizhu\";\n            }\n        }\n\n        ddz.LOGD(this._TAG, 'playEffect=' + ddz.EffectPath_mp3[file]);\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3[file], false);\n\n        //根据叫的分设置\n        this._operateController.lblMsg.string = callFen;\n\n        this._operateController.setClockVisible(false);\n\n        //发送叫分给服务器\n        if (this.isReplay() == false) {\n            var params = {\n                'seatId': this._mySeatIndex,\n                'call': call,\n                \"roomId\": this._tableInfo.roomId(),\n                \"tableId\": this._tableInfo.tableId()\n            };\n            ddz.MsgFactory.getTableCall(\"call\", params);\n        }\n    },\n\n    /**\n     * 归还所有手牌到牌池\n     * @private\n     */\n    _returnAllCards : function () {\n        var cardCom;\n        while (this._cards.length > 0){\n            cardCom = this._cards.pop();\n            this.returnCard(cardCom.node);\n        }\n    },\n\n\n    //初始化自己的牌\n    _initMyCards: function() {\n        //在收到脱管信息后，会收到tableinfo的消息，在tableinfo中会重新生成牌的信息，在以下情况会有bug：\n        //在不该我出牌时我选中了牌，然后点击脱管，在重新生成牌的信息后，已选中的牌的信息还存在，所以在此清空一下选中牌的信息\n        this._clearSelectedCards(true);\n        this._returnAllCards();\n\n        var cards = this._mySeatinfo.model.m_card;\n        var card, cardCom;\n\n        for (var i = 0; i < cards.length; i++) {\n            card = this.createNewCard(cards[i]);\n            cardCom = card.getComponent('Card');\n            cardCom.showMask(false);\n            this._cards.push(cardCom);\n\n            this.cardsContainer.addChild(card);\n        }\n        this._cards.sort(ddz.GlobalFuncs.SortCardFunc);\n\n        this._refreshCardsLayer();\n    },\n\n    /**\n     * 癞子牌变身(初始化底牌,会包含此过程,所以初始化不需要再调用此方法)\n     */\n    _changeHandLaiZiCards:function () {\n        var cardCom;\n        for (var i = 0; i < this._cards.length; i++) {\n            cardCom = this._cards[i];\n            if (cardCom._info._point == this._tableState.normalInfo.m_cardLaizi) {\n                cardCom.resetWithNum(this._tableState.m_laiziNumber);\n            }\n        }\n        this._cards.sort(ddz.GlobalFuncs.SortCardFunc);\n        this._refreshCardsLayer();\n    },\n\n    _resetExtraCards: function() {\n        var extra = this._tableState.objectInfo.m_baseCard;\n        for (var i = 0; i < extra.length; i++) {\n            this._extraCards[i].resetWithNum(extra[i]);\n        }\n\n        this._extraCards.sort(ddz.GlobalFuncs.SortCardFunc);\n\n        var smallCard;\n        for (i = 0; i < 3; i++){\n            smallCard = this._extraCards[i].node;\n            smallCard.setPosition(60 * (i-1), 0);\n        }\n\n        this._laiziBaseCard.resetWithNum(this._tableState.m_laiziNumber);\n    },\n\n    /**\n     * 刷新手牌布局数据\n     * @private\n     */\n    _refreshLayoutData:function () {\n\n        var len = this._cards.length;\n\n        this.firstLineCardCount = this._getCardCountInLine();\n        this.secondLineCardCount = len - this.firstLineCardCount;\n\n        var maxCount = Math.max(this.firstLineCardCount, this.secondLineCardCount);\n\n        var data = ddz.GlobalFuncs.GetCardsOriginInterval(this.cardsContainer, ddz.CARD_BIG_SIZE.width, maxCount);\n\n        this._cardsOriginX = data[\"origin\"];\n        this._cardsIntervalX = data[\"interval\"];\n        this._cardsBreakline = data[\"breakline\"];\n\n        var cardsLayerWidth = this.cardsContainer.getBoundingBox().width;\n        var cardWidth = ddz.CARD_BIG_SIZE.width;\n\n        this.firstLineWidth = (this.firstLineCardCount - 1) * this._cardsIntervalX + cardWidth;\n        this.secondLineWidth = (this.secondLineCardCount - 1) * this._cardsIntervalX + cardWidth;\n\n        this.firstLineOriginX = (cardsLayerWidth - this.firstLineWidth) / 2;\n        this.secondLineOriginX = (cardsLayerWidth - this.secondLineWidth) / 2;\n    },\n\n    _checkInFirstLineCards:function (pos) {\n        return pos.x > this.firstLineOriginX && pos.x < this.firstLineOriginX + this.firstLineWidth && pos.y > this.FIRSTLINECARDY;\n    },\n\n    _checkInSecondLineCards:function (pos) {\n        return pos.x > this.secondLineOriginX && pos.x < this.secondLineOriginX + this.secondLineWidth && pos.y < ddz.CARD_BIG_SIZE.height;\n    },\n\n    _refreshCardsLayer: function() {\n        ddz.LOGD(this._TAG, \"111111 _refreshCardsLayer\");\n        this._clearSelectedCards();\n        var len = this._cards.length;\n        //清空已触摸选择的牌了，因为其中的对象会被移除掉\n        this._touchedCards = [];\n        if (len <= 0) {\n            return;\n        }\n        this._refreshLayoutData();\n\n        var cardCom;\n        var canShowTag;\n        for (var index = 0; index < len; index++) {\n            canShowTag = ((index == this.firstLineCardCount - 1) || (index == len - 1));\n            cardCom = this._cards[index];\n            cardCom.node.stopAllActions();\n            cardCom.showTag(canShowTag);\n            cardCom.setDiZhuTag(this._isDizhu(this._mySeatIndex) && canShowTag);\n            cardCom.showMask(this._isInTrust);\n            cardCom.setPosition(this._getPosFromIndex(index));\n            cardCom.setZIndex(index);\n        }\n    },\n\n    //只有两种情况需要reset: 1.轮到我操作， 2.收到table_info(可能是断线重连)\n    //被动出牌管不上时候要进行特殊处理\n    //bNoshowCardstip : 只在短线重连后使用，当为true时不显示“没有牌大过上家的提示”\n    _resetTopCardType: function(bNoshowCardstip) {\n        this._tipNum = 0;\n        //轮到我主动出牌，清空topcard信息 我主动出牌时，top_card字段不为空，所以必须用top_seat判断\n        if (this._tableState.normalInfo.m_topseat == this._mySeatIndex) {\n            this._topCardType = null;\n        } else {\n            //上家出的牌的数组\n            var top = this._tableState.objectInfo.m_topCard;\n            ddz.LOGD(this._TAG, 'verify topCard.....'+JSON.stringify(top));\n            //有需要管的牌，判断手牌是否能管得上，进行提示，同时给提示按钮使用\n            if (top.length > 0) {\n                var types = ddz.RobotGlobal.judgeType(top, false);\n                //这里不进行types的判断了，如果topcard不是有效牌型，会是严重错误\n                this._topCardType = types[0];\n\n                // 计算被动提示牌\n                this._playTips = ddz.RobotGlobal.findWinCardsFromArray(types[0], this._mySeatinfo.model.m_card);\n                //管不上\n                if (this._playTips.length == 0) {\n                    ddz.LOGD(this._TAG, \"no cards larger than top card\");\n\n                    if (!bNoshowCardstip) {\n                        ddz.LOGD(this._TAG, \"!bNoshowCardstip is true ~~~~~~~ \");\n                        this._setCardsTipVisible(true, ddz.Enums.PlayCardsTip.PLAYCARDSTIP_NOCARD);\n                    }\n                    return true;\n                }\n            }\n            //上家毛牌没出\n            else {\n                ddz.LOGD(this._TAG, \"这不对吧\");\n                this._topCardType = null;\n            }\n        }\n        return false;\n    },\n\n\n    showTopCards: function() {\n        var topSeatId = this._tableState.normalInfo.m_topseat;\n        var mySeatId = this._mySeatIndex;\n        if (topSeatId == mySeatId) { //轮到别人出牌时，不显示我出的牌\n            return;\n        }\n        var cards = this._tableState.objectInfo.m_topCard;\n\n        var leftid  = ddz.GlobalFuncs.getPreIndex(mySeatId);\n        var rightid = ddz.GlobalFuncs.GetNextIndex(mySeatId);\n\n        var controller, bdizhu;\n        if (topSeatId == rightid){\n            controller = this._rightPlayerController;\n            bdizhu = this._isDizhu(rightid);\n        }else{\n            controller = this._leftPlayerController;\n            bdizhu = this._isDizhu(leftid);\n        }\n\n        if(this._tableState.normalInfo.m_state != ddz.Enums.TableState.TABLEDSTAT_CALLING){\n            controller.playTopCards(cards, bdizhu);\n        }\n    },\n\n    _startInsertExtra: function() {\n        ddz.LOGD(this._TAG, \"start insert extra in play controller....\");\n\n        //判断是否是地主，地主的话需要把extra_cards插入手牌....\n        if (this._tableState.normalInfo.m_dizhu == this._mySeatIndex) {\n            this._insertExtraCards();\n        } else {\n            var seatInfo = this._tableState.normalInfo.m_dizhu == ddz.GlobalFuncs.getPreIndex(this._mySeatIndex) ? this._leftSeatinfo : this._rightSeatinfo;\n\n            for (var i = 0; i < this._extraCards.length; i++) {\n                seatInfo.model.m_card.push(this._extraCards[i]._info._number);\n            }\n            this._startPlay();\n        }\n        //对家的明牌翻过去\n    },\n\n    _insertExtraCards: function() {\n        // ddz.LOGD(this._TAG, \"insert extra in play controller\");\n        var newcards = [];\n        var i,card,cardCom;\n        for (i = 0; i < 3; i++) {\n            card = this._extraCards[i];\n\n            var nc = this.createNewCard(card._info._number);\n            this._cards.push(nc.getComponent('Card'));\n            newcards.push(nc);\n            this._mySeatinfo.model.m_card.push(card._info._number); //seat_info里面也需要同步更新\n            nc.parent = this.cardsContainer;\n        }\n\n        this._cards.sort(ddz.GlobalFuncs.SortCardFunc);\n        this._refreshCardsLayer();\n\n        //插入手牌后显示地主标识\n        var length = this._cards.length;\n        this._cards[length - 1].setDiZhuTag(true);\n\n        for (i = 0; i < 3; i++) {\n            var poker = newcards[i];\n            var old_pos = poker.getPosition();\n            poker.setPosition(cc.p(old_pos.x, old_pos.y * 1.2));\n            var delay = cc.delayTime(0.1);\n            var move = cc.moveTo(0.2, poker.getComponent('Card')._oldP);\n            if (i == 2) {\n                poker.runAction(cc.sequence(delay, move, cc.callFunc(this._startPlay, this)));\n            } else {\n                poker.runAction(cc.sequence(delay, move));\n            }\n        }\n    },\n\n    //设置脱管状态\n    setIsInTrust: function(isin) {\n        if (this._isInTrust == isin) {\n            return;\n        }\n        this._isInTrust = isin;\n\n        this._refreshCardsLayer();\n\n        this.btnCancelInStruct.node.active = this._isInTrust;\n        //设置牌上的阴影层是否显示\n        for (var i = 0; i < this._cards.length; ++i) {\n            var card = this._cards[i];\n            card.showMask(this._isInTrust);\n        }\n    },\n    \n    _resetPlayerCardsWithLaizi: function() { //把3个玩家手牌中癞子对应点数的牌转成癞子\n\n        var lz_point = this._tableState.normalInfo.m_cardLaizi;\n        var lz_number = this._tableState.m_laiziNumber;\n\n        this._mySeatinfo.resetCardsWithLaizi(lz_point, lz_number);\n        this._leftSeatinfo.resetCardsWithLaizi(lz_point, lz_number);\n        this._rightSeatinfo.resetCardsWithLaizi(lz_point, lz_number);\n\n        var extra = this._tableState.objectInfo.m_baseCard;\n        for (var i = 0; i < extra.length; i++) {\n            var point = ddz.GlobalFuncs.numberToPoint(extra[i]);\n            if (point == lz_point) {\n                extra[i] = lz_number;\n            }\n        }\n    },\n\n\n    _findCards: function(cards) {\n        var return_arr = [];\n        var lz_pos = -1; //如果有多个癞子的话，则每用掉一个癞子，就设一次lz_pos，因为每次都是从0开始搜索，这样不会重复找到同一张癞子\n        for (var i = 0; i < cards.length; i++) {\n            var tip_number = cards[i];\n            var index = -1;\n            for (var j = 0; j < this._cards.length; j++) {\n                var card = this._cards[j];\n                var card_number = card._info._number;\n                if (card_number == tip_number && card_number <= 53) {\n                    index = j;\n                    break;\n                } else if (card_number > 53 && tip_number > 53 && j > lz_pos) {\n                    lz_pos = j;\n                    index = j;\n                    break;\n                }\n            }\n            if (index >= 0) {\n                return_arr.push(card);\n            }\n        }\n        return return_arr;\n    },\n\n    clickChatButton:function(index) {\n        var url;\n        var name;\n        var _userInfo;\n        var _player_info;\n        var _player_info_type;\n        var _fuhao_user_info;\n        var that = this;\n        var to = -1;\n        var _tableId = this._tableInfo.tableId();\n        var _roomId = this._tableInfo.roomId();\n        if (index == ddz.LOCATION_SIGN.LEFT){\n            _userInfo = this._leftSeatinfo.model.user_info;\n            _player_info = this._leftSeatinfo.model.m_playinfo;\n            _fuhao_user_info = this._leftSeatinfo.model.fuhao_user_info;\n            _player_info_type = this._leftSeatinfo.model.m_playinfo_type;\n            url = _userInfo.udataInfo.m_purl;\n            name = _userInfo.udataInfo.m_name;\n            to = ddz.GlobalFuncs.getPreIndex(this._mySeatIndex);\n            if (this._rightChatController) {\n                this._rightChatController.setChatNode(false);\n            }\n            if (this._myChatController) {\n                this._myChatController.setChatNode(false);\n            }\n            if (this._leftChatController == null){\n                cc.loader.loadRes('prefabs/userChat', function (err, prefab) {\n                    var _userChatL = cc.instantiate(prefab);\n                    this._leftChatController = _userChatL.getComponent('userChat');\n                    that.chatNode.addChild(_userChatL);\n                    this._leftChatController.setArguments(_tableId, _roomId, this._mySeatIndex, to ,url, name,this);\n                    this._leftChatController.updatePos();\n                    this._leftChatController.updatePersonalInfo(_player_info,_player_info_type,_fuhao_user_info);\n                }.bind(this));\n\n            }else {\n                this._leftChatController.setChatNode(true);\n                this._leftChatController.setArguments(_tableId, _roomId, this._mySeatIndex, to ,url, name,this);\n                this._leftChatController.updatePos();\n                this._leftChatController.updatePersonalInfo(_player_info,_player_info_type,_fuhao_user_info);\n            }\n        }else if (index == ddz.LOCATION_SIGN.RIGHT){\n            _userInfo = this._rightSeatinfo.model.user_info;\n            _player_info = this._rightSeatinfo.model.m_playinfo;\n            _fuhao_user_info = this._rightSeatinfo.model.fuhao_user_info;\n            _player_info_type = this._rightSeatinfo.model.m_playinfo_type;\n            url = _userInfo.udataInfo.m_purl;\n            name = _userInfo.udataInfo.m_name;\n            to = ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex);\n            if (this._leftChatController) {\n                this._leftChatController.setChatNode(false);\n            }\n            if (this._myChatController) {\n                this._myChatController.setChatNode(false);\n            }\n            if (this._rightChatController == null){\n                cc.loader.loadRes('prefabs/userChat', function (err, prefab) {\n                    var _userChatR = cc.instantiate(prefab);\n                    this._rightChatController = _userChatR.getComponent('userChat');\n                    that.chatNode.addChild(_userChatR);\n                    this._rightChatController.setArguments(_tableId, _roomId, this._mySeatIndex, to ,url, name,this);\n                    this._rightChatController.updatePos();\n                    this._rightChatController.updatePersonalInfo(_player_info,_player_info_type,_fuhao_user_info);\n                }.bind(this));\n            }else {\n                this._rightChatController.setChatNode(true);\n                this._rightChatController.setArguments(_tableId, _roomId, this._mySeatIndex, to ,url, name,this);\n                this._rightChatController.updatePos();\n                this._rightChatController.updatePersonalInfo(_player_info,_player_info_type,_fuhao_user_info);\n            }\n\n        }else if (index == ddz.LOCATION_SIGN.SELF){\n            _userInfo = this._mySeatinfo.model.user_info;\n            _player_info = this._mySeatinfo.model.m_playinfo;\n            _fuhao_user_info = this._mySeatinfo.model.fuhao_user_info;\n            _player_info_type = this._mySeatinfo.model.m_playinfo_type;\n            if (!_userInfo || !_player_info) {\n                return\n            }\n            // url = _userInfo.udataInfo.m_purl;\n            url = hall.ME.udataInfo.m_purl;\n            // name = _userInfo.udataInfo.m_name;\n            name = hall.ME.udataInfo.m_name;\n            to = ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex);\n            if (this._leftChatController) {\n                this._leftChatController.setChatNode(false);\n            }\n            if (this._rightChatController) {\n                this._rightChatController.setChatNode(false);\n            }\n            if (this._myChatController == null){\n                cc.loader.loadRes('prefabs/userChat', function (err, prefab) {\n                    var _userChatR = cc.instantiate(prefab);\n                    this._myChatController = _userChatR.getComponent('userChat');\n                    that.chatNode.addChild(_userChatR);\n                    this._myChatController.setArguments(_tableId, _roomId, this._mySeatIndex, to ,url, name,this);\n                    this._myChatController.updatePos();\n                    this._myChatController.updatePersonalInfo(_player_info,_player_info_type,_fuhao_user_info);\n                    this._myChatController.hideChat();\n                }.bind(this));\n            }else {\n                this._myChatController.setChatNode(true);\n                this._myChatController.setArguments(_tableId, _roomId, this._mySeatIndex, to ,url, name,this);\n                this._myChatController.updatePos();\n                this._myChatController.updatePersonalInfo(_player_info,_player_info_type,_fuhao_user_info);\n                this._myChatController.hideChat();\n            }\n\n        }\n        ddz.LOGD(null, \"clickChatButton 点击头像 index = \" + index + \" name = \" + name );\n    },\n\n    playTip: function() {\n        var len = this._playTips.length;\n        ddz.LOGD(null, \"-----------------------playTip-----------------------------\"+len);\n        if (len == 0) {\n            this._operateController._playBuchu();\n            this._setCardsTipVisible(false);\n            return;\n        }\n        //清除已提示的牌\n        this._clearSelectedCards();\n        //重新显示提示牌\n        this._selectedCards = this._findCards(this._playTips[this._tipNum]);\n        for (var i = 0; i < this._selectedCards.length; i++) {\n            this._selectedCards[i].up();\n        }\n        this._operateController.btnPlay.active = true;\n        this._operateController.btnPlay.interactable = true;\n        this._operateController.btnPlay.node.getChildByName(\"bright\").active = true;\n        this._operateController.btnPlay.node.getChildByName(\"hui\").active = false;\n        this._tipNum = (this._tipNum + 1) % len;\n    },\n\n    playAnimationSoundByCardType: function(type, bMale, userPosition) { // 由于产品要求，在播放连对和顺子动画时需要根据出牌人的位置来播放动画\n        var sound;\n        var special_effect;\n        switch (type.getType()) { //播放动画和声音\n            case ddz.Enums.PaixingType.ROCKET:\n                sound = bMale ? \"man_rocket\" : \"female_rocket\";\n                special_effect = \"rocket\";\n\n                this._cardAniPlayer.playRocket();\n                ty.NotificationCenter.trigger(ddz.EventType.BET_SCORE_CHANGE_ANI);\n                break;\n            case ddz.Enums.PaixingType.BOMB_CARD:\n                sound = bMale ? \"man_bomb\" : \"female_bomb\";\n                special_effect = \"bomb\";\n\n                this._cardAniPlayer.playBomb();\n                ty.NotificationCenter.trigger(ddz.EventType.BET_SCORE_CHANGE_ANI);\n                break;\n            case ddz.Enums.PaixingType.AIRCRAFT_CARD:\n                sound = bMale ? \"man_airplane\" : \"female_airplane\";\n                special_effect = this._topCardType == null ? \"airplane_the_first_time\" : \"airplane_beiguan\";\n                this._cardAniPlayer.playPlane();\n                break;\n            case ddz.Enums.PaixingType.AIRCRAFT_SINGLE_CARD:\n            case ddz.Enums.PaixingType.AIRCRAFT_DOUBLE_CARD:\n                this._cardAniPlayer.playPlane();\n                sound = bMale ? \"man_aircraft_with_wings\" : \"female_airplane_with_wing\";\n                special_effect = this._topCardType == null ? \"airplane_the_first_time\" : \"airplane_beiguan\";\n                break;\n            case ddz.Enums.PaixingType.SHUNZI_CARD:\n                this._cardAniPlayer.playShunZi();\n                sound = bMale ? \"man_shunzi\" : \"female_shunzi\";\n                special_effect = \"shunzi\";\n                break;\n            case ddz.Enums.PaixingType.LIANDUI_CARD:\n                // this.playAnim();\n                // this._cardDuiziAnimation.playCardAction(userPosition);\n                this._cardAniPlayer.playLianDui();\n                sound = bMale ? \"man_continuous_pair\" : \"female_continuous_pair\";\n                special_effect = \"continuous_pair\";\n                break;\n            case ddz.Enums.PaixingType.THREE_ONE_CARD:\n                sound = bMale ? \"man_three_with_one\" : \"female_three_with_one\";\n                break;\n            case ddz.Enums.PaixingType.THREE_CARD:\n                sound = bMale ? \"man_three_one\" : \"female_three_one\";\n                break;\n            case ddz.Enums.PaixingType.THREE_TWO_CARD:\n                sound = bMale ? \"man_three_with_one_pair\" : \"female_three_with_one_pair\";\n                break;\n            case ddz.Enums.PaixingType.BOMB_TWO_CARD:\n                sound = bMale ? \"man_four_with_two\" : \"female_four_with_two\";\n                break;\n            case ddz.Enums.PaixingType.BOMB_TWO_TWO_CARD:\n                sound = bMale ? \"man_four_with_one_pair\" : \"female_four_with_two_pair\";\n                break;\n            // case ddz.Enums.PaixingType.SINGLE_CARD:\n            //     sound = bMale ? \"man_\" + type.getPoint() : \"female_\" + type.getPoint();\n            //     break;\n            // case ddz.Enums.PaixingType.DOUBLE_CARD:\n            //     sound = bMale ? \"man_pair\" + type.getPoint() : \"female_pair\" + type.getPoint();\n            //     break;\n            default:\n                break;\n        }\n\n        if (sound) {\n            ddz.LOGD(this._TAG, 'playEffect=' + sound);\n            ddz.AudioHelper.playEffect(ddz.EffectPath_mp3[sound], false);\n        }\n\n        if (special_effect) {\n            ddz.LOGD(this._TAG, 'playEffect=' + special_effect);\n            ddz.AudioHelper.playEffect(ddz.EffectPath_mp3[special_effect], false);\n        }\n\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.Playing_cards, false);\n    },\n\n\n    _sendPlayCardInfo: function(cards) {\n        var params = {\n            'seatId': this._mySeatIndex,\n            'ccrc': this._tableState.normalInfo.m_ccrc,\n            \"roomId\": this._tableInfo.roomId(),\n            \"tableId\": this._tableInfo.tableId(),\n            \"cards\": cards\n        };\n        ddz.MsgFactory.getTableCall(\"card\", params);\n    },\n\n    _playCards: function() {\n        ddz.LOGD(this._TAG, \"play cards in play controller\");\n\n        if (this.isLaizi() && !this._changeLaiZi){\n            hall.MsgBoxManager.showToast({title:'请等待癞子确定后,再出牌!'});\n            return;\n        }\n\n        this._setCardsTipVisible(false);\n\n        var cards = [];\n        var len = this._selectedCards.length;\n\n        if (len > 0) { //判断牌型\n\n            for (var i = 0; i < len; i++) {\n                cards.push(this._selectedCards[i]._info._number);\n            }\n\n            var types = ddz.RobotGlobal.judgeType(cards ,true);\n\n            if (types.length <= 0) {\n                ddz.LOGD(this._TAG, \"in play cards, illegal cards, return\"+JSON.stringify(cards));\n                this._setCardsTipVisible(true, ddz.Enums.PlayCardsTip.PLAYCARDSTIP_ILLEGAL);\n                return;\n            } else {\n\n                var type, checkLarger = false;\n\n                if (this._topCardType){\n                    ddz.LOGD(null, 'topCard : ......');\n                    this._topCardType.dump();\n\n                    for (var j = 0; j < types.length; j++){\n                        type = types[j];\n                        ddz.LOGD(null, \"play cards type : .......\"+type._type);\n                        type.dump();\n                        checkLarger = type.isLargerThan(this._topCardType);\n                        if (checkLarger){\n                            //只要有一个牌型能管上,就认定为可能管上\n                            break;\n                        }\n                    }\n\n                    //管不上,上家的牌\n                    if (!checkLarger) {\n                        ddz.LOGD(this._TAG, \"in play cards, not larger than top card, return\"+JSON.stringify(this._topCardType));\n                        this._setCardsTipVisible(true, ddz.Enums.PlayCardsTip.PLAYCARDSTIP_ILLEGAL);\n                        return;\n                    }\n                }\n                else{\n                    type = types[0];\n                }\n\n\n                if (!this.isMode(ddz.Enums.PlayMode.PLAY_MODE_SINGLE)) {\n                    //在此处单机的不设置不能出牌，联网游戏在收到card action时又设置为true了\n                    this._isUserInteractive = false;\n                }\n\n                cards = type.getCards(); // cards里面有癞子的话，变成了实际牌的值\n            }\n        }\n\n        if (!this.isMode(ddz.Enums.PlayMode.PLAY_MODE_SINGLE)) {\n            this._sendPlayCardInfo(cards); //发送出牌消息\n        }\n    },\n\n\n    _playCardsFromServer: function(cards) { //\n        this._clearPlayedCards(); //最后一张牌服务器替出，不会收到next消息，也就不会清除掉已出的牌。 在这里清除作保障\n        var isMale = this.getIsMale();\n\n        if (cards.length == 0) {\n            this._operateController.showBuchuSprite();\n            var filename = isMale ? \"man_no\" : \"female_no\";\n            ddz.LOGD(this._TAG, 'playEffect=' + filename);\n            ddz.AudioHelper.playEffect(ddz.EffectPath_mp3[filename], false);\n            return;\n        }\n\n        var types = ddz.RobotGlobal.judgeType(cards, false);\n        if (types.length == 0) {\n            ddz.LOGD(null, \"error in _playCardsFromServer!!! type error..\");\n        }\n        this._mySeatinfo.playCards(cards);\n\n        this._clearSelectedCards(true);\n        this._selectedCards = this._findCards(cards);\n        this._playCardsInternal();\n\n        this.playAnimationSoundByCardType(types[0], isMale);\n        this._runPlayCardsAction(cards);\n    },\n\n    /**\n     * 把所有手牌按点数进行分组\n     * @private\n     */\n    _groupCards:function () {\n        var cardGroup = [];\n        var curSubArr;\n        var cardCom, curPoint;\n        var len = this._cards.length;\n        for (var i = 0; i < len; i++){\n            cardCom = this._cards[i];\n            curPoint = cardCom._info._point;\n\n            if (cardGroup.length == 0){\n                curSubArr = [];\n                curSubArr.push(cardCom);\n                cardGroup.push(curSubArr);\n            }\n            else{\n                curSubArr = cardGroup[cardGroup.length-1];\n                if (curSubArr[curSubArr.length-1]._info._point == curPoint){\n                    //点数相同,放到同一数组里\n                    curSubArr.push(cardCom);\n                }\n                else{\n                    //点数不同,新起一个数组\n                    curSubArr = [];\n                    curSubArr.push(cardCom);\n                    cardGroup.push(curSubArr);\n                }\n            }\n        }\n\n        return cardGroup;\n    },\n\n    _getCardCountInLine:function () {\n\n        var firstLineCardCount = 0;\n        var allCardCount = this._cards.length;\n\n        if (allCardCount <= 10){\n            firstLineCardCount = allCardCount;\n        }\n        else{\n            var curSubArr;\n            var lineCardCount = 0;\n            var cardGroup = this._groupCards();\n            var nextCount;\n            for (var i = 0; i < cardGroup.length; i++){\n                curSubArr = cardGroup[i];\n                nextCount = lineCardCount + curSubArr.length;\n                if (nextCount > 10){\n                    if (allCardCount - lineCardCount <= 10){\n                        //第一行装不下,第二行能装下,最后一组放第二行\n                        firstLineCardCount = lineCardCount;\n                    }\n                    else{\n                        firstLineCardCount = 10;\n                    }\n                    break;\n                }\n\n                lineCardCount += curSubArr.length;\n            }\n        }\n\n        return firstLineCardCount;\n    },\n\n    /**\n     * 重新排序手牌(跟refresh的区别是：有动画，不会有增加牌的情况。 如果增加牌，必须用refreshCardsLayer，因为增加必须删除原来的)\n     * @private\n     */\n    _reorderCardsLayer: function() {\n        ddz.LOGD(this._TAG, \"1111111 _reorderCardsLayer\");\n        var len = this._cards.length;\n        if (len <= 0) {\n            return;\n        }\n\n        this.playedCardArea.removeAllChildren();\n        this._refreshLayoutData();\n\n        var cardCom, des, poker;\n        var canShowTag;\n        for (var index = 0; index < len; index++) {\n            canShowTag = ((index == this.firstLineCardCount - 1) || (index == len - 1));\n            cardCom = this._cards[index];\n            poker = cardCom.node;\n            des = this._getPosFromIndex(index);\n            cardCom.setOldPosition(des);\n            cardCom.setZIndex(index);\n            cardCom.showTag(canShowTag);\n            cardCom.setDiZhuTag(this._isDizhu(this._mySeatIndex) && canShowTag);\n            poker.stopAllActions();\n            poker.runAction(cc.moveTo(0.1, des));\n        }\n    },\n\n\n    /**\n     * 从手牌中移除打出牌数据\n     * @private\n     */\n    _playCardsInternal: function() {\n        //把cards中selected cards移除，以便重新排列\n        var scard, index;\n        for (var i = 0; i < this._selectedCards.length; i++) {\n            scard = this._selectedCards[i];\n            index = hall.GlobalFuncs.FindInArray(this._cards, scard);\n            if (index >= 0) {\n                this._cards.splice(index, 1);\n            } else {\n                ddz.LOGD(this._TAG, \"error, not found selected card in cards!!!!!!!!\" + scard._info._number);\n            }\n        }\n        if (this._selectedCards.length <= 0) {\n            //出的牌数为0，就不再说剩几张牌了\n            return;\n        }\n\n        //在此处增加牌型的判断\n        this._reorderCardsLayer();\n\n        var audio;\n        var isMale = this.getIsMale();\n        var leftCardsNum = this._cards.length;\n        if (leftCardsNum == 2) {\n            audio = isMale ? \"man_\" : \"female_\";\n            audio += \"I_got_left_two_cards\";\n            ddz.LOGD(this._TAG, 'playEffect=' + audio);\n            ddz.AudioHelper.playEffect(ddz.EffectPath_mp3[audio], false);\n        } else if (leftCardsNum == 1) {\n            audio = isMale ? \"man_\" : \"female_\";\n            audio += \"I_got_left_one_cards\";\n            ddz.LOGD(this._TAG, 'playEffect=' + audio);\n            ddz.AudioHelper.playEffect(ddz.EffectPath_mp3[audio], false);\n        }\n    },\n\n    _runPlayCardsAction: function(cards) {\n        var length = this._selectedCards.length;\n        if (length <= 0) {\n            return;\n        }\n\n        var startY = 0;\n        var startX = 0;\n        var breakline = 10;\n        var splitWidth = 55;\n        if (length > 10){\n            startY = this.FIRSTLINECARDY;\n            startX = 0;\n        }\n        else{\n            startY = 0;\n            startX = (this.playedCardArea.width - ((length - 1) * splitWidth + ddz.CARD_BIG_SIZE.width)) / 2;\n        }\n\n        var tox,toy;\n\n        var canShowTag,card, cardNum;\n        for (var i = 0; i < length; i++) {\n\n            canShowTag = ddz.GlobalFuncs.canShowTag(this._cardsBreakline, length, i);\n            // canShowTag = ((i == this.firstLineCardCount - 1) || (i == length - 1));\n\n            card = this._selectedCards.shift();\n            cardNum = cards[i];\n            if (this.isLaizi()){\n                //癞子场,需要把牌的点数据重新设置,因为从服务器返回后,点数会改变\n                card.resetWithNum(cardNum);\n            }\n\n            card.showTag(canShowTag);\n            card.setDiZhuTag(this._isDizhu(this._mySeatIndex) && canShowTag);\n            card.setZIndex(i);\n            card.showMask(false);\n            this._playedCards.push(card);\n            card.node.parent = this.playedCardArea;\n\n            tox = (i % breakline) * splitWidth + startX;\n            toy = startY - Math.floor(i/breakline) * 56;\n\n            card.node.setPosition(tox, toy);\n        }\n\n        ddz.GlobalFuncs.showDropEffect(this._cardBaseScale, this.playedCardArea);\n    },\n\n    _clearSelectedCards: function(withOutAni) {\n        if (cc.isValid(this.cardsTip)){\n            // this.cardsTip.string = \"\";\n            this.cardsTip.node.active = false;\n        }\n        ddz.LOGD(this._TAG, \"clear selected cards len = ***\" + this._selectedCards.length);\n        var card;\n        while (this._selectedCards.length > 0){\n            card = this._selectedCards.pop();\n            card.down(withOutAni);\n        }\n        this._operateController.btnPlay.active = false;\n    },\n\n    //开始托管\n    startDeposite: function() {\n        if (this._isInTrust || this.isStatus(ddz.Enums.PlayStatus.PLAY_STATUS_PREPARE)) {\n            //alert(\"not allowed to deposite\");\n            return;\n        }\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.button_click_sound, false);\n        ddz.LOGD(this._TAG, '托管状态 startDeposite');\n        // this.setIsInTrust(true);\n        this._isTrustEnable = false;\n        var params = {\n            'seatId': this._mySeatIndex,\n            \"roomId\": this._tableInfo.roomId(),\n            \"tableId\": this._tableInfo.tableId()\n        };\n        ddz.MsgFactory.getTableCall(\"robot\", params);\n    },\n\n    /**\n     * 取消托管\n     * @private\n     */\n    _cancelDeposite: function() {\n        this.setIsInTrust(false);\n        this._isTrustEnable = true;\n        var params = {\n            'seatId': this._mySeatIndex,\n            \"roomId\": this._tableInfo.normal.m_roomId,\n            \"tableId\": this._tableInfo.normal.m_tableId\n        };\n        ddz.MsgFactory.getTableCall(\"robot\", params);\n    },\n\n    /************************************* table call 相关开始 ***************************************/\n\n    onActionWildCard: function(result) {\n        // var p = result[\"wildcard\"];\n        // this._tableState.setLaizi(p);\n\n        var self = this;\n        var delayTime = 1.8;\n\n        var p = result[\"wildcard\"];\n        self._tableState.setLaizi(p);\n\n        self._resetPlayerCardsWithLaizi();\n        self.playChooseLaiziAnimation();\n\n        this.scheduleOnce(function () {\n            self._changeLaiZi = true;\n        }, delayTime);\n    },\n\n    playChooseLaiziAnimation:function () {\n        this._cardAniPlayer.playLaiZi();\n    },\n\n    getEmoPos: function(index){\n        var pos;\n        if (index == ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex)) {\n            pos = this.chatNode.convertToNodeSpace(this.head_regiht.convertToWorldSpace(cc.p(0,0)));\n            // pos = this.chatNode.convertToNodeSpace(this.head_regiht.getPosition());\n        } else if (index == ddz.GlobalFuncs.getPreIndex(this._mySeatIndex)) {\n            pos = this.chatNode.convertToNodeSpace(this.head_left.convertToWorldSpace(cc.p(0,0)));\n            // pos = this.chatNode.convertToNodeSpace(this.head_left.getPosition());\n        }else {\n            // pos = this.chatNode.convertToNodeSpace(this.myAvatar.getPosition());\n            pos = this.chatNode.convertToNodeSpace(this.myAvatar.convertToWorldSpace(cc.p(0,0)));\n        }\n\n        return pos;\n    },\n\n    // 互动表情\n    onActionChat: function(result) {\n        var to_pos = this.getEmoPos(result['toseat']);\n        var from_pos = this.getEmoPos(result['fromseat']);\n\n        var that = this;\n\n        if (result['fromseat'] == this._mySeatIndex) {\n            if (result['toseat'] == ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex)){   // 下家\n                that.head_regiht.stopAllActions();\n                ddz.CHAT_COOLING_TIMER_RIGHT = 6;\n                var _call_right = function() {\n                    if (ddz.CHAT_COOLING_TIMER_RIGHT >= 0) {\n                        if (that._rightChatController) {\n                            that._rightChatController.isCooling(ddz.CHAT_COOLING_TIMER_RIGHT);\n                        }\n                        that.head_regiht.runAction(cc.sequence(cc.delayTime(1), cc.callFunc(_call_right, that)));\n                        ddz.CHAT_COOLING_TIMER_RIGHT = ddz.CHAT_COOLING_TIMER_RIGHT - 1;\n                    }\n                };\n                _call_right();\n            }else if (result['toseat'] == ddz.GlobalFuncs.getPreIndex(this._mySeatIndex)){  // 上家\n                that.head_left.stopAllActions();\n                ddz.CHAT_COOLING_TIMER_LEFT = 6;\n                var _call_left = function() {\n                    if (ddz.CHAT_COOLING_TIMER_LEFT >= 0) {\n                        if (that._leftChatController) {\n                            that._leftChatController.isCooling(ddz.CHAT_COOLING_TIMER_LEFT);\n                        }\n                        that.head_left.runAction(cc.sequence(cc.delayTime(1), cc.callFunc(_call_left, that)));\n                        ddz.CHAT_COOLING_TIMER_LEFT = ddz.CHAT_COOLING_TIMER_LEFT - 1;\n                    }\n                };\n                _call_left();\n            }\n        }\n        var emoId = result['smilies'];\n        var startFunc = function(_preFabNode,_callFunc){\n            _preFabNode.x = to_pos.x;\n            _preFabNode.y = to_pos.y;\n\n        };\n        var gStartFunc = function (_preFabNode,_callFunc){\n            _preFabNode.x = from_pos.x;\n            _preFabNode.y = from_pos.y;\n            // var move = cc.moveTo(1, to_pos);\n            var midy;\n            var midx;\n\n            if (Math.abs(to_pos.x - from_pos.x) < 100){\n                midx = to_pos.x + 200;\n                midy = from_pos.y + (to_pos.y - from_pos.y)/2;\n            }else if (Math.abs(to_pos.y - from_pos.y) < 100){\n                midx = (to_pos.x - from_pos.x) / 2;\n                midy = from_pos.y;\n            }else {\n                midx = -200;\n                midy = from_pos.y + (to_pos.y - from_pos.y)/2 + 100;\n            }\n            ddz.LOGD(\"\", \"曲线运动中间点 midx = \" + midx + \"  midy = \" + midy );\n            var midPoint = cc.p(midx, midy);\n            var controlPoints1 = [     from_pos,     midPoint,     to_pos   ];\n            var bezierToDst1 = cc.bezierTo(0.7, controlPoints1);\n\n            _preFabNode.runAction(cc.sequence(bezierToDst1, cc.callFunc(function () {\n                if (emoId == 'brick') {\n                    to_pos.x = to_pos.x - 42;\n                    to_pos.y = to_pos.y - 36;\n                }\n                switch (emoId){\n                    case 'flower': // 花\n                        this._chatAniPlayer.playFlower(startFunc,null);\n                        break;\n                    case 'diamond': // 钻石\n                        this._chatAniPlayer.playDiamond(startFunc,null);\n                        // gStr = 'ani/ddz_bq/ddz_table_interactive_emotion1_0_action/zuanjie';\n                        break;\n                    case 'egg': // 鸡蛋\n                        this._chatAniPlayer.playEgg(startFunc,null);\n                        break;\n                    case 'brick': // 板砖\n                        this._chatAniPlayer.playBrick(startFunc,null);\n                        break;\n                }\n                if (_callFunc) {\n                    _callFunc();\n                }\n            }, that)));\n        };\n\n        switch (emoId){\n            case 'flower': // 花\n                this._chatAniPlayer.playFlowerFly(gStartFunc,null);\n                break;\n            case 'diamond': // 钻石\n                this._chatAniPlayer.playDiamondFly(gStartFunc,null);\n                // gStr = 'ani/ddz_bq/ddz_table_interactive_emotion1_0_action/zuanjie';\n                break;\n            case 'egg': // 鸡蛋\n                this._chatAniPlayer.playEggFly(gStartFunc,null);\n                break;\n            case 'brick': // 板砖\n                this._chatAniPlayer.playBrickFly(gStartFunc,null);\n                break;\n        }\n    },\n\n    //响应onTableCall中的各个action，这部分的函数需要提取到子类中\n    //当某玩家准备后，服务器广播该玩家的 准备 消息。所有玩家收到此消息后，在牌桌上更新准备玩家的状态\n    onActionReady: function(sid) {\n        if (sid == this._mySeatIndex) {\n            this._mySeatinfo.model.m_state = ddz.Enums.SeatState.SEATDZSTAT_READY;\n            if (this.tableInfo().getSceneType() == ddz.Enums.SceneType.FRIEND){\n                this._friendPanel.setBtnReadyState(false);\n                this._operateController.showPrepare(true);\n            }\n        } else if (sid == ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex)) {\n            ddz.LOGD(this._TAG, \"action == right game_ready\");\n            this._rightPlayerController.setPrepareVisible(true);\n            this._rightSeatinfo.model.m_state = ddz.Enums.SeatState.SEATDZSTAT_READY;\n        } else {\n            ddz.LOGD(this._TAG, \"action == left game_ready\");\n            this._leftPlayerController.setPrepareVisible(true);\n            this._leftSeatinfo.model.m_state = ddz.Enums.SeatState.SEATDZSTAT_READY;\n        }\n    },\n\n    onActionGameReady: function(result) {\n        //ty.NotificationCenter.trigger(\"game_ready\");\n        ddz.LOGD(this._TAG, \"action == game_ready\");\n        this.hideStage();\n        if (this.tableInfo().ftInfo){\n            this.tableInfo().ftInfo.parseGameReady(result);\n\n            if (this.tableInfo().ftInfo.curRound == 1){\n                //第一局,开局\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeStartFriendGame,\n                    [ddz.Share.shareKeywordReplace.inviteFriendID,\n                        ddz.Share.shareKeywordReplace.totalRound,\n                        ddz.Share.shareKeywordReplace.displayName,\n                        ddz.Share.shareKeywordReplace.goodCard]);\n            }\n        }\n\n        var mycards = result[\"cards\" + (this._mySeatIndex - 1)];\n        var saveDic = {myCards:mycards,baseCard:result.basecard};\n        hall.GlobalFuncs.setInLocalStorage(ddz.gameModel.ORIGINCARDS, JSON.stringify(saveDic));\n        var rcards,lcards;\n        this._mySeatinfo.model.m_card = mycards;\n        rcards = result[\"cards\" + (ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex) - 1)];\n        this._rightSeatinfo.model.m_card = rcards;\n\n        lcards = result[\"cards\" + (ddz.GlobalFuncs.getPreIndex(this._mySeatIndex) - 1)];\n        this._leftSeatinfo.model.m_card = lcards;\n\n        this._leftPlayerController.changeShowLeftNum(0);\n        this._rightPlayerController.changeShowLeftNum(0);\n\n        //初始化自己的牌，根据count值，对上图片等等\n        // this._initMyCards();\n\n        this.playCardAni();\n\n        this._returnAllCards();\n        this._showCardIndex = 0;\n\n        var card, cardCom;\n        for (var i = 0; i < mycards.length; i++) {\n            card = this.createNewCard(mycards[i]);\n            cardCom = card.getComponent('Card');\n            cardCom.showMask(false);\n            this._cards.push(cardCom);\n\n            card.active = false;\n            this.cardsContainer.addChild(card);\n        }\n        this._cards.sort(ddz.GlobalFuncs.SortCardFunc);\n        this._refreshLayoutData();\n\n        var rc = 17;\n        var allTime = 1;\n        ty.Timer.setTimer(this, this.addCardToPlayer, allTime/rc, rc, 17/30);\n\n        //refresh extra cards info\n        this._tableState.objectInfo.m_baseCard = result[\"basecard\"];\n        this._resetExtraCards();\n\n        //游戏设置为叫地主状态，等待服务器返回轮到谁叫地主\n        this._startJiaodz();\n\n        this.upDateGoldInfo();\n        ty.NotificationCenter.trigger(ddz.EventType.GAME_READY);\n\n        if (result.myCardNote) {\n            this.myCardNote = result.myCardNote;\n            ty.NotificationCenter.trigger(ddz.EventType.UPDATE_CARD_NOTE, this.myCardNote);\n        }\n\n        if (this.tableInfo().getSceneType() == ddz.Enums.SceneType.MATCH){\n            if (!this.jipaiqi.active) {\n                this.jipaiqi.active = true;\n            }\n        }\n\n        // ddz.LOGD(this._TAG, \"当前时间:\" + new Date().getTime());\n    },\n\n    playCardAni:function () {\n        this.faPai.active = true;\n        // var fapai = this.faPai.getComponent(cc.Widget);\n        // fapai.top = 353;\n        var animationCom = this.faPai.getComponent(cc.Animation);\n        var ani = animationCom.getAnimationState('fapai_anim');\n        ani.play();\n    },\n\n    stopCardAni:function () {\n        var animationCom = this.faPai.getComponent(cc.Animation);\n        var ani = animationCom.getAnimationState('fapai_anim');\n        if (ani.isPlaying){\n            ani.stop();\n            this.faPai.active = false;\n        }\n    },\n\n    changeToShowFromHide : function (timeGap) {\n        // var isAddCard = ty.Timer.isScheduledTimer(this, this.addCardToPlayer);\n        // ddz.LOGD(this._TAG, \"======================ty.Timer.isScheduledTimer==============\"+isAddCard);\n        // if(isAddCard){\n        if (this.isStatus(ddz.Enums.PlayStatus.PLAY_STATUS_GAMEOVER)){\n            //已经结束的状态不用再刷新牌桌\n            return;\n        }\n\n        this.stopCardAni();\n        ty.Timer.cancelTimer(this, this.addCardToPlayer);\n        if(this._cards){\n            for (var i = 0; i < this._cards.length; i ++){\n                var cardCom = this._cards[i];\n                cardCom.node.active = true;\n            }\n        }\n\n        this._refreshCardsLayer();\n        this.refreshOtherPlayerCardsNum();\n        //     ddz.LOGD(this._TAG, \"=======================changeToShowFromHide==============\");\n        // }\n    },\n    onGameHide : function () {\n        this.hideStage();\n    },\n\n    // 表情面板点击头像按钮\n    onClickHeadBtn : function (index) {\n        this.clickChatButton(index);\n    },\n\n    addCardToPlayer:function () {\n\n        var index = this._showCardIndex;\n\n        var cardCom = this._cards[index];\n        //有问题,容错\n        if(!cardCom){\n            return;\n        }\n        cardCom.node.active = true;\n        cardCom.showTag(true);\n        cardCom.setDiZhuTag(false);\n        cardCom.setPosition(this._getPosFromIndex(index));\n        cardCom.setZIndex(index);\n\n        if (index > 0 && index - 1 != 9){\n            this._cards[index - 1].showTag(false);\n        }\n\n        this._showCardIndex++;\n        if (this._showCardIndex == 17){\n            ty.Timer.cancelTimer(this, this.addCardToPlayer);\n            this.faPai.active = false;\n            if (this._waitShowJiaoDiZhu){\n                this.showCallPanel();\n            }\n        }\n\n        this._leftPlayerController.changeShowLeftNum(this._showCardIndex);\n        this._rightPlayerController.changeShowLeftNum(this._showCardIndex);\n\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.click_cards, false);\n    },\n\n    showCallPanel:function () {\n        this._operateController.showJiaodz(this._tableState.normalInfo.m_call);\n        this._operateController.showClock();\n        this._waitShowJiaoDiZhu = false;\n    },\n\n    getOpTime:function (result) {\n        var time = result[\"opTime\"];\n        if (this.tableInfo().getSceneType() == ddz.Enums.SceneType.FRIEND){\n            time = ddz.FriendOpTimeOut;\n        }\n        return time;\n    },\n\n    onActionNext: function(result) {\n        //（3）轮到谁叫地主\n        //（6）轮到谁出牌\n        ddz.LOGD(this._TAG, \"onActionNext action == next\");\n        // ddz.LOGD(this._TAG, \"当前时间:\" + new Date().getTime());\n        //第一次收到出牌的next消息时候，切换状态\n        if (this._tableState.normalInfo.m_state == ddz.Enums.TableState.TABLEDSTAT_PLAYING && this._status == ddz.Enums.PlayStatus.PLAY_STATUS_JIAODZ) {\n            if (!this._isDizhu(this._mySeatIndex)) {\n                this._startPlay();\n            }\n        }\n\n        //轮到谁了\n        var index = result[\"next\"];\n\n        if (this._tableState.normalInfo.m_topseat == index) {\n            // 一轮打牌结束，清除游戏中的不出状态值\n            ty.Timer.setTimer(this, this._onOneGameCircle, 0.2, 1, 0);\n        }\n\n        //更新时间\n        var time = this.getOpTime(result);\n\n        //轮到我操作，根据状态，确定是选择叫地主还是选择出牌\n        if (index == this._mySeatIndex) {\n            //托管状态不做任何操作\n            ddz.LOGD(this._TAG, \"index == this._mySeatIndex\");\n            if (this._isInTrust) {\n                // this._unvisibleErdouRangPaiHint();\n                return;\n            }\n            this._clearPlayedCards();\n            this._operateController.hideAll();\n\n            //叫地主，显示叫地主操作面板（1分 2分，不叫等）\n            if (this._tableState.normalInfo.m_state == ddz.Enums.TableState.TABLEDSTAT_CALLING && !this.isReplay()) {\n                this._waitShowJiaoDiZhu = false;\n                if (!this.faPai.active){\n                    //如果已经发完牌了,直接显示叫地主\n                    this._operateController.showJiaodz(this._tableState.normalInfo.m_call);\n                }\n                else{\n                    this._waitShowJiaoDiZhu = true;\n                }\n            }\n            //被动出牌时候是不是管不上？\n            var bNoCard = false;\n\n            //出牌，显示出牌操作面板\n            if (this._tableState.normalInfo.m_state == ddz.Enums.TableState.TABLEDSTAT_PLAYING) {\n\n                if (this._resetTopCardType()) {\n                    bNoCard = true;\n                }\n\n                if (!this.isReplay()) {\n                    this._operateController.showPlay(bNoCard);\n                }\n            }\n            // if (bNoCard) {\n            //     time = this._tableInfo.config.m_passtime + Math.floor(Math.random() * 3 + 1);\n            // }\n            ddz.LOGD(this._TAG, \"show my Time :\" + time);\n            //显示时间\n            this._operateController.setClockVisible(true, time);\n\n            if (this.faPai.active) {\n                this._operateController.hideClock();\n            }\n        }\n        //若轮到别人，则只显示别人操作的时钟计时\n        else {\n            //右边显示闹钟\n            if (index == ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex)) {\n                this._rightPlayerController.setClockVisible(true, time);\n            }\n            else {//左边显示闹钟\n                this._leftPlayerController.setClockVisible(true, time);\n            }\n\n        }\n    },\n\n    _onOneGameCircle: function() {\n        ty.Timer.cancelTimer(this, this._onOneGameCircle);\n\n        if (this._tableState.normalInfo.m_state != ddz.Enums.TableState.TABLEDSTAT_PLAYING) {\n            return;\n        }\n\n        var leftindex = ddz.GlobalFuncs.getPreIndex(this._mySeatIndex);\n\n        var userIndex = this._tableState.normalInfo.m_topseat;\n\n        if (userIndex == this._mySeatIndex) {\n            //清除两家的不出\n            this._leftPlayerController.setLblMsg(\" \");\n            this._rightPlayerController.setLblMsg(\" \");\n            return;\n        }\n\n        if (userIndex == leftindex) {\n            //清除本家和右家\n            this._operateController.setLblMsg(\" \");\n            this._rightPlayerController.setLblMsg(\" \");\n            return;\n        }\n\n        //清除本家,和左家\n        this._operateController.setLblMsg(\" \");\n        this._leftPlayerController.setLblMsg(\" \");\n    },\n\n\n    onActionCall: function(result) {\n        var index = result[\"seatId\"];\n        var call = result[\"call\"];\n        var nextIndex = ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex);\n        var preIndex = ddz.GlobalFuncs.getPreIndex(this._mySeatIndex);\n\n        //刚才是我的下家叫的地主\n        ddz.LOGD(this._TAG, \"onActionCall  index = \" + index + \"_mySeatIndex:\" + this._mySeatIndex + \";nextIndex:\" + nextIndex + \";preIndex:\" + preIndex);\n\n        if (index == this._mySeatIndex) {\n            this._operateController.showCallNode(false);\n            if (call > 0){\n                this._operateController.setClockVisible(false);\n            }\n        }else if (index == nextIndex) {\n            this._rightSeatinfo.model.m_call = call;\n            this._rightPlayerController.setClockVisible(false);\n            this._rightPlayerController.showJiaodz(call);\n        }\n        else if (index == preIndex) {\n            //刚才是我的上家叫的地主\n            this._leftSeatinfo.model.m_call = call;\n            this._leftPlayerController.setClockVisible(false);\n            this._leftPlayerController.showJiaodz(call);\n        }\n\n        if (this._tableInfo.config.m_grab == 1 && this._mDizhuCalled == false && call == 1) { //如果是抢地主模式，第一个叫1分，则地主被叫，接下来就是抢地主或者不抢\n            this._mDizhuCalled = true;\n        }\n\n        this._refreshMultipleLabel(false, true, true);\n    },\n\n    onActionGameStart: function(result) {\n        ddz.LOGD(this._TAG, \"action == game_start\");\n        if (result.hasOwnProperty('stat')){\n            this.updateTableState(result);\n            this._resetExtraCards();\n        }\n        \n        //看返回的nowop字段，如果是该我操作，那就是我为地主，否则不是\n        this._finishJiaodz();\n        this.changePlayerAvatar(true);\n        this._flipExtraCards(false, true);\n\n        ddz.gameModel.isAcceptGameWin = false;\n\n        if (this._goldPanel){\n            var roomId = this._tableInfo.roomId();\n            this._goldPanel.showTboxGetReward(result,roomId);\n        }\n\n        if (result.myCardNote) {\n            this.myCardNote = result.myCardNote;\n            ty.NotificationCenter.trigger(ddz.EventType.UPDATE_CARD_NOTE, this.myCardNote);\n        }\n\n        if (this.tableInfo().getSceneType() == ddz.Enums.SceneType.MATCH) {\n            if (ddz.gameModel.firstUseJiPaiQiPoint > 0){// 首次得记牌器\n                ddz.gameModel.shareToGetreward(ddz.Share.SharePointType.firstUseJiPaiQi);\n            }else {\n                this.userJiPaiQi();\n            }\n\n            // this.userJiPaiQi();\n        }\n    },\n\n    userJiPaiQi:function(){\n        var roomId = this._tableInfo.roomId();\n        var tableId = this._tableInfo.tableId();\n        var seatId = this._mySeatIndex;\n        ddz.MsgFactory.getCradNote(roomId, tableId, seatId);\n    },\n\n    onActionCardNote:function(result){\n        if (result && result.isOpen == 1) {\n            if (result.myCardNote) {\n                this.myCardNote = result.myCardNote;\n                ty.NotificationCenter.trigger(ddz.EventType.OPEN_JIPAIJI, {\"myCardNote\":this.myCardNote,\"num\":result.cardNoteCount});\n            }\n        }else if (result && result.isOpen == 0) {\n            if (ddz.isClickJiPaiQi){\n                hall.MsgBoxManager.showToast({\"title\":\"宝箱里含有记牌器~\"});\n            }\n        }\n        ddz.isClickJiPaiQi = false;\n    },\n\n    /**\n     * 哪个座位打的什么牌\n     * @param result\n     */\n    onActionCard: function(result) {\n        //解析刚才是谁打了什么牌，以便在牌桌上显示\n        ddz.LOGD(this._TAG, \"action == card\");\n        //哪个座位打的什么牌\n        var index = result[\"seatId\"];\n        var cards = result[\"cards\"];\n\n        if (result.myCardNote) {\n            this.myCardNote = result.myCardNote;\n            ty.NotificationCenter.trigger(ddz.EventType.UPDATE_CARD_NOTE, this.myCardNote);\n        }\n\n        var cardTypd ,sortedCards;\n\n        if (cards.length > 3){\n            var card_types = ddz.RobotGlobal.judgeType(cards, true);\n\n            if (card_types.length > 0){\n                cardTypd = card_types[0];\n                sortedCards = cardTypd.getCards();\n            }\n            else{\n                sortedCards = ddz.AI.sordPlayCards(cards);\n            }\n        }\n        else{\n            sortedCards = cards;\n        }\n        if (index == ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex)) {\n            //是我的下家打得牌\n            this._rightPlayerController.setClockVisible(false);\n            // if (this._friendPanel){\n                this._rightSeatinfo.playCardsInFriend(cards);\n            // }\n            // else{\n            //     this._rightSeatinfo.playCards(cards);\n            // }\n            this._rightPlayerController.playCards(sortedCards, this._isDizhu(index));\n            return;\n        } else if (index == ddz.GlobalFuncs.getPreIndex(this._mySeatIndex)) {\n            //是我的上家打得牌\n            this._leftPlayerController.setClockVisible(false);\n            // if (this._friendPanel){\n                this._leftSeatinfo.playCardsInFriend(cards);\n            // }\n            // else {\n            //     this._leftSeatinfo.playCards(cards);\n            // }\n            this._leftPlayerController.playCards(sortedCards, this._isDizhu(index));\n            return;\n        }\n\n        //===================是我刚才打出去的牌=====================//\n        this._isUserInteractive = true;\n\n        this._setCardsTipVisible(false);\n        this._operateController.hideAll();\n        this._playCardsFromServer(sortedCards);\n    },\n\n    /**\n     * 托管\n     * @param result\n     */\n    onActionRb: function(result) {\n        var robots = result[\"robots\"]; //[1, 0, 0]\n        var tips = result[\"tips\"];\n        if (tips) {\n            hall.MsgBoxManager.showToast({title : tips});\n            return;\n        }\n        ddz.LOGD(this._TAG, \"托管状态 onActionRb this._mySeatIndex = \" + this._mySeatIndex);\n        //我被托管\n        if (robots[this._mySeatIndex - 1]) {\n            ddz.LOGD(this._TAG, \"托管状态 ： 我被托管了\");\n            this._clearSelectedCards(true);\n            this._clearTouchedCards();\n            this.setIsInTrust(true);\n        } else {\n            ddz.LOGD(this._TAG, '托管状态 ： 别人被托管了');\n        }\n    },\n\n    onActionGameWin: function(result) {\n        ddz.matchModel.new_gift_reward = null;\n        ddz.matchModel.canShowMatchRevivalPanel = true;\n        hall.adManager.canShowTableTopBanner = false;\n        hall.adManager.canShowTableBanner = false;\n\n        var isOncePlay = hall.GlobalFuncs.ReadStringFromLocalStorage(ddz.gameModel.ONCEPLAYGAME, false);\n        if (!isOncePlay) {\n            hall.GlobalFuncs.setInLocalStorage(ddz.gameModel.ONCEPLAYGAME, true);\n        }\n\n        ddz.gameModel.throughCount = this._mySeatinfo.model.m_playinfo.playcount;\n        ddz.gameModel.isAcceptGameWin = true;\n\n        // 首先判断是否是流局\n        var that = this;\n        var dzwin = result[\"dizhuwin\"];\n\n        this._leftPlayerController.setChatButtonActive(false);\n        this._rightPlayerController.setChatButtonActive(false);\n        this._operateController.setChatButtonActive(false);\n\n        ty.NotificationCenter.trigger(ddz.EventType.CLOSE_JIPAIJI);\n        \n        // if (ddz.bannerCloseBtn) {\n        //     ddz.bannerCloseBtn.onClose();\n        // }\n        var isFlow = result && result.hasOwnProperty('nowin') && result['nowin'] === 1;\n\n        if (isFlow) {\n\n            //显示流局图片,\n            this._cardAniPlayer.playGameFlow();\n\n            if (this.tableInfo().getSceneType() == ddz.Enums.SceneType.MATCH){\n                ddz.matchModel.isGameFlow = true;\n                ddz.matchModel.getMatchDes();\n                //流局重新发牌\n                ty.Timer.setTimer(this, function () {\n                    that._reset();\n\n                    if (ddz.matchModel.checkOldVersion() && ddz.matchModel.getStageIndex() === 1){\n                        ddz.matchModel.matchSignin();\n                    }else {\n                        //修改为第一关失败,还会在比赛进程里,流局可以直接发挑战\n                        ddz.matchModel.matchChallenge();\n                    }\n\n                }, 1, 0);\n\n                return;\n            }\n\n            if (this._goldPanel){\n                this.scheduleOnce(function () {\n                    that._reset();\n                    var playModel = that.tableInfo().playMode;\n                    var _mixID = that.tableInfo().mixId;\n                    hall.MsgFactory.getQuickStart(ty.UserInfo.userId, ddz.GameId, ddz.quickStartModel.getRoomId(), hall.staticSystemInfo.version, null, null, null,null,_mixID,playModel);\n                }, 2);\n                return;\n            }\n        }\n        else{\n            ty.NotificationCenter.trigger(ddz.EventType.SHOW_GAME_WIN_ANI, dzwin);\n        }\n\n        var isChunTian = false;\n\n        if (!isFlow && this._tableState.normalInfo.m_chuntian > 1) {\n            //播放春天动画\n            this._cardAniPlayer.playChunTian();\n            isChunTian = true;\n\n        }\n\n        if (this.tableInfo().getSceneType() == ddz.Enums.SceneType.MATCH) {\n            ddz.matchModel.isDiZhuWin = dzwin;\n            ddz.matchModel.getMatchDes();\n        }\n\n        this._operateController.hideAll();\n        this.cardsTip.string = \"\";\n        //游戏结束\n        this.setStatus(ddz.Enums.PlayStatus.PLAY_STATUS_GAMEOVER);\n        // this._tableInfo.parseComplain(result);\n        this._tableState.parseTableState(result[\"stat\"]);\n\n        // 好友桌对局流水\n\n        var ftInfo = this._tableInfo.ftInfo;\n\n        if (ftInfo && result.results && result.results.length > 0){\n            ftInfo.parseGameWin(result);\n            // hall.GlobalFuncs.onShowDetail(this);\n        }\n\n        if (that._friendPanel) {\n            if (result['curRound'] < result['totalRound']){\n                // ty.Timer.setTimer(this, function () {\n                //     if (that._friendPanel) {\n                //         that._reset();\n                //         that._friendPanel.setBtnReadyState(!ftInfo.allComplete);\n                //     }\n                // }, 8, 0);\n            }\n            else{\n                ty.Timer.setTimer(this, function () {\n                    ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeEndFriendGame,\n                        [that.tableInfo().ftInfo.totalRound,that.tableInfo().ftInfo.curRound,ddz.Share.shareKeywordReplace.goodCard]);\n                    hall.GlobalFuncs.onShowDetail();\n                }, 7, 0);\n            }\n        }\n\n        //修复春天后,不加倍的BUG.\n        this._refreshMultipleLabel(false, true);\n\n        //刷新金币\n        this._isTrustEnable = false;\n        this._isUserInteractive = false;\n        this._startGameOverAnimation(result);\n\n        if(result.new_gift_reward){\n            ddz.matchModel.new_gift_reward = result.new_gift_reward;\n        }\n\n        if (isChunTian) {\n            ty.NotificationCenter.trigger(ddz.EventType.SET_BOX_TYPE, \"春天宝箱\");\n        }\n\n        // ty.Timer.setTimer(this, function () {\n        //     hall.GlobalFuncs.onTreasureBox();\n        // }, 4, 0);\n    },\n\n    _startGameOverAnimation: function(result) {\n        ddz.LOGD(this._TAG, \"_startGameOverAnimation 游戏结束\");\n\n        //判断游戏结果\n        this._leftPlayerController.setPrepareVisible(false);\n        this._rightPlayerController.setPrepareVisible(false);\n\n        this._leftPlayerController.setChatButtonActive(false);\n        this._rightPlayerController.setChatButtonActive(false);\n        this._operateController.setChatButtonActive(false);\n\n        var leftindex = ddz.GlobalFuncs.getPreIndex(this._mySeatIndex);\n        var rightindex = ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex);\n\n        if (this._friendPanel){\n            this._friendPanel.updateAllScore();\n        }\n\n        if (this._goldPanel){\n            result.mySeatIndex = this._mySeatIndex;\n            this._goldPanel.updateAllScore(result);\n        }\n\n        if(this._arenaPanel) {\n            this._arenaPanel.updateAllScore(result);\n        }\n\n        //游戏结束后的明牌相关\n        this._showCardsWhenGameOver(result, leftindex, rightindex);\n        // 取消托管状态\n        this.setIsInTrust(false);\n        \n        // 金币场显示结算\n        if (this._goldPanel) {\n            this.scheduleOnce(function () {\n                this._goldPanel.showResult(result);\n            }.bind(this),5.5);\n        }\n\n        // 闯关赛显示结算\n        if (this._throughPanel) {\n            this.scheduleOnce(function () {\n                result.mySeatIndex = this._mySeatIndex;\n                this._throughPanel.showResult(result);\n            }.bind(this),3);\n        }\n\n        // \n        if (this._friendPanel) {\n            this.scheduleOnce(function () {\n                this._friendPanel.showResult(result);\n            }.bind(this),5.5);\n        }\n\n        if (hall.sxAdManager) {\n            hall.sxAdManager.hide();\n        }\n    },\n\n    /**\n     * 获取底分\n     * @returns {number}\n     */\n    getBaseScore:function () {\n\n        var base = ddz.SINGLE_SCORE_BASE;\n        var sceneType = this.tableInfo().getSceneType();\n        var table_config = this._tableInfo.config;\n\n        if (sceneType == ddz.Enums.SceneType.ARENA) {\n            base = table_config.m_base || 0;\n        } else if (sceneType == ddz.Enums.SceneType.MATCH) { //联网根据table_info获取，match和闯关待定\n            base = table_config.m_base || 0;\n        }else {\n            base = table_config.m_roommulti * table_config.m_basemulti * table_config.m_base;\n        }\n\n        return base;\n    },\n\n    //游戏结束后显示剩下的牌\n    _showCardsWhenGameOver: function(result , leftindex, rightindex) {\n        //明牌标示图片\n        if (this._mySeatinfo) {\n            this._mySeatinfo.setNotShowCards();\n        }\n\n        // if (this._friendPanel){\n            //好友场,最后亮牌的时候,要从协议里取出真实的牌,因为之前的牌,都是-1\n            this._leftSeatinfo.model.m_card = result['cards'][leftindex - 1];\n            this._rightSeatinfo.model.m_card = result['cards'][rightindex - 1];\n        // }\n\n        //显示上家和下家的牌\n\n        var left_cards = this._leftSeatinfo.model.m_card;\n        var isDiZhu = this._isDizhu(leftindex);\n        this._leftPlayerController.showCards(left_cards, isDiZhu);\n\n\n        var right_cards = this._rightSeatinfo.model.m_card;\n        isDiZhu = this._isDizhu(rightindex);\n        this._rightPlayerController.showCards(right_cards, isDiZhu);\n\n        if (this._cards.length > 0) {\n            //展示自己手牌\n            this._clearPlayedCards();\n        }\n    },\n\n    /************************************** 自己相关操作开始 ******************************************/\n\n    _getIndexFromPos: function(pos) {\n        var firstLineIndex = -1;\n        var secondLineIndex = -1;\n\n        if (this._checkInFirstLineCards(pos)){\n            firstLineIndex = Math.floor((pos.x - this.firstLineOriginX) / this._cardsIntervalX);\n            if (firstLineIndex > this.firstLineCardCount - 1){\n                firstLineIndex = this.firstLineCardCount - 1\n            }\n        }\n\n        if (this._checkInSecondLineCards(pos)){\n            secondLineIndex = Math.floor((pos.x - this.secondLineOriginX) / this._cardsIntervalX);\n            if (secondLineIndex > this.secondLineCardCount - 1){\n                secondLineIndex = this.secondLineCardCount - 1\n            }\n        }\n\n        if (secondLineIndex != -1){\n            return this.firstLineCardCount + secondLineIndex;\n        }\n        else if (firstLineIndex != -1){\n            return firstLineIndex;\n        }\n\n        return -1;\n    },\n    _onTouchBegan: function(pos) {\n        var index = this._getIndexFromPos(pos);\n        this._touchCardIndexBegin = index;\n        this._touchCardIndexEnd = index;\n\n        var tc = this._cards[this._touchCardIndexBegin];\n        tc.showMask(true);\n        this._touchedCards.push(tc);\n        return true;\n    },\n\n    _clearTouchedCards: function() {\n        var cards = this._touchedCards;\n        var len = cards.length;\n        for (var tmpi = 0; tmpi < len; tmpi++) {\n            var tc = cards.pop();\n            tc.showMask(false);\n        }\n    },\n\n    touchCardsMoved: function(pos) {\n        var index = this._getIndexFromPos(pos);\n        var begin = this._touchCardIndexBegin;\n        var end = this._touchCardIndexEnd;\n\n        var startpos;\n        var endpos;\n        var i;\n        var tc;\n\n        if (index < end) {\n            if (index >= begin) {\n                for (i = end; i > index; i--) {\n                    tc = this._touchedCards.pop();\n                    if (tc){\n                        tc.showMask(false);\n                    }\n\n                }\n            } else {\n                if (end <= begin) {\n                    startpos = index;\n                    endpos = end - 1;\n                } else {\n                    this._clearTouchedCards();\n                    startpos = index;\n                    endpos = begin;\n                }\n                for (i = endpos; i >= startpos; i--) {\n                    tc = this._cards[i];\n                    tc.showMask(true);\n                    this._touchedCards.push(tc);\n                }\n            }\n        } else if (index > end) {\n            if (index <= begin) {\n                for (i = end; i < index; i++) {\n                    tc = this._touchedCards.pop();\n                    if (tc){\n                        tc.showMask(false);\n                    }\n                }\n            } else {\n                if (end >= begin) {\n                    startpos = end;\n                    endpos = index;\n                } else {\n                    this._clearTouchedCards();\n                    startpos = begin - 1;\n                    endpos = index;\n                }\n                for (i = startpos + 1; i <= index; i++) {\n                    tc = this._cards[i];\n                    tc.showMask(true);\n                    this._touchedCards.push(tc);\n                }\n            }\n        }\n        this._touchCardIndexEnd = index;\n    },\n\n    //触摸是否在手牌区域，如果在的话，一定会吞掉触摸事件，修复隔牌点击头像的bug(因为虽然点着牌，但是不处理，导致没吞掉)\n    isTouchOnCards: function(pos) {\n        var len = this._cards.length;\n        if (len <= 0) {\n            return false;\n        }\n\n        var hitArea = this._checkInFirstLineCards(pos);\n\n        if (this.secondLineCardCount != 0){\n            //有第二行\n            var hitSecond = this._checkInSecondLineCards(pos);\n            hitArea = hitArea || hitSecond;\n        }\n        return hitArea;\n    },\n\n    /* 初次选牌，挑最长的一组牌出牌，第一步只挑顺子和顺对\n     * 顺子和顺对，没有副牌，优化的效果最好\n     * 三顺有副牌，而副牌是不确定的，暂时先放放\n     */\n    _selectLegalTouchCards: function() {\n        var len = this._touchedCards.length;\n        if (len <= 0) {\n            return;\n        }\n        //得到count值数组\n        var touchCardsCount = [];\n        for (var nIndex = 0; nIndex < len; nIndex++) {\n            touchCardsCount[nIndex] = this._touchedCards[nIndex]._info._number;\n        }\n        ddz.LOGD(this._TAG, \"选中的牌的count值数组是：\");\n\n        var oneLongest = ddz.AI._findLongestFromSelectedCards(touchCardsCount);\n        if (oneLongest.length <= 0) {\n            ddz.LOGD(this._TAG, \"出错了，没有找出最长的牌\");\n            return;\n        }\n        //处理癞子\n        //\n        var searchOneLongest = oneLongest.slice(0);\n\n        for (var i = 0; i < len; i++) {\n            var card = this._touchedCards[i];\n            var index = hall.GlobalFuncs.FindInArray(searchOneLongest, card._info._number);\n            if (index >= 0) {\n                searchOneLongest[index] = -1;\n                ddz.LOGD(this._TAG, \"拖动选择出最长牌，弹起来\");\n                this._selectedCards.push(card);\n                card.up();\n            }\n        }\n    },\n\n    touchCardsEnd: function() {\n        // 处理拖动的牌\n\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.click_cards, false);\n        //是否已经选择了牌\n        var hasSelect = false;\n        if (this._selectedCards.length > 0) {\n            hasSelect = true;\n        }\n        //是否是主动出牌\n        var active = false;\n        if (this._topCardType == null) {\n            active = true;\n        } else {\n            ddz.LOGD(this._TAG, 'top Card Type is : ' + this._topCardType._type);\n        }\n        ddz.LOGD(this._TAG, \"touch cards num is : \" + this._touchedCards.length+\"===\"+this._selectedCards.length);\n\n        var cardOne, i, index, h;\n        /*\n         * 点选牌优化之双王致胜\n         * 点选了一张牌（大王或者小王），而且是双王致胜的情况下，自动选中双王\n         */\n        if (!hasSelect && 1 == this._touchedCards.length && ddz.RobotGlobal.rocketWin(this._mySeatinfo.model.m_card)) {\n            cardOne = this._touchedCards[0];\n            if (cardOne._info._number == 52 || cardOne._info._number == 53) {\n                // 选中了一张大王或者小王，将另外一张王也提起\n                for (i = this._cards.length - 1; i >= 0; i--) {\n                    if ((this._cards[i]._info._number == 52 || this._cards[i]._info._number == 53) && (this._cards[i]._info._number != cardOne._info._number)) {\n                        this._touchedCards.push(this._cards[i]);\n                        break; // 跳出循环\n                    }\n                }\n            }\n        }\n\n        /*\n         * 没有选中的牌，点起了一张牌，\n         * 如果topType是没有或者对子，\n         * 选中的牌刚好是一个对子尝试做选中的优化\n         */\n        if (!hasSelect && 1 == this._touchedCards.length && (active || this._topCardType._type == ddz.Enums.PaixingType.DOUBLE_CARD)) {\n            // 如果手牌中该牌是一个对子，则同时把另一张弹起\n            var pc = ddz.RobotGlobal.getPCArrayByPoint(this._mySeatinfo.model.m_card); // 计算PC\n            cardOne = this._touchedCards[0];\n            var nPoint = cardOne._info._point;\n            var nCount = cardOne._info._number;\n            var pos = ddz.GlobalFuncs.numberToValue(cardOne._info._number);\n            // 取选中的牌在PC中的POS\n            for (var m = pc.length - 1; m >= 0; m--) {\n                if (pc[m].point == pos) {\n                    // ddz.LOGD(this._TAG, 'Pos : ' + m);\n                    if (2 == pc[m].count) {\n                        // 是个对子，把另外一张牌也弹起\n                        for (i = this._cards.length - 1; i >= 0; i--) {\n                            if (this._cards[i]._info._point == nPoint && this._cards[i]._info._number != nCount) {\n                                if (active && this._isInShunzi(i)) {\n\n                                } else {\n                                    this._touchedCards.push(this._cards[i]);\n                                }\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n\n        //\n        //如果当前没有任何一张选中的牌，那么要在滑中的牌中弹出能出的最长牌\n        // if (hasSelect == false && active == true)\n        //按照策划需求在拖动选择牌时总时提起最长得牌\n        if (hasSelect == false) {\n            this._selectLegalTouchCards();\n            for (index = 0; index < this._touchedCards.length; index++) {\n                this._touchedCards[index].showMask(false);\n            }\n            this._touchedCards = [];\n        } else {\n            var card;\n            while (this._touchedCards.length){\n                card = this._touchedCards.pop();\n                if(!card){\n                    continue;\n                }\n                card.showMask(false);\n                index = hall.GlobalFuncs.FindInArray(this._selectedCards, card);\n                //放回去\n                if (index >= 0) {\n                    this._selectedCards.splice(index, 1);\n                    card.down();\n                }\n                //弹起来\n                else {\n                    this._selectedCards.push(card);\n                    card.up();\n                }\n            }\n            // var len = this._touchedCards.length;\n            // var card;\n            // for (i = 0; i < len; i++) {\n            //     card = this._touchedCards.pop();\n            //     card.showMask(false);\n            //     index = hall.GlobalFuncs.FindInArray(this._selectedCards, card);\n            //     //放回去\n            //     if (index >= 0) {\n            //         this._selectedCards.splice(index, 1);\n            //         card.down();\n            //     }\n            //     //弹起来\n            //     else {\n            //         this._selectedCards.push(card);\n            //         card.up();\n            //     }\n            // }\n        }\n\n        this._operateController.btnPlay.interactable = this._selectedCards.length > 0;\n        this._operateController.btnPlay.node.getChildByName(\"bright\").active = this._selectedCards.length > 0;\n        this._operateController.btnPlay.node.getChildByName(\"hui\").active = !(this._selectedCards.length > 0);\n        return true;\n    },\n\n    //判断一张牌是否在顺子里\n    _isInShunzi: function(mypos) {\n        var card = this._cards[mypos];\n        var myVal = card._info._value;\n        if (myVal > 11) {\n            //11的权重为A\n            return false;\n        }\n\n        //小于我的牌数的连续个数\n        var minCnt = 0;\n        var index;\n        var judgeCardVal;\n\n        for (index = mypos + 1; index < this._cards.length; ++index) {\n            judgeCardVal = this._cards[index]._info._value;\n            if (judgeCardVal == myVal || myVal - judgeCardVal == minCnt) {\n                continue;\n            }\n            if (myVal - judgeCardVal != minCnt + 1) {\n                break;\n            }\n            ++minCnt;\n        }\n\n        //大于我的牌数的连续个数\n        var largerCnt = 0;\n        for (index = mypos - 1; index >= 0; --index) {\n            judgeCardVal = this._cards[index]._info._value;\n            if (judgeCardVal > 11) {\n                break;\n            }\n            if (judgeCardVal == myVal || myVal - judgeCardVal == -largerCnt) {\n                continue;\n            }\n            if (myVal - judgeCardVal != -largerCnt - 1) {\n                break;\n            }\n            ++largerCnt;\n        }\n\n        ddz.LOGD(this._TAG, \"is in shunzi : = \" + (minCnt + largerCnt));\n        ddz.LOGD(this._TAG, \"is in shunzi minCnt = \" + minCnt);\n        ddz.LOGD(this._TAG, \"is in shunzi largerCnt = \" + largerCnt);\n        return (minCnt + largerCnt) >= 4;\n    },\n\n    _clearPlayedCards: function() {\n        this.playedCardArea.scale = this._cardBaseScale;\n        while (this._playedCards.length > 0){\n            var card = this._playedCards.pop();\n            this.returnCard(card.node);\n        }\n    },\n\n    toFriend:function () {\n        ddz.LOGD(\"\",\"file = [DdzTableScene] fun = [toFriend] this.tableInfo().getSceneType() = \" + this.tableInfo().getSceneType())\n        if (!this._friendPanel && this.tableInfo().getSceneType() == ddz.Enums.SceneType.FRIEND){\n            this.shutMatchResult();\n\n            if (this._arenaPanelNode){\n                this._arenaPanelNode.destroy();\n                this._arenaPanelNode = null;\n                this._arenaPanel = null;\n            }\n\n            if (this._goldPanelNode){\n                this._goldPanelNode.destroy();\n                this._goldPanelNode = null;\n                this._goldPanel = null;\n            }\n\n            this.stageTag.active = false;\n            //好友桌\n            var _friendPanelNode = cc.instantiate(this.friendPrefab);\n            this._friendPanel = _friendPanelNode.getComponent(\"FriendModule\");\n            this._friendPanel.setTableScene(this);\n            //是否显示邀请按钮\n            this._friendPanel.setBtnInviteState(!Boolean(this._leftSeatinfo.hasData && this._rightSeatinfo.hasData));\n            _friendPanelNode.parent = this.playModeNode;\n\n            if(this.tableInfo().disbind){\n                this._friendPanel.refreshDisbindState(this.tableInfo().disbind);\n            }else {\n                this._friendPanel.deleteDisbindState();\n            }\n\n            var that = this;\n            var nextCallBack = function () {\n                that._leftPlayerController.refreshAvatarForeFriendOrigin();\n                that._rightPlayerController.refreshAvatarForeFriendOrigin();\n                // that.myAvatar.active = true;\n                that.myHead.active = true;\n                var isDiZhu = that._mySeatIndex == that._tableState.normalInfo.m_dizhu;\n                if(isDiZhu){\n                    var to_pos = that.getEmoPos(that._mySeatIndex);\n                    that.showDizhuHatOrigin(to_pos);\n                }\n            };\n            requestAnimationFrame(nextCallBack);\n\n            var seatList = this.tableInfo().seats;\n            var nextId = ddz.GlobalFuncs.GetNextIndex(this._mySeatIndex);\n            var seatInfo = seatList[nextId-1];\n            var ruid = seatInfo[\"uid\"];\n            if(ruid != 0){\n                ty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'right', type:'sit'});\n            }else {\n                ty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'right', type:'leave'});\n            }\n\n            var preIndex = ddz.GlobalFuncs.getPreIndex(this._mySeatIndex);\n            seatInfo = seatList[preIndex-1];\n            ruid = seatInfo[\"uid\"];\n            if(ruid != 0){\n                ty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'left', type:'sit'});\n            }else {\n                ty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'left', type:'leave'});\n            }\n        }\n    },\n\n    toGold:function () {\n        if (!this._goldPanel && this.tableInfo().getSceneType() == ddz.Enums.SceneType.NORMAL){\n\n            this.shutMatchResult();\n            this.stageTag.active = false;\n            this._goldPanelNode = cc.instantiate(this.goldPrefab);\n            this._goldPanel = this._goldPanelNode.getComponent(\"GoldModule\");\n            this._goldPanel.setTableScene(this);\n            this._goldPanelNode.parent = this.playModeNode;\n            this.upDateGoldInfo();\n        }\n    },\n    //\n    upDateGoldInfo:function () {\n        var tableinfo = this.tableInfo();\n        // 金币场\n        var _goldInfo = '';\n        if (tableinfo.hasOwnProperty('roomName')){\n            _goldInfo = tableinfo.roomName;\n        }\n        if (tableinfo.config && tableinfo.config.m_couponrule) {\n            _goldInfo = _goldInfo + \"\\n\" + tableinfo.config.m_couponrule;\n        }\n\n        this.setGoldInfo(_goldInfo);\n    },\n\n    toThrough:function () {\n        this.shutMatchResult();\n        if (!this._throughPanel && this.tableInfo().getSceneType() == ddz.Enums.SceneType.MATCH){\n            this.stageTag.active = false;\n            this._throughPanelNode = cc.instantiate(this.throughPrefab);\n            this._throughPanel = this._throughPanelNode.getComponent(\"ThroughModule\");\n            this._throughPanel.setTableScene(this);\n            this._throughPanelNode.parent = this.playModeNode;\n        }\n    },\n\n    toArenaMatch:function() {\n\n        this.shutMatchResult();\n\n        if(!this._arenaPanel && this.tableInfo().getSceneType() == ddz.Enums.SceneType.ARENA) {\n            this.stageTag.active = false;\n            this._arenaPanelNode = cc.instantiate(this.arenaMatchPrefab);\n            this._arenaPanel = this._arenaPanelNode.getComponent(\"ArenaMatchModule\");\n            this._arenaPanel.setTableScene(this);\n            this._arenaPanelNode.parent = this.playModeNode;\n        }\n    },\n    shutMatchResult:function () {\n        if (ddz.matchResultPanel){\n            ddz.matchResultPanel.shut();\n        }\n\n        if (ddz.arenaResultPanel){\n            ddz.arenaResultPanel.shut()\n        }\n    },\n    update:function (dt) {\n        ddz.msgCache.triggerFristMsg();\n    }\n\n\n});"]}
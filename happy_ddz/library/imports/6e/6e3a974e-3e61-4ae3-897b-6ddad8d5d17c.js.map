{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/window/assets/Script/ComponentScript/window/ddz_diamond_windows.js"],"names":["cc","Class","extends","Component","properties","banner","Node","betRich","RichText","shareRedPacket","Prefab","panel","btnText","btnSpriteFrame","SpriteFrame","shareBtn","Button","onLoad","that","hall","GlobalFuncs","btnScaleEffect","node","active","ty","NotificationCenter","listen","ddz","EventType","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","REMOVE_WINDOW_ANI","onClose","_shareType","Share","onShareType","clickStatShareTypeGetDiamondHall","string","getButtonTitle","canPlayVideo","type","reultType","resultType","gameModel","isBringVersion","MsgBoxManager","showToast","title","updateWindowInfo","state","AdManagerTYWX","getAdNodeByTag","hideAdNode","onShareBtn","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeButtonClick","shareWithType","onClcikSeeVideoBtn","TCP","connectStatus","CONNECT_STATUS_OK","LOGD","adManager","showRewardedVideo","adId","mail","onClickDiamondBtn","onClickVideoBtn","updateShareInfo","data","newUserMulti","setBtnRichText","trigger","UPDATE_REWARD_COUNT","inviteeList","length","_index","_inviteeList","runOneFun","_playerData","shift","com","getComponent","setSharePeopleInfo","instantiate","addChild","bigReward","bigWindow","setBigReward","requestAnimationFrame","_bet","removeLoopAni","ani","Animation","stop","stopAllActions","shut","destroy","onDestroy","ignoreScope","showAdNode","ddz_dayWelfare"],"mappings":"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","file":"ddz_diamond_windows.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        banner:cc.Node,\n        betRich:cc.RichText,\n        shareRedPacket:cc.Prefab,\n        panel:cc.Node,\n        btnText:cc.RichText,\n\n        btnSpriteFrame:[cc.SpriteFrame],\n        shareBtn:cc.Button,\n\n    },\n\n    onLoad:function(){\n        var that = this;\n        // this.scheduleOnce(function () {\n        //     var ani = that.banner.getComponent(cc.Animation);\n        //     ani.play('btnTick');\n        // }, 1);\n\n        hall.GlobalFuncs.btnScaleEffect(this.shareBtn.node,1.13);\n        this.betRich.node.active = false;\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n        ty.NotificationCenter.listen(ddz.EventType.REMOVE_WINDOW_ANI, this.onClose, this);\n\n        var _shareType = ddz.Share.onShareType.clickStatShareTypeGetDiamondHall;\n        this.btnText.string = \"<color=#E54D42>\"+ hall.GlobalFuncs.getButtonTitle(_shareType) +\"</c>\";\n        // ddz.gameModel.queryWatchVideoReward();\n        this.canPlayVideo = true;\n    },\n\n    playAnimationAfterShareWithType : function (type) {\n        if (type && type != ddz.Share.onShareType.clickStatShareTypeGetDiamondHall) {\n            return;\n        }\n        var reultType = ddz.Share.resultType;\n        switch (reultType) {\n            case 1:\n                if (!ddz.gameModel.isBringVersion) {\n                    hall.MsgBoxManager.showToast({title : '请分享到微信群哦~'});\n                }\n                break;\n            case 2:\n                if (!ddz.gameModel.isBringVersion) {\n                    hall.MsgBoxManager.showToast({title : '请不要频繁分享到一个群~'});\n                }\n                break;\n            case 3:\n\n                break;\n            default:\n                break;\n        }\n\n        ddz.Share.resultType = 0;\n    },\n\n    updateWindowInfo:function(state){\n        if (hall.AdManagerTYWX && hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\")) {\n            hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\").hideAdNode();\n        }\n    },\n\n    onShareBtn:function(){\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"diamondShare\"]);\n        ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeGetDiamondHall);\n    },\n\n    onClcikSeeVideoBtn:function(){\n        if (ty.TCP.connectStatus != ty.TCP.CONNECT_STATUS_OK){\n            hall.MsgBoxManager.showToast({title : \"正在登录，请稍候\"});\n            ddz.LOGD(null, \"TCP is not ok! Please wait!\");\n            return;\n        }\n\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"watchVideo\",\"diamond\"]);\n\n        if (this.canPlayVideo) {\n            hall.adManager.showRewardedVideo(this.adId,\"diamond\");\n        }else {\n            if (this.mail){\n                hall.MsgBoxManager.showToast({title : this.mail});\n            }\n        }\n    },\n\n    onClickDiamondBtn:function(){\n        this.updateWindowInfo(1);\n    },\n\n    onClickVideoBtn:function(){\n        this.updateWindowInfo(2);\n    },\n\n    updateShareInfo:function(data){\n        if (data.newUserMulti){\n            this.setBtnRichText(data.newUserMulti);\n        }\n        ty.NotificationCenter.trigger(ddz.EventType.UPDATE_REWARD_COUNT,data);\n        if (data.inviteeList && data.inviteeList.length > 0) {\n            var that = this;\n            var _index = 0;\n            var _inviteeList = data.inviteeList;\n            var runOneFun = function () {\n\n                if (_index < 5) {\n                    if (_inviteeList.length > 0){\n                        var _playerData = _inviteeList.shift();\n                        if (that[\"shareRedPacket_\"+_index]) {\n                            var com = that[\"shareRedPacket_\"+_index].getComponent('shareRedPacket');\n                            com.setSharePeopleInfo(_playerData);\n                        }else {\n                            that[\"shareRedPacket_\"+_index] = cc.instantiate(that.shareRedPacket);\n\n                            that.panel.addChild(that[\"shareRedPacket_\"+_index]);\n                            var com = that[\"shareRedPacket_\"+_index].getComponent('shareRedPacket');\n                            com.setSharePeopleInfo(_playerData);\n                        }\n                    }\n\n                }else if (_index == 5){\n                    if (data.bigReward) {\n                        if (that.bigWindow) {\n                            var com = that.bigWindow.getComponent('shareRedPacket');\n                            if (com) {\n                                com.setBigReward(data.bigReward);\n                            }\n                        }else {\n                            that.bigWindow = cc.instantiate(that.shareRedPacket);\n                            that.panel.addChild(that.bigWindow);\n                            var com = that.bigWindow.getComponent('shareRedPacket');\n                            com.setBigReward(data.bigReward);\n                        }\n\n                    }\n                }\n                _index++;\n                requestAnimationFrame(runOneFun);\n            };\n            runOneFun();\n        }\n    },\n\n    setBtnRichText:function(_bet) {\n        if (_bet > 0) {\n            this.betRich.node.active = true;\n            this.betRich.string = \"<color=#9C7343>新玩家点击，可获得</c><color=#ED4824><size=30>\" + _bet + \"倍奖励</color>\";\n        }\n    },\n\n    removeLoopAni:function () {\n        var ani = this.banner.getComponent(cc.Animation);\n        ani.stop();\n        this.shareBtn.node.stopAllActions();\n    },\n\n    shut:function () {\n        this.removeLoopAni();\n        this.node.destroy();\n    },\n\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n        if (hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\")) {\n            hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\").showAdNode();\n        }\n    },\n\n    onClose:function(){\n        this.shut();\n        ddz.ddz_dayWelfare = null;\n    },\n});\n"]}
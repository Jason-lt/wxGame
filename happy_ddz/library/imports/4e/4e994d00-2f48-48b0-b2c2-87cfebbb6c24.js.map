{"version":3,"sources":["../../../../../../assets/Script/hall/utils/assets/Script/hall/utils/sxAdManager.js"],"names":["hall","sxAdManager","sxAdInfo","opDataWeight","iconWeight","iconIndex","preIconIndex","isSwitchIcon","callback","isLoadConfig","show","dx","dy","scale","adIcon","console","log","setPositionByScene","active","cc","director","getScheduler","schedule","framesInterval","Node","position","v2","winSize","width","wx","initWeight","switchIcon","addComponent","Button","on","onClickAdIconBtn","game","addPersistRootNode","ty","NotificationCenter","trigger","EventType","UPDATE_SXADICON_POS","loadConfigFile","error","hide","unschedule","setPosition","setScale","index","x","y","ddz","gameModel","getDiversionConfig","self","loadConfig","getDiversionConfigJson","setTimeout","retryConfigFile","that","num","Math","floor","random","selectItemByWeight","icons","type","getComponent","Animation","removeComponent","Sprite","loadStaticImg","spriteFrame","loadDynamicImg","err","i","length","weight","openData","j","arr","link","imgLink","loader","load","tex","SpriteFrame","split","adIconFrames","playFrames","animation","clip","AnimationClip","createWithSpriteFrames","name","wrapMode","WrapMode","Loop","addClip","play","results","getError","splice","getContent","push","openType","previewImage","urls","imgurl","success","res","fail","bi_paramlist","biparam","topath","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeClickAdBtn","navigateToMiniProgram","appId","path","envVersion","extraData","clickStatEventTypeClickDirectToMiniGameSuccess","clickStatEventTypeClickDirectToMiniGameFail","complete","limit"],"mappings":"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","file":"sxAdManager.js","sourceRoot":"../../../../../../assets/Script/hall/utils","sourcesContent":["//三消交叉导流\nhall.sxAdManager = {\n    // sxAdInfo: {\n    //     \"icons\": [\n    //         // {\n    //         //     \"weight\": 10,\n    //         //     \"type\": 0,//0为静图，1为动图\n    //         //     \"imgLink\": \"https://sanxqn.nalrer.cn/tysanxiao/common/Sbt_melon_1.png\",\n    //         //     \"openType\": 0,//0为静图，1为小程序\n    //         //     \"openData\":\n    //         //         [\n    //         //             { \"imgurl\": \"https://sanxqn.nalrer.cn/tysanxiao/box-worldCup/linkImages/WorldCup_Img_1.jpg\", \"weight\": 50 },\n    //         //             { \"imgurl\": \"https://sanxqn.nalrer.cn/tysanxiao/trialine/linkimage/link002.png\", \"weight\": 100 },\n    //         //             { \"imgurl\": \"https://sanxqn.nalrer.cn/tysanxiao/1010/linkImages/1010_link_image.png\", \"weight\": 37 },\n    //         //         ]\n    //         // },\n    //         {\n    //             \"weight\": 10,\n    //             \"type\": 1,\n    //             \"imgLink\": \"https://sanxqn.nalrer.cn/tysanxiao/box/Ad/1.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/2.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/3.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/4.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/5.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/6.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/7.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/8.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/9.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/10.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/11.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/12.png,https://sanxqn.nalrer.cn/tysanxiao/box/Ad/13.png\",\n    //             \"openType\": 0,\n    //             \"openData\":\n    //                 [\n    //                     { \"imgurl\": \"https://sanxqn.nalrer.cn/tysanxiao/box-worldCup/linkImages/WorldCup_Img_1.jpg\", \"weight\": 80 },\n    //                     { \"imgurl\": \"https://sanxqn.nalrer.cn/tysanxiao/1010/linkImages/1010_link_image.png\", \"weight\": 11 },\n    //                 ]\n    //         }\n    //     ],\n    //     \"framesInterval\": 3,\n    //     \"position\": [{ \"x\": 600, \"y\": 450 }, { \"x\": 50, \"y\": 760 }, { \"x\": 550, \"y\": 820 }]\n    // },\n    sxAdInfo: null,\n    opDataWeight: [],\n    iconWeight: null,\n    iconIndex: null,\n    preIconIndex: null,\n    isSwitchIcon: false,//true为换icon，false为不换icon\n    callback: null,\n    isLoadConfig: false,\n\n\n    show: function (dx, dy, scale) {\n        try {\n            if (this.adIcon) {\n                console.log(\"sxAdManager: \" + \"restart adIcon\");\n                if (dx == 0 && dy == 0) {\n                    this.setPositionByScene(0);\n                }\n                this.adIcon.active = true;\n                cc.director.getScheduler().schedule(\n                    this.callback, this.adIcon, this.sxAdInfo.framesInterval, !this.isSwitchIcon);\n            } else {\n\n                var callback = () => {\n                    console.log(\"sxAdManager: \" + \"first adIcon\");\n                    this.adIcon = new cc.Node();\n\n                    this.adIcon.position = cc.v2(cc.winSize.width - dx, dy);\n\n                    if (dx == 0 && dy == 0)\n                        this.setPositionByScene(0);\n                    if (scale)\n                        this.adIcon.scale = scale;\n\n                    if (typeof wx !== 'undefined') {\n                        this.initWeight();\n                        this.iconIndex = 0;\n                        this.isSwitchIcon = true;\n                        this.callback = () => {\n                            this.switchIcon();\n                        }\n                        this.callback();\n                        cc.director.getScheduler().schedule(\n                            this.callback, this.adIcon, this.sxAdInfo.framesInterval, !this.isSwitchIcon);\n                        this.adIcon.addComponent(cc.Button);\n                        this.adIcon.on('click', this.onClickAdIconBtn, this);\n\n                        cc.game.addPersistRootNode(this.adIcon);\n                    }\n\n                    ty.NotificationCenter.trigger(ty.EventType.UPDATE_SXADICON_POS);\n                };\n                this.loadConfigFile(callback);\n            }\n        } catch (error) {\n            console.log(\"sxAdManager: \", error);\n\n        }\n    },\n\n    hide: function () {\n        if (this.adIcon) {\n            cc.director.getScheduler().unschedule(this.callback, this.adIcon);\n            this.adIcon.active = false;\n            console.log(\"sxAdManager: \" + \"Ad hide success\");\n        }\n\n    },\n\n    setPosition: function (dx, dy) {\n        if (this.adIcon) {\n            // this.adIcon.position = cc.v2(cc.winSize.width - dx, dy);\n            this.adIcon.position = cc.v2(dx, dy);\n        }\n\n    },\n\n    setScale: function (scale) {\n        if (this.adIcon) {\n            this.adIcon.scale = scale;\n        }\n    },\n\n    setPositionByScene: function (index) {\n        if (this.adIcon) {\n            let dx = this.sxAdInfo.position[index].x;\n            let dy = this.sxAdInfo.position[index].y;\n\n            console.log(index, \"x: \", dx, \"y: \", dy);\n            this.adIcon.position = cc.v2(dx, dy);\n        }\n    },\n\n    loadConfigFile: function (callback) {\n        ddz.gameModel.getDiversionConfig();\n        var self = this;\n\n        var loadConfig = function(){\n            try {\n                if (ddz.gameModel.getDiversionConfigJson()) {\n                    self.isLoadConfig = true;\n                    self.sxAdInfo = ddz.gameModel.getDiversionConfigJson();\n                    callback();\n                }else {\n                    // ddz.gameModel.getDiversionConfig();\n                    // if (ddz.gameModel.getDiversionConfigJson()) {\n                    //     self.sxAdInfo = ddz.gameModel.getDiversionConfigJson();\n                    //     callback();\n                    // }\n\n                    if (!self.isLoadConfig) {\n                        setTimeout(function() {\n                            loadConfig();\n                        }, 2000);\n                        // this.scheduleOnce(function () {\n                        //\n                        // }, 1);\n                    }\n                }\n\n            } catch (error) {\n                ddz.gameModel.getDiversionConfig();\n            }\n        };\n\n        loadConfig();\n\n\n\n    },\n    retryConfigFile: function () {\n        if (!this.isLoadConfig) {\n            var that = this;\n            setTimeout(function() {\n                that.loadConfigFile();\n            }, 2000);\n            // this.scheduleOnce(function () {\n            //\n            // }, 1);\n        }\n    },\n    switchIcon: function () {//刷新Icon\n        try {\n            let num = Math.floor(Math.random() * this.iconWeight);\n            this.iconIndex = this.selectItemByWeight(num, this.sxAdInfo.icons);\n\n            if (this.iconIndex != -1) {\n                if (this.iconIndex != this.preIconIndex) {\n                    if (this.sxAdInfo.icons[this.iconIndex].type == 0) {\n                        console.log(\"sxAdManager: \" + \"load static Ad\");\n                        if (this.adIcon.getComponent(cc.Animation)) {//除去动态icon的组件\n                            this.adIcon.removeComponent(cc.Animation);\n                            this.adIcon.removeComponent(cc.Sprite);\n                        }\n                        this.loadStaticImg(this.sxAdInfo.icons[this.iconIndex]);\n                    } else if (this.sxAdInfo.icons[this.iconIndex].type == 1) {\n                        console.log(\"sxAdManager: \" + \"load dynamic Ad\");\n                        if (this.adIcon.getComponent(cc.Sprite)) {//除去静态icon的组件\n                            this.adIcon.getComponent(cc.Sprite).spriteFrame = null;\n                        }\n                        this.loadDynamicImg(this.sxAdInfo.icons[this.iconIndex]);\n                    }\n                    this.preIconIndex = this.iconIndex;\n                }\n\n            }\n        } catch (err) {\n            console.log(\"sxAdManager: \", err);\n            cc.director.getScheduler().unschedule(this.callback, this.adIcon);\n        }\n    },\n\n    initWeight: function () {\n        this.iconWeight = 0;\n        for (let i = 0; i < this.sxAdInfo.icons.length; i++) {\n            this.iconWeight += this.sxAdInfo.icons[i].weight;\n            this.opDataWeight[i] = 0;\n            var openData = this.sxAdInfo.icons[i].openData;\n            for (let j = 0; j < openData.length; j++) {\n                this.opDataWeight[i] += openData[j].weight;\n            }\n        }\n    },\n\n    //添加导流入口Icon静态图片\n    loadStaticImg: function (arr) {\n        let link = arr.imgLink;\n        let self = this;\n        cc.loader.load(link, function (err, tex) {\n            if (self.adIcon.getComponent(cc.Sprite)) {//重新调用时可能是同一个静态icon也可能适另一个静态icon\n                self.adIcon.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(tex);\n            }\n            else {\n                self.adIcon.addComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(tex);\n            }\n        });\n    },\n\n    //添加导流入口Icon动画\n    loadDynamicImg: function (arr) {\n        let link = arr.imgLink.split(',');\n        let self = this;\n        var adIconFrames = [];\n        var playFrames = () => {\n\n\n            if (self.adIcon.getComponent(cc.Animation)) {//重新调用时可能是同一个动态icon也可能适另一个动态icon\n\n                var animation = self.adIcon.getComponent(cc.Animation);\n\n                var clip = cc.AnimationClip.createWithSpriteFrames(adIconFrames, 10);\n                clip.name = 'anim_frame';\n                clip.wrapMode = cc.WrapMode.Loop;\n                animation.addClip(clip);\n                animation.play('anim_frame');\n            }\n            else {\n                var animation = self.adIcon.addComponent(cc.Animation);\n                if (!self.adIcon.getComponent(cc.Sprite))\n                    self.adIcon.addComponent(cc.Sprite);\n\n                var clip = cc.AnimationClip.createWithSpriteFrames(adIconFrames, 10);\n                clip.name = 'anim_frame';\n                clip.wrapMode = cc.WrapMode.Loop;\n                animation.addClip(clip);\n                animation.play('anim_frame');\n            }\n        };\n        cc.loader.load(link, function (err, results) {\n            if (err) {\n                for (var i = 0; i < err.length; i++) {\n                    console.log(\"sxAdManager: \", 'load Dynamic img failed' + err[i] + ']: ' + results.getError(err[i]));\n                }\n            }\n            else {\n                adIconFrames.splice(0, adIconFrames.length);\n\n                for (let i = 0; i < link.length; i++) {\n                    var tex = results.getContent(link[i]);\n                    adIconFrames.push(new cc.SpriteFrame(tex));\n                }\n                playFrames();\n            }\n        });\n    },\n\n    onClickAdIconBtn: function () {\n        if (typeof wx !== 'undefined') {\n            try {\n                let iconIndex = this.iconIndex;\n                let num = Math.floor(Math.random() * this.opDataWeight[iconIndex]);\n                let index = this.selectItemByWeight(num, this.sxAdInfo.icons[iconIndex].openData);\n\n                if (index != -1) {\n                    if (this.sxAdInfo.icons[iconIndex].openType == 0) {\n                        wx.previewImage({\n                                // current: ''; // 当前要显示的图片url\n                                urls: [this.sxAdInfo.icons[iconIndex].openData[index].imgurl], // 需要预览的图片url列表\n                                success: (res) => {\n                                console.log(\"sxAdManager: \" + 'preview success', res);\n                    },\n                        fail: (res) => {\n                            console.log(\"sxAdManager: \" + 'preview fail', res);\n                        },\n                        // complete: () => {\n\n                        // }\n                    });\n                    }\n                    else if (this.sxAdInfo.icons[iconIndex].openType == 1) {\n                        var bi_paramlist = this.sxAdInfo.icons[iconIndex].biparam;\n                        console.log(bi_paramlist);\n                        console.log(this.sxAdInfo.icons[iconIndex].topath);\n                        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickAdBtn, bi_paramlist);\n                        wx.navigateToMiniProgram({\n                            appId: this.sxAdInfo.icons[iconIndex].openData[index].imgurl,\n                            path: this.sxAdInfo.icons[iconIndex].topath,\n                            envVersion: 'release',\n                            extraData: null,\n                            success: function (res) {\n                                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameSuccess, bi_paramlist);\n                                console.log('wx.navigateToMiniProgram success');\n                                console.log(res);\n                            },\n                            fail: function (res) {\n                                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameFail, bi_paramlist);\n                                console.log('wx.navigateToMiniProgram fail');\n                                console.log(res);\n                            },\n                            complete: function (res) {\n                                console.log('navigateToMiniProgram ==== complete');\n                            }\n                        });\n                    }\n\n                }\n\n            } catch (error) {\n                console.log(\"sxAdManager: \", error);\n            }\n        }\n    },\n\n    selectItemByWeight(num, arr) {\n        let limit = 0;\n        for (let i = 0; i < arr.length; i++) {\n            let weight = arr[i].weight;\n            if (weight) {\n                console.log(\"fuck\", weight);\n                if (num < weight + limit && num >= limit) {\n                    return i;\n                }\n            }\n            limit += weight;\n        }\n        return -1;\n    }\n}\n"]}
{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/window/assets/Script/ComponentScript/window/ddz_success.js"],"names":["cc","Class","extends","Component","properties","resultTitle","default","type","Node","progress","buttons","backButton","Button","topButton","bottomBtnText","RichText","videoIcon","getDiamondIcon","onLoad","backButtonH","ddz","GlobalFuncs","getBackButtonPositionY","node","y","AudioHelper","playMusic","winSize","director","getWinSize","bg","getChildByName","width","height","ty","NotificationCenter","listen","EventType","REMOVE_ALL_MATCH_RESULT_PANEL","shut","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","REWARD_VIDEO_COMPLETE","finishShowRewardVideo","REWARD_VIDEO_COMPLETE_ERROR","errorShowRewardVideo","UPDATE_BUTTON_TEXT","updateButtonText","isGetJiPaiQi","jipaiqiAdId","gameModel","checkShareReward","Share","SharePointType","addApplet","onClickGetDiamondBtn","hall","onOfficialAccountGuide","data","pointId","leftCount","judgeweChatVersion","active","ani","getComponent","Animation","play","showResults","isShow","adManager","showAllWidthBannerAd","trigger","CREATE_TABLE_AD","UserInfo","isInBSGS","throughCount","bc","getSkipCustomsConfigJson","newCustoms","onSkipCustom","shareType","onShareType","clickStatShareTypeCustomsSuccess","reultType","resultType","isBringVersion","MsgBoxManager","showToast","title","backAction","LOGD","playEffect","EffectPath_mp3","back_button_click_sound","REMOVE_TABLE_ANI","removeAni","popScene","seeAdGetJiPaiQi","showRewardedVideo","BiLog","clickStat","clickStatEventType","clickStatEventTypeButtonClick","isEnded","firstUseJiPaiQiPoint","shareToGetreward","firstUseJiPaiQi","adGetJiPaiQi","parArr","parseInt","onTopButtonAction","shareWithType","onBottomButtonAction","button_click_sound","matchModel","matchChallenge","removeMatchResultPanel","matchResultPanel","destroy","_onPreDestroy","_super","removeFromParent","ani_2","stop","onDestroy","ignoreScope","destroyWidthBannerAd","AdManagerTYWX","getAdNodeByTag","hideAdNode"],"mappings":"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","file":"ddz_success.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        resultTitle : {\n            default : null,\n            type : cc.Node\n        },\n        progress : {\n            default : null,\n            type : cc.Node\n        },\n        buttons : {\n            default : null,\n            type : cc.Node\n        },\n        backButton : {\n            default : null,\n            type : cc.Button\n        },\n\n        topButton:cc.Button,\n\n\n        bottomBtnText:cc.RichText,\n        videoIcon:cc.Node,\n\n        getDiamondIcon:cc.Node,\n    },\n\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad :function () {\n        var backButtonH = ddz.GlobalFuncs.getBackButtonPositionY();\n        if (backButtonH){\n            this.backButton.node.y = backButtonH;\n        }\n        // var window = this.resultTitle.getComponent('ddz_resultTitle');\n        // window.setTitle(1,true);\n\n        // var windowP = this.progress.getComponent('ddz_progress');\n        // windowP.setProgress(4);\n        // ddz.AudioHelper.stopMusic();\n        ddz.AudioHelper.playMusic('/resources/sound/Upgrade.mp3', false);\n\n        var winSize = cc.director.getWinSize();\n\n        var bg = this.node.getChildByName('ddz_scene_bg_0');\n\n        //全屏适配\n        this.node.width = winSize.width;\n        this.node.height = winSize.height;\n\n        bg.width = winSize.width;\n        bg.height = winSize.height;\n\n        // if (!ddz.curBannerAd) {\n        //     hall.adManager.showBannerAd('adunit-115c604197e9e3a6');\n        // }\n        \n        // if (!ddz.curAllWidthBannerAd){\n        //     hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n        // }\n\n        ty.NotificationCenter.listen(ddz.EventType.REMOVE_ALL_MATCH_RESULT_PANEL, this.shut, this);\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n\n        ty.NotificationCenter.listen(ddz.EventType.REWARD_VIDEO_COMPLETE,this.finishShowRewardVideo,this);\n        ty.NotificationCenter.listen(ddz.EventType.REWARD_VIDEO_COMPLETE_ERROR,this.errorShowRewardVideo,this);\n\n        // ty.NotificationCenter.listen(ddz.EventType.UPDATE_JIPAIQI,this.updateGetReward,this);\n        ty.NotificationCenter.listen(ty.EventType.UPDATE_BUTTON_TEXT, this.updateButtonText, this);\n        // var _shareType = ddz.Share.onShareType.clickStatShareTypeCustomsSuccess;\n        // this.bottomBtnText.string = \"<color=#FFFFFF>\"+ hall.GlobalFuncs.getButtonTitle(_shareType) +\"</c>\";\n\n        // hall.GlobalFuncs.btnScaleEffect(this.topButton.node,1.13);\n\n        this.isGetJiPaiQi = false;\n\n        this.jipaiqiAdId = \"adunit-8bde7ac62d379503\";\n        // var ani = this.videoIcon.getComponent(cc.Animation);\n        // ani.play('jieidan');\n        //\n        // if (hall.ME.udataInfo.jiPaiQiCount >= 6) {\n        //     this.videoIcon.active = false;\n        // }\n        ddz.gameModel.checkShareReward(ddz.Share.SharePointType.addApplet);\n    },\n\n    onClickGetDiamondBtn:function(){\n        hall.GlobalFuncs.onOfficialAccountGuide(true);\n    },\n\n    updateButtonText:function(data){\n        if (data.pointId == ddz.Share.SharePointType.addApplet){\n            if (data.leftCount && data.leftCount > 0 && ddz.GlobalFuncs.judgeweChatVersion()){\n                this.getDiamondIcon.active = true;\n                var ani = this.getDiamondIcon.getComponent(cc.Animation);\n                ani.play('getdiamond_ani');\n            }else {\n                this.getDiamondIcon.active = false;\n            }\n        }\n    },\n\n    showResults:function(isShow){\n        this.node.active = isShow;\n        if (isShow){\n            hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n            ty.NotificationCenter.trigger(ty.EventType.CREATE_TABLE_AD);\n        }\n        if (isShow && !ty.UserInfo.isInBSGS){\n            if (ddz.gameModel.throughCount == 0) {\n                var bc = ddz.gameModel.getSkipCustomsConfigJson();\n                if (bc && bc.newCustoms > 0) {\n                    hall.GlobalFuncs.onSkipCustom(1);\n                }\n            }\n        }\n    },\n\n\n    playAnimationAfterShareWithType : function (shareType) {\n        // 分享领取通关红包\n        if (shareType && shareType != ddz.Share.onShareType.clickStatShareTypeCustomsSuccess) {\n            return;\n        }\n        var reultType = ddz.Share.resultType;\n        switch (reultType) {\n            case 1:\n                if (!ddz.gameModel.isBringVersion) {\n                    hall.MsgBoxManager.showToast({title : '请分享到微信群哦~'});\n                }\n                break;\n            case 2:\n                if (!ddz.gameModel.isBringVersion) {\n                    hall.MsgBoxManager.showToast({title : '请不要频繁分享到一个群~'});\n                }\n                \n                break;\n            case 3:\n\n                break;\n            default:\n                break;\n        }\n\n        ddz.Share.resultType = 0;\n    },\n\n    backAction : function () {\n        ddz.LOGD(null, \"backAction\");\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.back_button_click_sound, false);\n        ty.NotificationCenter.trigger(ddz.EventType.REMOVE_TABLE_ANI);\n        this.removeAni();\n        hall.GlobalFuncs.popScene();\n    },\n\n    seeAdGetJiPaiQi:function(){\n        hall.LOGD(\"=====\",\"file = [ddz_success] fun = [seeAdGetJiPaiQi] this.jipaiqiAdId = \" + this.jipaiqiAdId);\n        this.isGetJiPaiQi = true;\n        hall.adManager.showRewardedVideo(this.jipaiqiAdId,\"getJiPaiQi\");\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"watchVideo\",\"ddzSuccessGetJiPaiQi\"]);\n    },\n\n    finishShowRewardVideo : function (isEnded) {\n        if (isEnded && this.isGetJiPaiQi) {\n            if (ddz.gameModel.firstUseJiPaiQiPoint > 0) {\n                ddz.gameModel.shareToGetreward(ddz.Share.SharePointType.firstUseJiPaiQi);\n            }else {\n                ddz.gameModel.shareToGetreward(ddz.Share.SharePointType.adGetJiPaiQi);\n            }\n            this.isGetJiPaiQi = false;\n        }\n    },\n    errorShowRewardVideo : function (parArr) {\n        this.finishShowRewardVideo(parseInt(parArr[1]));\n    },\n\n    // updateGetReward:function(){\n    //     if (hall.ME.udataInfo.jiPaiQiCount >= 6) {\n    //         this.videoIcon.active = false;\n    //     }\n    // },\n\n    onTopButtonAction : function () {\n        var shareType = ddz.Share.onShareType.clickStatShareTypeCustomsSuccess;\n        ddz.Share.shareWithType(shareType);\n    },\n\n    onBottomButtonAction : function () {\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.button_click_sound, false);\n        ddz.matchModel.matchChallenge();\n        ddz.GlobalFuncs.removeMatchResultPanel(this);\n    },\n\n    shut:function () {\n        ddz.matchResultPanel = null;\n        // this.topButton.node.stopAllActions();\n        this.removeAni();\n        this.node.destroy();\n    },\n    _onPreDestroy:function () {\n        this._super();\n        //删除动画\n        this.removeAni();\n    },\n    removeAni:function () {\n\n        if (this.resultTitle){\n            this.resultTitle.removeFromParent();\n        }\n        if (this.progress){\n            this.progress.removeFromParent();\n        }\n        // var ani = this.videoIcon.getComponent(cc.Animation);\n        // ani.stop();\n        // this.videoIcon.removeFromParent();\n\n        var ani_2 = this.getDiamondIcon.getComponent(cc.Animation);\n        ani_2.stop();\n        this.getDiamondIcon.removeFromParent();\n    },\n    onDestroy:function () {\n        ty.NotificationCenter.ignoreScope(this);\n        hall.adManager.destroyWidthBannerAd();\n        if (hall.AdManagerTYWX && hall.AdManagerTYWX.getAdNodeByTag(\"tableAdNode\")) {\n            hall.AdManagerTYWX.getAdNodeByTag(\"tableAdNode\").hideAdNode();\n        }\n    }\n\n    // update (dt) {},\n});\n"]}
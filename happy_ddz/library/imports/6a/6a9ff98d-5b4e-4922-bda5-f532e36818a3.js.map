{"version":3,"sources":["../../../../../../assets/Script/hall/utils/assets/Script/hall/utils/AdManager.js"],"names":["hall","adManager","icoBtn","videoAdId","checkVideoTime","canShowTableBanner","canShowTableTopBanner","canShowListSceneBanner","sysInfo","adIconBtn","adInfoList","currentAdInfo","currentWebPage","retryTimes","AnimType","STATIC","SHAKE","FRAME","showAdIco","showBigAd","adPath","wx","previewImage","current","urls","success","res","ddz","LOGD","fail","hideAdIco","active","getSysInfo","getSystemInfoSync","showRewardedVideo","adId","type","hasOwnProperty","ty","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeWatchVideo","LOGW","MsgBoxManager","showToast","title","destroyWidthBannerAd","onvVdClose","JSON","stringify","playEnded","isEnded","NotificationCenter","trigger","EventType","REWARD_VIDEO_COMPLETE","videoAdManager","offClose","canPlay","checkVideoAd","show","onClose","createRewardedVideoAd","adUnitId","load","then","catch","err","setTimeout","canShowBanner","showBannerAd","adid","screenWidth","screenHeight","winSize","cc","director","getWinSize","left_x","curAllWidthBannerAd","createBannerAd","style","left","top","width","haveBanner","onResize","height","showTopBannerAd","curTpoBannerAd","showAllWidthBannerAd","interval","GlobalFuncs","getBannerIntervalY","showResurgenceBannerAd","hideBannerAd","curBannerAd","hide","destroyBannerAd","destroy","destroyResurgenceBannerAd","resurgenceBannerAd","requestADInfo","reqObj","timeStamp","Date","getTime","act","time","game_mark","SystemInfo","cloudid","gameId","signStr","getConfigSignStr","paramStrList","key","push","finalUrl","shareManagerUrl","join","that","request","url","method","statusCode","ret","data","retmsg","index","GET_AD_MSG_SUCCESS","getAdNode","showAd","position","genRandomFirstAdInfo","loader","loadRes","prefab","preFabNode","instantiate","p","x","y","game","addPersistRootNode","adIconNode","adButton","getChildByName","on","onClickAdIconBtn","length","weight_list","i","_randomObj","parseInt","icon_weight","icon_id","sort","a","b","weight","_total","_randomIndex","Math","random","_tTotal","_selectIndex","_selectObj","id","genRandomSecondAdInfo","_webPages","webpages","webpage_weight","config_id","_animaType","icon_type","spriteIco","stopAllActions","getComponent","Animation","removeComponent","setRotation","clickStatEventTypeShowAdBtn","icon_skip_type","toappid","togame","icon_url","texture","Sprite","spriteFrame","SpriteFrame","error","anchorX","anchorY","_act1","rotateBy","_act2","_act3","_act4","_delay","delayTime","runAction","repeatForever","sequence","repeat","allFrames","playFrameAction","animation","addComponent","clip","AnimationClip","createWithSpriteFrames","name","wrapMode","WrapMode","Loop","addClip","play","results","log","getError","_frame","getContent","hideAd","skip_type","topath","path","second_toappid","console","clickStatEventTypeClickAdBtn","navigateToMiniProgram","appId","envVersion","extraData","from","clickStatEventTypeClickDirectToMiniGameSuccess","webpage_url","clickStatEventTypeClickDirectToMiniGameFail","complete","resetBtnIcon","clickStatEventTypeClickShowQRCode","sortedKeys","Object","keys","finalSign","hex_md5"],"mappings":"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","file":"AdManager.js","sourceRoot":"../../../../../../assets/Script/hall/utils","sourcesContent":["/**\n * 导量广告ICO\n * Created by xujing on 2018/5/16.\n */\nhall.adManager = {\n    icoBtn:null,\n    videoAdId:\"adunit-18726a0b6953b0d2\",\n    checkVideoTime : 300000,\n    canShowTableBanner : false,\n    canShowTableTopBanner : false,\n    canShowListSceneBanner : false,\n    sysInfo:null,\n\n\n    //交叉导流\n    adIconBtn: null,                //向其他小游戏的导流入口\n    adInfoList : [],                //所有广告信息的列表\n    currentAdInfo : null,           //当前做展示的导流信息\n    currentWebPage : null,          //当前显示的最终导流游戏的信息\n    retryTimes : 3,                 //网络请求失败重试次数//demo数据\n    AnimType : {                    //广告显示的动画\n        STATIC : 1, //静态\n        SHAKE  : 2, //抖动\n        FRAME  : 3  //帧动画\n    },\n\n\n    showAdIco:function () {\n    },\n\n    \n    /**\n     * 显示广告图\n     */\n    showBigAd:function () {\n\n        var adPath = 'https://richqn.nalrer.cn/dizhu/other_game_ico/fish/ad_big_fish.jpg';\n        wx.previewImage({\n            current: adPath,\n            urls: [adPath],\n            success:function(res){\n                ddz.LOGD(null, \"预览图片成功！\");\n            },\n            fail:function (res) {\n                ddz.LOGD(null, \"预览图片失败！\");\n            }\n        });\n    },\n    \n\n    hideAdIco:function () {\n        if (this.icoBtn){\n            this.icoBtn.active = false;\n        }\n    },\n\n    getSysInfo:function () {\n        if (!this.sysInfo){\n            this.sysInfo = wx.getSystemInfoSync();\n        }\n        return this.sysInfo;\n    },\n\n    /**\n     * 播放激励广告视频\n     * @param adId 广告ID\n     * @param type\n     */\n    showRewardedVideo:function (adId,type) {\n        // throw new Error('许敬测试的错误!');\n        if (!wx.hasOwnProperty('createRewardedVideoAd')){\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo, [\"not support\",type]);\n            hall.LOGW(null, '玩家基础库,不支持激励广告视频!');\n            hall.MsgBoxManager.showToast({title:'您的微信版本过低,请升级至6.6.6以上'});\n            return;\n        }\n        // this.destroyBannerAd();\n        this.destroyWidthBannerAd();\n\n        var onvVdClose = function (res) {\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo, [\"success\",type]);\n            hall.LOGW(null, '广告播放完毕!' + JSON.stringify(res));\n            var playEnded = (!res || (res && res.isEnded));\n            //只有播放完成才发奖\n            ty.NotificationCenter.trigger(ddz.EventType.REWARD_VIDEO_COMPLETE, playEnded);\n            hall.adManager.videoAdManager.offClose(onvVdClose);\n            hall.adManager.canPlay = false;\n            hall.adManager.checkVideoAd();\n        };\n\n        if (hall.adManager.canPlay){\n            this.canShowTableBanner = false;\n            this.canShowTableTopBanner = false;\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo, [\"begin\", type]);\n            hall.adManager.videoAdManager.show();\n            // this.destroyResurgenceBannerAd();\n            // this.destroyWidthBannerAd();\n            // this.destroyBannerAd();\n            this.destroyWidthBannerAd();\n            hall.adManager.videoAdManager.onClose(onvVdClose);\n        }\n        else{\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo, [\"fail\", type]);\n            ty.NotificationCenter.trigger(ddz.EventType.REWARD_VIDEO_COMPLETE, true);\n        }\n    },\n\n    checkVideoAd:function () {\n        if (!wx.hasOwnProperty('createRewardedVideoAd')){\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo, [\"not support\"]);\n            hall.LOGW(null, '玩家基础库,不支持激励广告视频!');\n            return;\n        }\n\n        if (!this.videoAdManager){\n            this.videoAdManager = wx.createRewardedVideoAd({\n                adUnitId: hall.adManager.videoAdId\n            });\n        }\n\n        this.videoAdManager.load().then(function () {\n            hall.LOGW(\"====== 成功获取广告\");\n            hall.adManager.canPlay = true;\n        }).catch(function (err) {\n            hall.LOGW(\"====== 获取广告失败,继续获取\", JSON.stringify(err));\n            hall.adManager.canPlay = false;\n\n            setTimeout(function () {\n                hall.adManager.checkVideoAd();\n            }, hall.adManager.checkVideoTime);\n        });\n    },\n\n    canShowBanner:function () {\n        return wx.hasOwnProperty('createBannerAd');\n    },\n\n    /**\n     * 展示Banner广告\n     * @param adid 广告ID\n     */\n    showBannerAd:function (adid) {\n        if (!this.canShowBanner()){\n            hall.LOGW(null, '玩家基础库,不支持banner!');\n            return;\n        }\n\n        var sysInfo = this.getSysInfo();\n        var screenWidth = sysInfo.screenWidth;\n        var screenHeight = sysInfo.screenHeight;\n        var winSize = cc.director.getWinSize();\n\n        // this.destroyBannerAd();\n        this.destroyWidthBannerAd();\n        // this.destroyResurgenceBannerAd();\n\n        hall.LOGW('showBannerAd', '当前屏幕宽度:' + screenWidth + \"; screenHeight:\" + screenHeight);\n        var left_x = 0;\n        if (screenWidth && screenWidth < 350){\n            left_x = -30;\n        }\n        if (!ddz.curAllWidthBannerAd) {\n            ddz.curAllWidthBannerAd = wx.createBannerAd({\n                adUnitId: adid,\n                style: {\n                    left:left_x,\n                    top:0,\n                    width: 300\n                }\n            });\n        }\n\n        ddz.haveBanner = true;\n        // var posx = 0;\n        // var posy = 0;\n        ddz.curAllWidthBannerAd.onResize(function (res) {\n            hall.LOGW('showBannerAd', '当前banner,width:' + res.width + \"; height:\" + res.height);\n            if (ddz.curAllWidthBannerAd){\n                ddz.curAllWidthBannerAd.style.left = left_x;\n                ddz.curAllWidthBannerAd.style.top = screenHeight - res.height + 10;\n                // posx = res.width * (winSize.width/screenWidth);\n                // posy = res.height * (winSize.height/screenHeight) - 28;\n            }\n        });\n        ddz.curAllWidthBannerAd.show();\n    },\n\n    /**\n     * 展示Banner广告\n     * @param adid 广告ID\n     */\n    showTopBannerAd:function (adid) {\n        if (!this.canShowBanner()){\n            hall.LOGW(null, '玩家基础库,不支持banner!');\n            return;\n        }\n\n        var sysInfo = this.getSysInfo();\n        var screenWidth = sysInfo.screenWidth;\n        var screenHeight = sysInfo.screenHeight;\n\n        // this.destroyBannerAd();\n        this.destroyWidthBannerAd();\n        // this.destroyResurgenceBannerAd();\n\n        hall.LOGW('showTopBannerAd', '当前屏幕宽度:' + screenWidth + \"; screenHeight:\" + screenHeight);\n\n        ddz.curTpoBannerAd = wx.createBannerAd({\n            adUnitId: adid,\n            style: {\n                left:0,\n                top:-10,\n                width: 300\n            }\n        });\n        ddz.haveBanner = true;\n        ddz.curTpoBannerAd.onResize(function (res) {\n            hall.LOGW('showTopBannerAd', '当前banner,width:' + res.width + \"; height:\" + res.height);\n            if (ddz.curTpoBannerAd){\n                ddz.curTpoBannerAd.style.left = (screenWidth - res.width)/2;\n                ddz.curTpoBannerAd.style.top = -10;\n            }\n        });\n\n        ddz.curTpoBannerAd.show();\n    },\n\n    showAllWidthBannerAd:function (adid) {\n        if (!this.canShowBanner()){\n            hall.LOGW(null, '玩家基础库,不支持banner!');\n            return;\n        }\n        var sysInfo = this.getSysInfo();\n        var screenWidth = sysInfo.screenWidth;\n        var screenHeight = sysInfo.screenHeight;\n\n        // this.destroyBannerAd();\n        this.destroyWidthBannerAd();\n        // this.destroyResurgenceBannerAd();\n\n        hall.LOGW('showTopBannerAd', '当前屏幕宽度:' + screenWidth + \"; screenHeight:\" + screenHeight);\n\n        if (!ddz.curAllWidthBannerAd) {\n            ddz.curAllWidthBannerAd = wx.createBannerAd({\n                adUnitId: adid,\n                style: {\n                    left:0,\n                    top:0,\n                    width: screenWidth\n                }\n            });\n        }\n\n        ddz.haveBanner = true;\n\n        var interval = ddz.GlobalFuncs.getBannerIntervalY() || 0;\n\n        ddz.curAllWidthBannerAd.onResize(function (res) {\n            hall.LOGW('showAllWidthBannerAd', '当前banner,width:' + res.width + \"; height:\" + res.height);\n            if (ddz.curAllWidthBannerAd){\n                ddz.curAllWidthBannerAd.style.left = (screenWidth - res.width)/2;\n                ddz.curAllWidthBannerAd.style.top = screenHeight - res.height - interval;\n            }\n        });\n\n        ddz.curAllWidthBannerAd.show();\n    },\n\n    showResurgenceBannerAd:function(adid){\n        if (!this.canShowBanner()){\n            hall.LOGW(null, '玩家基础库,不支持banner!');\n            return;\n        }\n        var sysInfo = this.getSysInfo();\n        var screenWidth = sysInfo.screenWidth;\n        var screenHeight = sysInfo.screenHeight;\n\n        // this.destroyBannerAd();\n        this.destroyWidthBannerAd();\n        // this.destroyResurgenceBannerAd();\n        hall.LOGW('showTopBannerAd', '当前屏幕宽度:' + screenWidth + \"; screenHeight:\" + screenHeight);\n        if (!ddz.curAllWidthBannerAd) {\n            ddz.curAllWidthBannerAd = wx.createBannerAd({\n                adUnitId: adid,\n                style: {\n                    left:0,\n                    top:0,\n                    width: screenWidth\n                }\n            });\n        }\n\n        ddz.haveBanner = true;\n\n        ddz.curAllWidthBannerAd.onResize(function (res) {\n            hall.LOGW('showResurgenceBannerAd', '当前banner,width:' + res.width + \"; height:\" + res.height);\n            if (ddz.curAllWidthBannerAd){\n                ddz.curAllWidthBannerAd.style.left = (screenWidth - res.width)/2;\n                ddz.curAllWidthBannerAd.style.top = screenHeight/2 - res.height;\n            }\n        });\n\n        ddz.curAllWidthBannerAd.show();\n    },\n\n    hideBannerAd:function () {\n        if (ddz.curBannerAd) {\n            ddz.curBannerAd.hide();\n        }\n\n        if (ddz.curTpoBannerAd) {\n            ddz.curTpoBannerAd.hide();\n        }\n\n        if (ddz.curAllWidthBannerAd) {\n            ddz.curAllWidthBannerAd.hide();\n        }\n        ddz.haveBanner = false;\n    },\n\n    destroyBannerAd:function () {\n        ddz.haveBanner = false;\n        if (ddz.curBannerAd){\n            if (ddz.curBannerAd.destroy) {\n                ddz.curBannerAd.destroy();\n            }\n            ddz.curBannerAd = null;\n        }\n        if (ddz.curTpoBannerAd){\n            if (ddz.curTpoBannerAd.destroy) {\n                ddz.curTpoBannerAd.destroy();\n            }\n            ddz.curTpoBannerAd = null;\n        }\n\n        // if (ddz.bannerCloseBtn) {\n        //     ddz.bannerCloseBtn.onClose();\n        // }\n    },\n    \n    destroyWidthBannerAd:function(){\n        ddz.haveBanner = false;\n        // if (ddz.curAllWidthBannerAd){\n        //     if (ddz.curAllWidthBannerAd.destroy) {\n        //         ddz.curAllWidthBannerAd.destroy();\n        //     }\n        //     ddz.curAllWidthBannerAd = null;\n        // }\n        if (ddz.curAllWidthBannerAd) {\n            ddz.curAllWidthBannerAd.hide();\n        }\n    },\n\n    destroyResurgenceBannerAd:function(){\n        ddz.haveBanner = false;\n        if (ddz.resurgenceBannerAd){\n            if (ddz.resurgenceBannerAd.destroy) {\n                ddz.resurgenceBannerAd.destroy();\n            }\n            ddz.resurgenceBannerAd = null;\n        }\n    },\n\n\n    /**\n     * 请求交叉倒流的信息\n     */\n    requestADInfo : function () {\n\n        // if(!tywx.IsWechatPlatform()) {\n        //     return;\n        // }\n        this.retryTimes--;\n        var reqObj = {};\n        var timeStamp = new Date().getTime();\n        reqObj.act = 'api.getCrossConfig';\n        reqObj.time = timeStamp;\n        reqObj.game_mark = ty.SystemInfo.cloudid + \"-\" + ty.SystemInfo.gameId;\n        var signStr = this.getConfigSignStr(reqObj);\n        var paramStrList = [];\n        for(var key in reqObj) {\n            paramStrList.push(key + '=' + reqObj[key]);\n        }\n        paramStrList.push('sign=' + signStr);\n        var finalUrl = ty.SystemInfo.shareManagerUrl + '?' + paramStrList.join('&');\n        var that = this;\n\n        wx.request({\n            url : finalUrl,\n            method : 'GET',\n            success : function (res) {\n                if (res.statusCode == 200){\n\n                    var ret = res.data;\n                    // console.log('RET:' + JSON.stringify(ret));\n                    hall.LOGD(\"hall.ad\",'RET:' + JSON.stringify(ret));\n                    that.adInfoList = [];\n                    if(ret.retmsg){\n                        for(var index in ret.retmsg){\n\n                            that.adInfoList.push(ret.retmsg[index]);\n\n                        }\n                    }\n\n                    ty.NotificationCenter.trigger(ty.EventType.GET_AD_MSG_SUCCESS);\n\n                    that.retryTimes = 3;\n                }\n            },\n            fail : function (res) {\n\n                if(that.retryTimes > 0){\n\n                    // that.requestADInfo();\n                }else{\n                    that.retryTimes = 0;\n                }\n\n            }\n        });\n\n\n    },\n\n    /**\n     * 获取广告推广节点（可任意添加动画）\n     * @returns {null}\n     */\n    getAdNode : function () {\n        return this.adIconBtn;\n    },\n\n    /**\n     * 对外接口，用于添加广告位\n     * position {x, y}\n     */\n    showAd: function(position) {\n\n        this.genRandomFirstAdInfo();\n\n        if(!this.currentAdInfo){\n            return;\n        }\n        \n        if(this.adIconBtn) {\n            this.adIconBtn.active = true;\n        } else {\n            var that = this;\n            //动态加载资源必须放在resources目录下,导流入口强制命名为adNode,放在resources/prefabs下\n            cc.loader.loadRes('prefabs/adNode', function (err, prefab) {\n                var preFabNode = cc.instantiate(prefab);\n                preFabNode.position = cc.p(position.x, position.y);\n                that.adIconBtn = preFabNode;\n                cc.game.addPersistRootNode(preFabNode);\n                that.adIconNode();\n                var adButton = that.adIconBtn.getChildByName('adButton');\n                adButton.on('click', function () {\n                    that.onClickAdIconBtn();\n                });\n            });\n        }\n    },\n\n    /**\n     * 生成随机的一级导流信息\n     */\n    genRandomFirstAdInfo : function() {\n\n        if(this.adInfoList.length == 0){\n            return;\n        }\n\n        var weight_list = [\n            {\n                'weight':0,\n                'id':'000'\n            }\n        ];\n        var that = this;\n\n        for(var i in this.adInfoList){\n\n            var _randomObj = {\n                'weight' : parseInt(that.adInfoList[i].icon_weight),\n                'id' : that.adInfoList[i].icon_id,\n            };\n            weight_list.push(_randomObj);\n        }\n\n        weight_list.sort(function(a, b){\n            return a.weight > b.weight;\n        });\n\n        var _total = 0;\n\n        for (var i = 0 ; i < weight_list.length ; i ++){\n            _total += weight_list[i].weight;\n        }\n        //     weight_list.forEach(element => {\n        //         _total += element.weight;\n        // });\n\n        var _randomIndex = parseInt(Math.random()*10000)%(_total+1);\n\n        var _tTotal = 0;\n\n        var _selectIndex = 0;\n\n        for(var i=0; i<(weight_list.length-1);i++){\n            _tTotal += weight_list[i].weight;\n            if(_tTotal < _randomIndex && (_tTotal+weight_list[i+1].weight) >= _randomIndex){\n                _selectIndex = i+1;\n                break;\n            }\n        }\n        var _selectObj= weight_list[_selectIndex];\n\n        for (var i = 0 ; i < this.adInfoList.length ; i ++){\n            if(this.adInfoList[i].icon_id == _selectObj.id){\n                this.currentAdInfo = this.adInfoList[i];\n            }\n        }\n        //     this.adInfoList.forEach(element => {\n        //         if(element.icon_id == _selectObj.id){\n        //         this.currentAdInfo = element;\n        //     }\n        // });\n\n    },\n\n    /**\n     * 生成随机的二级导流信息\n     */\n    genRandomSecondAdInfo : function() {\n\n        var _webPages = this.currentAdInfo.webpages;\n\n        if(_webPages.length == 0){\n            return;\n        }\n\n        var weight_list = [{'weight':0, 'id':'000'}];\n\n        for(var i in _webPages){\n\n            var _randomObj = {\n                'weight' : parseInt(_webPages[i].webpage_weight),\n                'id' : _webPages[i].config_id\n            };\n\n            weight_list.push(_randomObj);\n        }\n\n        weight_list.sort(function(a, b){\n            return a.weight > b.weight;\n        });\n\n        var _total = 0;\n\n        for (var i = 0 ; i < weight_list.length ; i ++){\n            _total += weight_list[i].weight;\n        }\n        //     weight_list.forEach(element => {\n        //         _total += element.weight;\n        // });\n\n        var _randomIndex = parseInt(Math.random()*10000)%(_total+1);\n\n        var _tTotal = 0;\n\n        var _selectIndex = 0;\n        for(var i=0; i<(weight_list.length-1);i++){\n            _tTotal +=  weight_list[i].weight;\n            if(_tTotal < _randomIndex && (_tTotal+weight_list[i+1].weight) >= _randomIndex){\n                _selectIndex = i+1;\n                break;\n            }\n        }\n        var _selectObj = weight_list[_selectIndex];\n\n\n        for (var i = 0 ; i < _webPages.length ; i ++){\n            if(_webPages[i].config_id == _selectObj.id){\n                this.currentWebPage = _webPages[i];\n            }\n        }\n        //     _webPages.forEach(element => {\n        //         if(element.config_id == _selectObj.id){\n        //         this.currentWebPage = element;\n        //     }\n        // });\n\n    },\n\n    adIconNode : function () {\n\n        if(!this.currentAdInfo || !this.adIconBtn){\n            return;\n        }\n\n        var _animaType = this.currentAdInfo.icon_type;\n        var that = this;\n\n        var spriteIco = this.adIconBtn.getChildByName('adIcon');\n        var adButton = this.adIconBtn.getChildByName('adButton');\n\n        spriteIco.stopAllActions();\n        if(spriteIco.getComponent(cc.Animation)){\n            spriteIco.removeComponent(cc.Animation);\n        }\n\n        spriteIco.setRotation(0);\n\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeShowAdBtn, [that.currentAdInfo.icon_id,\n            that.currentAdInfo.icon_type,\n            that.currentAdInfo.icon_skip_type,\n            that.currentAdInfo.toappid,\n            that.currentAdInfo.togame]);\n\n        switch (_animaType){\n\n            case this.AnimType.STATIC:\n\n                cc.loader.load({url: that.currentAdInfo.icon_url[0]}, function (err, texture) {\n                    if (!err) {\n\n                        spriteIco.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n                    }\n                    else {\n\n                    }\n                });\n\n                break;\n            case this.AnimType.SHAKE:\n\n                cc.loader.load({url:that.currentAdInfo.icon_url[0]}, function(error, texture){\n\n                    spriteIco.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n                    spriteIco.anchorX = 0.5;\n                    spriteIco.anchorY = 0.5;\n                    var _act1 = cc.rotateBy(0.06, -20);\n                    var _act2 = cc.rotateBy(0.12, 40);\n                    var _act3 = cc.rotateBy(0.12, -40);\n                    var _act4 = cc.rotateBy(0.06, 20);\n                    var _delay = cc.delayTime(1);\n                    spriteIco.runAction(cc.repeatForever(cc.sequence(_act1,\n                        cc.repeat(cc.sequence(_act2, _act3), 4),\n                        _act4,\n                        _delay)));\n                });\n\n\n                break;\n            case this.AnimType.FRAME:\n\n                var allFrames =[];\n\n                var playFrameAction = function () {\n\n                    if(!spriteIco.getComponent(cc.Animation)) {\n\n                        var animation = spriteIco.addComponent(cc.Animation);\n                        var clip = cc.AnimationClip.createWithSpriteFrames(allFrames, 10);\n                        clip.name = 'anim_frame';\n                        clip.wrapMode = cc.WrapMode.Loop;\n                        animation.addClip(clip);\n                        animation.play('anim_frame');\n                    }\n                };\n\n                for(var i = 0; i < that.currentAdInfo.icon_url.length; i++) {\n\n                    cc.loader.load(that.currentAdInfo.icon_url,function (err, results) {\n\n\n                        if (err) {\n                            for (var i = 0; i < err.length; i++) {\n                                cc.log('Error url [' + err[i] + ']: ' + results.getError(err[i]));\n                            }\n                        }\n\n                        for(var i = 0; i < that.currentAdInfo.icon_url.length; i++) {\n\n                            var _frame = new cc.SpriteFrame(results.getContent(that.currentAdInfo.icon_url[i]));\n                            allFrames.push(_frame);\n                        }\n                        playFrameAction();\n                    });\n                }\n\n                break;\n            default:\n                break;\n\n        }\n\n    },\n\n    hideAd: function() {\n        if(this.adIconBtn) {\n            this.adIconBtn.active = false;\n        }\n    },\n\n    onClickAdIconBtn: function() {\n\n        this.genRandomSecondAdInfo();\n\n        //先尝试直接跳转\n        var skip_type =  this.currentAdInfo.icon_skip_type;\n        var toappid = this.currentAdInfo.toappid;\n        var togame = this.currentAdInfo.togame;\n        var topath = this.currentAdInfo.path;\n        var second_toappid = this.currentAdInfo.second_toappid;\n\n        console.log('topath ====>' + topath);\n\n        var that = this;\n\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickAdBtn, [that.currentAdInfo.icon_id,\n            that.currentAdInfo.toappid,\n            that.currentAdInfo.togame]);\n\n        //先尝试直接跳转\n        if(wx && wx.navigateToMiniProgram){\n            // this.resetBtnIcon();\n            if(1 == skip_type){\n\n                wx.navigateToMiniProgram({\n                    appId: toappid,\n                    path : topath ? topath : '?from=adcross',\n                    envVersion: 'release',\n                    extraData: {\n                        from: topath ? topath : '?from=adcross'\n                    },\n                    success: function(res) {\n\n                        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameSuccess, [that.currentAdInfo.icon_id,\n                            that.currentWebPage.config_id,\n                            that.currentWebPage.webpage_url,\n                            that.currentAdInfo.toappid,\n                            that.currentAdInfo.togame]);\n                        console.log('wx.navigateToMiniProgram success');\n                        console.log(res);\n                    },\n                    fail: function (res) {\n                        console.log('wx.navigateToMiniProgram fail');\n                        console.log(res);\n\n                        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameFail, [that.currentAdInfo.icon_id,\n                            that.currentWebPage.config_id,\n                            that.currentWebPage.webpage_url,\n                            that.currentAdInfo.toappid,\n                            that.currentAdInfo.togame]);\n                    },\n                    complete: function (res) {\n\n                        console.log('navigateToMiniProgram ==== complete');\n                        that.resetBtnIcon();\n                    }\n                });\n\n                return;\n            }else if(2 == skip_type){\n\n                wx.navigateToMiniProgram({\n                    appId: second_toappid,\n                    path : topath ? topath : '?from=adcross',\n                    envVersion: 'release',\n                    extraData: {\n                        from: topath ? topath : '?from=adcross',\n                    },\n                    success: function(res) {\n                        console.log('wx.navigateToMiniProgram success');\n                        console.log(res);\n\n                        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameSuccess, [that.currentAdInfo.icon_id,\n                            that.currentWebPage.config_id,\n                            that.currentWebPage.webpage_url,\n                            that.currentAdInfo.toappid,\n                            that.currentAdInfo.togame]);\n                    },\n                    fail: function (res) {\n                        console.log('wx.navigateToMiniProgram fail');\n                        console.log(res);\n\n                        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameFail, [that.currentAdInfo.icon_id,\n                            that.currentWebPage.config_id,\n                            that.currentWebPage.webpage_url,\n                            that.currentAdInfo.toappid,\n                            that.currentAdInfo.togame]);\n                    },\n                    complete: function (res) {\n\n                        console.log('navigateToMiniProgram ==== complete');\n                        that.resetBtnIcon();\n                    }\n\n                });\n\n\n            }else{\n                console.error('Unsupported skip type! Please Check!');\n            }\n\n\n            return;\n        }\n\n        //直接跳转接口不好使，展示 小程序/小游戏 二维码图片\n        if(!this.currentWebPage){\n            return;\n        }\n\n        var that = this;\n\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickShowQRCode, [that.currentAdInfo.icon_id,\n            that.currentWebPage.config_id,\n            that.currentWebPage.webpage_url,\n            that.currentAdInfo.toappid,\n            that.currentAdInfo.togame]);\n        // if(tywx.IsWechatPlatform()) {\n        wx.previewImage({\n            current: [that.currentWebPage.webpage_url],\n            urls: [that.currentWebPage.webpage_url],\n            success:function(res){\n                hall.LOGD(null, \"预览图片成功！\");\n            },\n            fail:function (res) {\n                hall.LOGD(null, \"预览图片失败！\");\n            },\n            complete :function (res) {\n                hall.LOGD('预览图片完成');\n                that.resetBtnIcon();\n            }\n        });\n        // }\n\n        this.resetBtnIcon();\n    },\n\n    /**\n     * 刷新ad按钮的icon\n     */\n    resetBtnIcon : function() {\n\n        if(!this.adIconBtn){\n            return;\n        }else{\n            this.genRandomFirstAdInfo();\n            this.adIconNode();\n        }\n\n    },\n\n    /**\n     * 计算签名字符串\n     * @param reqObj\n     * @returns {string}\n     */\n    getConfigSignStr: function(reqObj) {\n        var sortedKeys = Object.keys(reqObj).sort();\n        var signStr = '';\n        for(var i=0;i<sortedKeys.length;i++){\n            var key = sortedKeys[i];\n            if(key == 'act' || key == 'sign') {\n                continue;\n            } else {\n                signStr += key + '=' + reqObj[key];\n            }\n        }\n        var finalSign = hall.hex_md5('market.tuyoo.com-api-' + signStr + '-market.tuyoo-api') || '';\n        return finalSign;\n    }\n};\n"]}
{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/window/assets/Script/ComponentScript/window/GoldModule.js"],"names":["cc","Class","extends","Component","properties","btnBack","Button","jifenNode","Node","jifenLeftNode","jifenRightNode","lblDiFen","Label","lblNum","game_result","Prefab","tasksNode","matchNode","matchingNode","txtSfee","ctor","setTableScene","val","_tableScene","_tableInfoChange","tableInfo","refresh","myAvatar","active","_tableState","normalInfo","m_state","ddz","Enums","TableState","TABLEDSTAT_PLAYING","initScore","_leftSeatinfo","hasData","_rightSeatinfo","_onGameReady","_onUpdateInfo","pos","type","updateMultiple","baseScore","multiple","string","showTboxGetReward","result","roomId","that","seattb","task","_mySeatIndex","tbc","loader","loadRes","err","prefab","preFabNode","instantiate","com","getComponent","_roomId","mixRoomId","updateProgress","tbt","addChild","bind","onLoad","ty","NotificationCenter","listen","EventType","UPDATE_PLAYER_INFO","GAME_READY","TABLE_INFO_CHAGE","BUY_CHIP_CHANEG","_onByInChipChange","backButtonH","GlobalFuncs","getBackButtonPositionY","node","y","START_MATCHING","startAni","STOP_MATCHING","stopAni","REMOVE_TABLE_ANI","removeMatching","UserInfo","systemType","SYSTEMTYPE","iPhoneXType","widL","Widget","top","widR","LOGD","JSON","stringify","matchModel","getCurQueueInfo","ani","Animation","anim","getAnimationState","play","stop","removeFromParent","seatId","mscore","_mySeatinfo","model","m_buyinChip","setScore","trigger","showGoldInfo","config","m_sfee","obj","userPanel","updateAllScore","myIndex","leftindex","getPreIndex","rightindex","GetNextIndex","checkSeatIsWin","seatIndex","dizhuWin","dizhuwin","isWin","stat","dizhu","seatInfo","score","delta","upDataScore","scroe","lblScoreChange","lblName","deltaStr","hall","formatGold","getScoreLabel","callBack","callFunc","opacity","flyAni","sequence","delayTime","fadeOut","runAction","reSetAddScore","lblScore","showResult","_reset","_gameResult","game_result_wnd","director","getScene","show","mySeatIndex","saveCardsString","ReadStringFromLocalStorage","gameModel","ORIGINCARDS","saveCardsDic","parse","cards","myCards","baseCards","baseCard","concat","saveDic","setInLocalStorage","scheduleOnce","winShare","loseShare","winchips","showShareMomentsItem","winstreak","scoreNode","getChildByName","onDestroy","ignoreScope","reset","stopAllActions","update","dt","onBack","REMOVE_MATCHING","AudioHelper","playEffect","EffectPath_mp3","back_button_click_sound","tableinfo","_mixID","mixId","_queueInfo","MsgFactory","getRoomLeave","tableId"],"mappings":"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","file":"GoldModule.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnBack : cc.Button,\n        jifenNode : cc.Node,\n        jifenLeftNode : cc.Node,\n        jifenRightNode : cc.Node,\n        lblDiFen : cc.Label,\n        lblNum: cc.Label,\n        game_result : cc.Prefab,\n        tasksNode: cc.Node,\n        matchNode : cc.Node,\n        matchingNode : cc.Node,\n        txtSfee : cc.Label\n    },\n\n    ctor:function () {\n    },\n\n    setTableScene:function (val) {\n        this._tableScene = val;\n        this._tableInfoChange(this._tableScene.tableInfo());\n        this.refresh();\n    },\n\n    refresh:function () {\n        this._tableScene.myAvatar.active = this._tableScene._tableState.normalInfo.m_state != ddz.Enums.TableState.TABLEDSTAT_PLAYING;\n\n        this.initScore();\n        if (this._tableScene._leftSeatinfo.hasData && this._tableScene._rightSeatinfo.hasData){\n            //坐滿了,\n            this._onGameReady();\n        }\n\n        if (this._tableScene._leftSeatinfo.hasData){\n            this._onUpdateInfo({pos:'left', type:'sit'});\n        }\n\n        if (this._tableScene._rightSeatinfo.hasData){\n            this._onUpdateInfo({pos:'right', type:'sit'});\n        }\n    },\n\n    updateMultiple:function (baseScore, multiple) {\n        this.lblDiFen.string = baseScore + \" x \" + multiple + \"倍\";\n    },\n\n    // hideGoldInfo:function(){\n    //     this.goldInfoNode.active = false;\n    // },\n    \n    showTboxGetReward:function(result,roomId){\n        var that = this;\n        // 金币场牌局内任务\n        if (result.seattb) {\n            var task = result.seattb[this._tableScene._mySeatIndex - 1];\n            if (task && task.tbc > 0){\n                cc.loader.loadRes(\"prefabs/gameTasks\", function (err, prefab) {\n                    var preFabNode = cc.instantiate(prefab);\n                    var com = preFabNode.getComponent(\"ddz_gameTasks\");\n                    var _roomId = roomId;\n                    if (task.mixRoomId) {\n                        _roomId = task.mixRoomId;\n                    }\n                    com.updateProgress(task.tbt,task.tbc,_roomId);\n                    if (that.tasksNode) {\n                        that.tasksNode.addChild(preFabNode);\n                    }\n                }.bind(this));\n            }\n        }\n    },\n\n    onLoad : function() {\n        // ty.NotificationCenter.trigger(ddz.EventType.UPDATE_PLAYER_INFO, {pos:'right', type:'leave'});\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_PLAYER_INFO, this._onUpdateInfo, this);\n        ty.NotificationCenter.listen(ddz.EventType.GAME_READY, this._onGameReady, this);\n        ty.NotificationCenter.listen(ddz.EventType.TABLE_INFO_CHAGE, this._tableInfoChange, this);\n        ty.NotificationCenter.listen(ddz.EventType.BUY_CHIP_CHANEG, this._onByInChipChange, this);\n        var backButtonH = ddz.GlobalFuncs.getBackButtonPositionY();\n        if (backButtonH){\n            this.btnBack.node.y = backButtonH;\n        }\n\n        ty.NotificationCenter.listen(ddz.EventType.START_MATCHING, this.startAni, this);\n        ty.NotificationCenter.listen(ddz.EventType.STOP_MATCHING, this.stopAni, this);\n        ty.NotificationCenter.listen(ddz.EventType.REMOVE_TABLE_ANI, this.removeMatching, this);\n        this.matchNode.active = false;\n        // this.startAni();\n        // this.initScore();\n        if(ty.UserInfo.systemType == ty.UserInfo.SYSTEMTYPE.iPhoneXType){\n            var widL = this.jifenLeftNode.getComponent(cc.Widget);\n            widL.top = 160;\n            var widR = this.jifenRightNode.getComponent(cc.Widget);\n            widR.top = 160;\n        }\n    },\n    startAni : function () {\n        ddz.LOGD(\"\",\"file = [GoldModule] fun = [startAni] queueInfo = \" + JSON.stringify(ddz.matchModel.getCurQueueInfo()));\n        if (ddz.matchModel.getCurQueueInfo()) {\n            this.matchNode.active = false;\n        }else {\n            this.matchNode.active = true;\n            var ani = this.matchingNode.getComponent(cc.Animation);\n            var anim = ani.getAnimationState('ddz_matching');\n            anim.play();\n        }\n    },\n    stopAni : function () {\n        var ani = this.matchingNode.getComponent(cc.Animation);\n        ani.stop();\n    },\n    removeMatching : function () {\n        this.matchingNode.removeFromParent();\n    },\n\n    _onByInChipChange:function (seatId) {\n        if (seatId == this._tableScene._mySeatIndex){\n            var mscore = this._tableScene._mySeatinfo.model.m_buyinChip;\n            this.setScore('my', mscore);\n        }\n    },\n\n    _onGameReady:function () {\n        this.matchNode.active = false;\n        ty.NotificationCenter.trigger(ddz.EventType.STOP_MATCHING);\n\n        this._tableScene.showGoldInfo();\n        this.btnBack.node.active = false;\n    },\n\n    _tableInfoChange:function (tableInfo) {\n        this.txtSfee.string = \"本局服务费\" + tableInfo.config.m_sfee;\n    },\n\n    _onUpdateInfo:function (obj) {\n        var mscore = 0;\n        var userPanel;\n        if (obj.pos == 'left'){\n            mscore = this._tableScene._leftSeatinfo.model.m_buyinChip;\n            userPanel = this.jifenLeftNode;\n        }\n        else if (obj.pos == 'right'){\n            mscore = this._tableScene._rightSeatinfo.model.m_buyinChip;\n            userPanel = this.jifenRightNode;\n        }\n        userPanel.active = true;\n        if (obj.type == 'leave'){\n            mscore = 0;\n            userPanel.active = false;\n        }\n        if (obj.type == 'sit'){\n            if(this._tableScene._rightSeatinfo.hasData && this._tableScene._leftSeatinfo.hasData){\n                this._onGameReady();\n            }\n        }\n        this.setScore(obj.pos, mscore);\n    },\n\n    initScore:function () {\n\n        var mscore = this._tableScene._mySeatinfo.model.m_buyinChip;\n        this.setScore('my', mscore);\n\n        mscore = 0;\n        if (this._tableScene._leftSeatinfo.hasData){\n            mscore = this._tableScene._leftSeatinfo.model.m_buyinChip;\n        }\n\n        this.setScore('left', mscore);\n\n        mscore = 0;\n        if (this._tableScene._rightSeatinfo.hasData){\n            mscore = this._tableScene._rightSeatinfo.model.m_buyinChip;\n        }\n        this.setScore('right', mscore);\n    },\n\n    updateAllScore:function (result) {\n\n        var myIndex = this._tableScene._mySeatIndex;\n        var leftindex = ddz.GlobalFuncs.getPreIndex(myIndex);\n        var rightindex = ddz.GlobalFuncs.GetNextIndex(myIndex);\n\n        var checkSeatIsWin = function (seatIndex) {\n            var dizhuWin = result.dizhuwin == 1;\n            var isWin = false;\n            if (seatIndex == result.stat.dizhu){\n                isWin = dizhuWin;\n            }\n            else{\n                isWin = !dizhuWin;\n            }\n            return isWin;\n        };\n\n        var seatInfo = result['seat' + myIndex];\n\n        var score = seatInfo[1];\n        var delta = seatInfo[0];\n\n        this.upDataScore('my', score, delta, checkSeatIsWin(myIndex));\n\n        seatInfo = result['seat' + leftindex];\n\n        score = seatInfo[1];\n        delta = seatInfo[0];\n\n        this.upDataScore('left', score, delta, checkSeatIsWin(leftindex));\n\n        seatInfo = result['seat' + rightindex];\n\n        score = seatInfo[1];\n        delta = seatInfo[0];\n\n        this.upDataScore('right', score, delta, checkSeatIsWin(rightindex));\n    },\n\n    //更新分数\n    upDataScore:function (pos, scroe, delta, isWin) {\n        var lblScoreChange, lblName;\n        var deltaStr = hall.GlobalFuncs.formatGold(delta);\n        if (isWin){\n            deltaStr = \"+\" + deltaStr;\n            lblName = \"lblJiFenChangeAdd\";\n        }\n        else{\n            if (delta == 0){\n                deltaStr = \"-0\";\n            }\n            lblName = \"lblJiFenChange\";\n        }\n\n        switch (pos){\n            case 'my':{\n                lblScoreChange = this.getScoreLabel(this.jifenNode, lblName);\n                break;\n            }\n            case 'left':{\n                lblScoreChange = this.getScoreLabel(this.jifenLeftNode, lblName);\n                break;\n            }\n            case 'right':{\n                lblScoreChange = this.getScoreLabel(this.jifenRightNode, lblName);\n                break;\n            }\n        }\n\n\n        lblScoreChange.string = deltaStr;\n        var that = this;\n        that.setScore(pos, scroe);\n        var callBack = cc.callFunc(function () {\n            lblScoreChange.node.opacity = 255;\n            lblScoreChange.string = \"\";\n        });\n\n        var flyAni = cc.sequence(cc.delayTime(5), cc.fadeOut(0.2), callBack);\n        lblScoreChange.node.runAction(flyAni);\n    },\n\n    reSetAddScore:function () {\n        this.getScoreLabel(this.jifenNode, 'lblJiFenChangeAdd').string = \"\";\n        this.getScoreLabel(this.jifenNode, 'lblJiFenChange').string = \"\";\n\n        this.getScoreLabel(this.jifenLeftNode, 'lblJiFenChangeAdd').string = \"\";\n        this.getScoreLabel(this.jifenLeftNode, 'lblJiFenChange').string = \"\";\n\n        this.getScoreLabel(this.jifenRightNode, 'lblJiFenChangeAdd').string = \"\";\n        this.getScoreLabel(this.jifenRightNode, 'lblJiFenChange').string = \"\";\n    },\n\n    setScore:function (pos, scroe) {\n        var lblScore;\n        switch (pos){\n            case 'my':{\n                lblScore = this.getScoreLabel(this.jifenNode, 'lblJiFen');\n                break;\n            }\n            case 'left':{\n                lblScore = this.getScoreLabel(this.jifenLeftNode, 'lblJiFen');\n                break;\n            }\n            case 'right':{\n                lblScore = this.getScoreLabel(this.jifenRightNode, 'lblJiFen');\n                break;\n            }\n        }\n\n        lblScore.string = hall.GlobalFuncs.formatGold(scroe) +\"\";\n    },\n\n    showResult:function (result) {\n        ddz.LOGD(\"\",\"file = [DdzTableScene] fun = [_startGameOverAnimation] 金币场显示结算界面\");\n        this._tableScene._reset();\n        ty.NotificationCenter.trigger(ddz.EventType.STOP_MATCHING);\n        this.matchNode.active = false;\n        if (!this._gameResult){\n            var game_result_wnd = cc.instantiate(this.game_result);\n            cc.director.getScene().addChild(game_result_wnd);\n            this._gameResult = game_result_wnd.getComponent(\"ddz_game_result\");\n            this._gameResult.setTableScene(this._tableScene);\n        }\n        this._gameResult.show(result);\n\n        var mySeatIndex = this._tableScene._mySeatIndex;\n        if (mySeatIndex == result.stat.dizhu){\n            var saveCardsString =  hall.GlobalFuncs.ReadStringFromLocalStorage(ddz.gameModel.ORIGINCARDS, \"\");\n            var saveCardsDic = JSON.parse(saveCardsString);\n            var cards = saveCardsDic.myCards;\n            var baseCards = saveCardsDic.baseCard;\n            cards = cards.concat(baseCards);\n            var saveDic = {myCards:cards,baseCard:baseCards};\n            hall.GlobalFuncs.setInLocalStorage(ddz.gameModel.ORIGINCARDS, JSON.stringify(saveDic));\n        }\n\n        this.scheduleOnce(function () {\n            if(result.winShare){\n                // ddz.GlobalFuncs.showShareGuideWindow(true,result.winShare.winChip,result.winShare.rewardDoubles,result.winShare.adsCounts);\n                // ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeShowWindow,\n                //     [\"loseTipsWindow\",result.winShare.winChip,result.winShare.rewardDoubles]);\n            }else if(result.loseShare){\n                // ddz.GlobalFuncs.showShareGuideWindow(false,result.loseShare.loseChip,result.loseShare.rewardDoubles,result.loseShare.adsCounts);\n                // ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeShowWindow,\n                //     [\"winTipsWindow\",result.loseShare.loseChip,result.loseShare.rewardDoubles]);\n            }else if(result.winchips){\n                ddz.GlobalFuncs.showShareMomentsItem(\"showy_highTotal\",result.winchips);\n            }else if(result.winstreak){\n                ddz.GlobalFuncs.showShareMomentsItem(\"showy_winningStreak\",result.winstreak);\n            }\n\n            // if(result.winchips){\n            //     ddz.GlobalFuncs.showShareMomentsItem(\"showy_highTotal\",result.winchips);\n            // }else if(result.winstreak){\n            //     ddz.GlobalFuncs.showShareMomentsItem(\"showy_winningStreak\",result.winstreak);\n            // }\n\n        }.bind(this),1);\n    },\n\n    getScoreLabel:function (scoreNode, lblName) {\n        return scoreNode.getChildByName(lblName).getComponent(cc.Label);\n    },\n\n    onDestroy :function () {\n        ty.NotificationCenter.ignoreScope(this);\n        // this.tasksNode.removeAllChildren();\n        this._tableScene = null;\n    },\n\n    reset:function () {\n        this.lblDiFen.string = \"\";\n        this.jifenLeftNode.active = false;\n        this.jifenRightNode.active = false;\n\n        this.matchNode.active = true;\n        ty.NotificationCenter.trigger(ddz.EventType.START_MATCHING);\n\n        var lblScoreChange;\n\n        lblScoreChange = this.getScoreLabel(this.jifenNode, \"lblJiFenChangeAdd\");\n        lblScoreChange.string = \"\";\n        lblScoreChange.node.stopAllActions();\n\n        lblScoreChange = this.getScoreLabel(this.jifenNode, \"lblJiFenChange\");\n        lblScoreChange.string = \"\";\n        lblScoreChange.node.stopAllActions();\n\n        lblScoreChange = this.getScoreLabel(this.jifenLeftNode, \"lblJiFenChangeAdd\");\n        lblScoreChange.string = \"\";\n        lblScoreChange.node.stopAllActions();\n\n        lblScoreChange = this.getScoreLabel(this.jifenLeftNode, \"lblJiFenChange\");\n        lblScoreChange.string = \"\";\n        lblScoreChange.node.stopAllActions();\n\n        lblScoreChange = this.getScoreLabel(this.jifenRightNode, \"lblJiFenChangeAdd\");\n        lblScoreChange.string = \"\";\n        lblScoreChange.node.stopAllActions();\n\n        lblScoreChange = this.getScoreLabel(this.jifenRightNode, \"lblJiFenChange\");\n        lblScoreChange.string = \"\";\n        lblScoreChange.node.stopAllActions();\n\n        this.btnBack.node.active = true;\n    },\n\n    update:function (dt) {\n\n    },\n\n    onBack:function () {\n        ty.NotificationCenter.trigger(ddz.EventType.REMOVE_MATCHING);\n        ty.NotificationCenter.trigger(ddz.EventType.REMOVE_TABLE_ANI);\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.back_button_click_sound, false);\n        var tableinfo = this._tableScene.tableInfo();\n        var _mixID = tableinfo.mixId;\n        var _roomId = tableinfo.roomId();\n        if (!_roomId) {\n            var _queueInfo = ddz.matchModel.getCurQueueInfo();\n            _roomId = _queueInfo.roomId\n        }\n        ddz.MsgFactory.getRoomLeave(_roomId, tableinfo.tableId(), this._tableScene._mySeatIndex, _mixID);\n    }\n});\n"]}
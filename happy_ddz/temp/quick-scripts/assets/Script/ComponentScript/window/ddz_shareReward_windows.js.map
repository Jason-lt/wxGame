{"version":3,"sources":["ddz_shareReward_windows.js"],"names":["cc","Class","extends","Component","properties","tableView","default","type","Node","titleBg","Sprite","titleBgSpriteFrame","SpriteFrame","banner","btnLabel","RichText","jiantou","personalAssets","onLoad","that","scheduleOnce","ani","getComponent","Animation","play","ty","NotificationCenter","listen","ddz","EventType","UPDATE_NEW_REWARD_MASSAGE","updateNewRewardMassage","UPDATE_SHARE_FRIEND_TITLE_STATE","updateTitleBg","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","REMOVE_WINDOW_ANI","onClose","gameModel","checkShareReward","Share","SharePointType","shareFriend","_shareType","onShareType","clickStatShareTypeInviteNewFriend","string","hall","GlobalFuncs","getButtonTitle","seq","sequence","moveTo","p","delayTime","repeatForever","runAction","adManager","destroyWidthBannerAd","canShowListSceneBanner","setPersonalAssets","wimdow","updateInfo","reultType","resultType","isBringVersion","MsgBoxManager","showToast","title","onShareBtn","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeButtonClick","shareWithType","onHelpBox","isClickOpenBox","getOpenBox","requestAnimationFrame","window","setDataArray","inviteNewShowList","leftCount","spriteFrame","onDestroy","ignoreScope","curScene","director","getScene","name","bc","getRoomListBannerConfigJson","trigger","OPEN_BANNER","removeLoopAni","stop","stopAllActions","shut","node","destroy","ddz_shareReward"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAY;AACRC,qBAAU,IADF;AAERC,kBAAOP,GAAGQ;AAFF,SADJ;AAKRC,iBAAU;AACNH,qBAAU,IADJ;AAENC,kBAAOP,GAAGU;AAFJ,SALF;AASRC,4BAAqB,CAACX,GAAGY,WAAJ,CATb;AAURC,gBAAOb,GAAGQ,IAVF;AAWRM,kBAASd,GAAGe,QAXJ;;AAaRC,iBAAQhB,GAAGQ,IAbH;;AAeRS,wBAAiBjB,GAAGQ;;AAfZ,KAHP;;AAsBLU,YAAO,kBAAU;AACb,YAAIC,OAAO,IAAX;AACA,aAAKC,YAAL,CAAkB,YAAY;AAC1B,gBAAIC,MAAMF,KAAKN,MAAL,CAAYS,YAAZ,CAAyBtB,GAAGuB,SAA5B,CAAV;AACAF,gBAAIG,IAAJ,CAAS,SAAT;AACH,SAHD,EAGG,CAHH;AAIAC,WAAGC,kBAAH,CAAsBC,MAAtB,CAA6BC,IAAIC,SAAJ,CAAcC,yBAA3C,EAAsE,KAAKC,sBAA3E,EAAmG,IAAnG;AACAN,WAAGC,kBAAH,CAAsBC,MAAtB,CAA6BC,IAAIC,SAAJ,CAAcG,+BAA3C,EAA4E,KAAKC,aAAjF,EAAgG,IAAhG;AACAR,WAAGC,kBAAH,CAAsBC,MAAtB,CAA6BC,IAAIC,SAAJ,CAAcK,kBAA3C,EAA+D,KAAKC,+BAApE,EAAqG,IAArG;AACAV,WAAGC,kBAAH,CAAsBC,MAAtB,CAA6BC,IAAIC,SAAJ,CAAcO,iBAA3C,EAA8D,KAAKC,OAAnE,EAA4E,IAA5E;AACAT,YAAIU,SAAJ,CAAcC,gBAAd,CAA+BX,IAAIY,KAAJ,CAAUC,cAAV,CAAyBC,WAAxD;;AAEA,YAAIC,aAAaf,IAAIY,KAAJ,CAAUI,WAAV,CAAsBC,iCAAvC;AACA,aAAK/B,QAAL,CAAcgC,MAAd,GAAuB,oBAAmBC,KAAKC,WAAL,CAAiBC,cAAjB,CAAgCN,UAAhC,CAAnB,GAAgE,MAAvF;;AAGA,YAAIO,MAAMlD,GAAGmD,QAAH,CAAanD,GAAGoD,MAAH,CAAU,GAAV,EAAepD,GAAGqD,CAAH,CAAK,GAAL,EAAU,CAAV,CAAf,CAAb,EAA2CrD,GAAGsD,SAAH,CAAa,GAAb,CAA3C,EAA6DtD,GAAGoD,MAAH,CAAU,GAAV,EAAepD,GAAGqD,CAAH,CAAK,GAAL,EAAU,CAAV,CAAf,CAA7D,EAA2FE,aAA3F,EAAV;AACA,aAAKvC,OAAL,CAAawC,SAAb,CAAuBN,GAAvB;;AAEAH,aAAKU,SAAL,CAAeC,oBAAf;AACAX,aAAKU,SAAL,CAAeE,sBAAf,GAAwC,KAAxC;;AAEA,aAAKC,iBAAL;AACH,KA7CI;;AA+CLA,uBAAkB,6BAAY;AAC1B;AACA,YAAIC,SAAS,KAAK5C,cAAL,CAAoBK,YAApB,CAAiC,gBAAjC,CAAb;AACAuC,eAAOC,UAAP;AACH,KAnDI;;AAqDL3B,qCAAkC,yCAAU5B,IAAV,EAAgB;AAC9C,YAAIA,QAAQA,QAAQqB,IAAIY,KAAJ,CAAUI,WAAV,CAAsBC,iCAA1C,EAA6E;AACzE;AACH;AACD,YAAIkB,YAAYnC,IAAIY,KAAJ,CAAUwB,UAA1B;AACA,gBAAQD,SAAR;AACI,iBAAK,CAAL;AACI,oBAAI,CAACnC,IAAIU,SAAJ,CAAc2B,cAAnB,EAAmC;AAC/BlB,yBAAKmB,aAAL,CAAmBC,SAAnB,CAA6B,EAACC,OAAQ,WAAT,EAA7B;AACH;AACD;AACJ,iBAAK,CAAL;AACI,oBAAI,CAACxC,IAAIU,SAAJ,CAAc2B,cAAnB,EAAmC;AAC/BlB,yBAAKmB,aAAL,CAAmBC,SAAnB,CAA6B,EAACC,OAAQ,cAAT,EAA7B;AACH;AACD;AACJ,iBAAK,CAAL;;AAEI;AACJ;AACI;AAfR;;AAkBAxC,YAAIY,KAAJ,CAAUwB,UAAV,GAAuB,CAAvB;AACH,KA7EI;;AA+ELK,gBAAW,sBAAU;AACjB5C,WAAG6C,KAAH,CAASC,SAAT,CAAmB9C,GAAG+C,QAAH,CAAYC,kBAAZ,CAA+BC,6BAAlD,EACI,CAAC,oBAAD,CADJ;AAEA9C,YAAIY,KAAJ,CAAUmC,aAAV,CAAwB/C,IAAIY,KAAJ,CAAUI,WAAV,CAAsBC,iCAA9C;AACH,KAnFI;;AAqFL+B,eAAU,qBAAU;AAChBhD,YAAIiD,cAAJ,GAAqB,IAArB;AACAjD,YAAIU,SAAJ,CAAcwC,UAAd;AACH,KAxFI;;AA0FL;AACA/C,4BAAyB,kCAAY;AACjC,YAAIZ,OAAO,IAAX;AACA4D,8BAAsB,YAAU;AAC5B,gBAAIC,SAAS7D,KAAKd,SAAL,CAAeiB,YAAf,CAA4B,eAA5B,CAAb;AACA0D,mBAAOC,YAAP,CAAoBrD,IAAIU,SAAJ,CAAc4C,iBAAlC;AACH,SAHD;AAIH,KAjGI;;AAmGLjD,mBAAc,uBAASkD,SAAT,EAAmB;AAC7B,YAAIA,aAAa,CAAjB,EAAoB;AAChB,iBAAK1E,OAAL,CAAa2E,WAAb,GAA2B,KAAKzE,kBAAL,CAAwB,CAAxB,CAA3B;AACH,SAFD,MAEM;AACF,iBAAKF,OAAL,CAAa2E,WAAb,GAA2B,KAAKzE,kBAAL,CAAwB,CAAxB,CAA3B;AACH;AACJ,KAzGI;;AA2GL0E,eAAY,qBAAY;AACpB5D,WAAGC,kBAAH,CAAsB4D,WAAtB,CAAkC,IAAlC;AACA,YAAIC,WAAWvF,GAAGwF,QAAH,CAAYC,QAAZ,EAAf;AACA,YAAIF,SAASG,IAAT,IAAiB,eAAjB,IAAoCH,SAASG,IAAT,IAAiB,gBAAzD,EAA2E;AACvE,gBAAIC,KAAK/D,IAAIU,SAAJ,CAAcsD,2BAAd,EAAT;AACA,gBAAID,EAAJ,EAAQ;AACJlE,mBAAGC,kBAAH,CAAsBmE,OAAtB,CAA8BjE,IAAIC,SAAJ,CAAciE,WAA5C,EAAyDH,EAAzD;AACH;AACJ;AACJ,KApHI;;AAsHLI,mBAAc,yBAAY;AACtB,YAAI1E,MAAM,KAAKR,MAAL,CAAYS,YAAZ,CAAyBtB,GAAGuB,SAA5B,CAAV;AACAF,YAAI2E,IAAJ;AACA,aAAKhF,OAAL,CAAaiF,cAAb;AACH,KA1HI;;AA4HLC,UAAK,gBAAY;AACb,aAAKH,aAAL;AACA,aAAKI,IAAL,CAAUC,OAAV;AACH,KA/HI;;AAiIL/D,aAAQ,mBAAU;AACd,aAAK6D,IAAL;AACAtE,YAAIyE,eAAJ,GAAsB,IAAtB;AACH;;AApII,CAAT","file":"ddz_shareReward_windows.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        tableView : {\n            default : null,\n            type : cc.Node\n        },\n        titleBg : {\n            default : null,\n            type : cc.Sprite\n        },\n        titleBgSpriteFrame : [cc.SpriteFrame],\n        banner:cc.Node,\n        btnLabel:cc.RichText,\n\n        jiantou:cc.Node,\n\n        personalAssets : cc.Node,\n\n    },\n\n    onLoad:function(){\n        var that = this;\n        this.scheduleOnce(function () {\n            var ani = that.banner.getComponent(cc.Animation);\n            ani.play('btnTick');\n        }, 1);\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_NEW_REWARD_MASSAGE, this.updateNewRewardMassage, this);\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_FRIEND_TITLE_STATE, this.updateTitleBg, this);\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n        ty.NotificationCenter.listen(ddz.EventType.REMOVE_WINDOW_ANI, this.onClose, this);\n        ddz.gameModel.checkShareReward(ddz.Share.SharePointType.shareFriend);\n\n        var _shareType = ddz.Share.onShareType.clickStatShareTypeInviteNewFriend;\n        this.btnLabel.string = \"<color=#E54D42>\"+ hall.GlobalFuncs.getButtonTitle(_shareType) +\"</c>\";\n\n\n        var seq = cc.sequence( cc.moveTo(0.5, cc.p(230, 0)), cc.delayTime(0.5),cc.moveTo(0.5, cc.p(250, 0))).repeatForever();\n        this.jiantou.runAction(seq);\n\n        hall.adManager.destroyWidthBannerAd();\n        hall.adManager.canShowListSceneBanner = false;\n\n        this.setPersonalAssets();\n    },\n\n    setPersonalAssets:function () {\n        // 个人财产信息\n        var wimdow = this.personalAssets.getComponent(\"personalAssets\");\n        wimdow.updateInfo();\n    },\n\n    playAnimationAfterShareWithType : function (type) {\n        if (type && type != ddz.Share.onShareType.clickStatShareTypeInviteNewFriend) {\n            return;\n        }\n        var reultType = ddz.Share.resultType;\n        switch (reultType) {\n            case 1:\n                if (!ddz.gameModel.isBringVersion) {\n                    hall.MsgBoxManager.showToast({title : '请分享到微信群哦~'});\n                }\n                break;\n            case 2:\n                if (!ddz.gameModel.isBringVersion) {\n                    hall.MsgBoxManager.showToast({title : '请不要频繁分享到一个群~'});\n                }\n                break;\n            case 3:\n\n                break;\n            default:\n                break;\n        }\n\n        ddz.Share.resultType = 0;\n    },\n\n    onShareBtn:function(){\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"diamondShareFriend\"]);\n        ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeInviteNewFriend);\n    },\n\n    onHelpBox:function(){\n        ddz.isClickOpenBox = true;\n        ddz.gameModel.getOpenBox();\n    },\n\n    //邀请新人得钻石\n    updateNewRewardMassage : function () {\n        var that = this;\n        requestAnimationFrame(function(){\n            var window = that.tableView.getComponent('ddz_tableView');\n            window.setDataArray(ddz.gameModel.inviteNewShowList);\n        });\n    },\n\n    updateTitleBg:function(leftCount){\n        if (leftCount == 0) {\n            this.titleBg.spriteFrame = this.titleBgSpriteFrame[1];\n        }else {\n            this.titleBg.spriteFrame = this.titleBgSpriteFrame[0];\n        }\n    },\n\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n        var curScene = cc.director.getScene();\n        if (curScene.name == \"RoomListScene\" || curScene.name == \"MatchListScene\") {\n            var bc = ddz.gameModel.getRoomListBannerConfigJson();\n            if (bc) {\n                ty.NotificationCenter.trigger(ddz.EventType.OPEN_BANNER, bc);\n            }\n        }\n    },\n\n    removeLoopAni:function () {\n        var ani = this.banner.getComponent(cc.Animation);\n        ani.stop();\n        this.jiantou.stopAllActions();\n    },\n\n    shut:function () {\n        this.removeLoopAni();\n        this.node.destroy();\n    },\n\n    onClose:function(){\n        this.shut();\n        ddz.ddz_shareReward = null;\n    },\n\n});\n"]}
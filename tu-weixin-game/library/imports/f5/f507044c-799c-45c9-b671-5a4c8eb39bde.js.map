{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/Scenes/assets/Script/ComponentScript/Scenes/MatchListScene.js"],"names":["cc","Class","extends","Component","properties","backButton","default","type","Button","tableView","Node","scrollView","ScrollView","personalAssets","colorbgOver","ddz_cell_matchlist","Prefab","match_enter","leftCellX","rightCellX","onLoad","ddz","GlobalFuncs","drawGameCanvas","cellHeight","backButtonH","getBackButtonPositionY","node","y","content","ty","NotificationCenter","listen","EventType","ASYNC_COMMON_ARENA_MATCH","onMatchList","UPDATE_MATCH_DES","showMatchInfo","SHOW_MATCHING","showColorBgOver","CLICK_MATCHING_ITEM","onClickMatchItem","OPEN_BANNER","playBanner","hall","MsgFactory","getArenaMatchList","SystemInfo","gameId","setPersonalAssets","bc","gameModel","getRoomListBannerConfigJson","winnerCount","matchModel","getCurWinnerCount","start","pw","getComponent","Widget","bottom","sw","adManager","canShowListSceneBanner","showBannerAd","delay","Timer","setTimer","showAllWidthBannerAd","matchId","clickedMatchId","active","matchInfo","AudioHelper","playEffect","EffectPath_mp3","button_click_sound","nofityW","instantiate","addChild","window","updateByMatchData","matchList","key","ME","matchArray","push","updateRoomList","roomInfo","removeAllChildren","height","length","i","cell","com","addDataWithObject","x","wimdow","updateInfo","backAction","LOGD","back_button_click_sound","sceneName","popScene","onDestroy","ignoreScope","destroyWidthBannerAd"],"mappings":"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","file":"MatchListScene.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/Scenes","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        backButton : {\n            default : null,\n            type : cc.Button\n        },\n        tableView : {\n            default : null,\n            type : cc.Node\n        },\n\n        scrollView : {\n            default : null,\n            type : cc.ScrollView\n        },\n\n        personalAssets : {\n            default : null,\n            type : cc.Node\n        },\n\n        colorbgOver: {\n            default : null,\n            type : cc.Node\n        },\n\n        ddz_cell_matchlist:cc.Prefab,\n        match_enter: cc.Prefab,\n\n        leftCellX:-275,\n        rightCellX:275,\n    },\n\n    onLoad:function () {\n        ddz.GlobalFuncs.drawGameCanvas();\n        this.cellHeight = 170;\n        var backButtonH = ddz.GlobalFuncs.getBackButtonPositionY();\n        if (backButtonH){\n            this.backButton.node.y = backButtonH;\n        }\n        this.content = this.scrollView.content;\n        ty.NotificationCenter.listen(ddz.EventType.ASYNC_COMMON_ARENA_MATCH, this.onMatchList, this);\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_MATCH_DES, this.showMatchInfo, this);\n        ty.NotificationCenter.listen(ddz.EventType.SHOW_MATCHING, this.showColorBgOver, this);\n        ty.NotificationCenter.listen(ddz.EventType.CLICK_MATCHING_ITEM, this.onClickMatchItem, this);\n        ty.NotificationCenter.listen(ddz.EventType.OPEN_BANNER, this.playBanner, this);\n        // 请求房间列表\n        hall.MsgFactory.getArenaMatchList(ty.SystemInfo.gameId);\n        this.setPersonalAssets();\n\n        var bc = ddz.gameModel.getRoomListBannerConfigJson();\n        if (bc) {\n            this.playBanner(bc);\n        }\n        // hall.adManager.hideAd();\n    },\n\n    playBanner:function(bc){\n        var winnerCount = ddz.matchModel.getCurWinnerCount();\n        if (bc.start) {\n            if (winnerCount >= bc.start) {\n                var pw = this.personalAssets.getComponent(cc.Widget);\n                pw.bottom = 265;\n\n                var sw = this.scrollView.getComponent(cc.Widget);\n                sw.bottom = 494;\n                hall.adManager.canShowListSceneBanner = true;\n                this.showBannerAd();\n                if (bc.delay && bc.delay > 0) {\n                    ty.Timer.setTimer(this, this.showBannerAd, bc.delay);\n                }\n            }\n        }else {\n            var pw = this.personalAssets.getComponent(cc.Widget);\n            pw.bottom = 265;\n\n            var sw = this.scrollView.getComponent(cc.Widget);\n            sw.bottom = 494;\n            hall.adManager.canShowListSceneBanner = true;\n            this.showBannerAd();\n            if (bc.delay && bc.delay > 0) {\n                ty.Timer.setTimer(this, this.showBannerAd, bc.delay);\n            }\n        }\n    },\n\n    showBannerAd:function(){\n        hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n    },\n\n    onClickMatchItem: function(matchId) {\n        this.clickedMatchId = matchId;\n    },\n\n    showColorBgOver: function() {\n        this.colorbgOver.active = true;\n    },\n\n    showMatchInfo: function(matchInfo) {\n        if(this.clickedMatchId != matchInfo.matchId) {\n            return;\n        }\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.button_click_sound, false);\n        var nofityW = cc.instantiate(this.match_enter);\n        this.node.addChild(nofityW);\n        var window = nofityW.getComponent('ddz_window_match_enter');\n        window.updateByMatchData(matchInfo);\n        this.clickedMatchId = -1;\n    },\n\n    onMatchList:function () {\n        var matchList = [];\n        for(var key in hall.ME.matchInfo.matchArray) {\n            matchList.push(hall.ME.matchInfo.matchArray[key]);\n        }\n        this.updateRoomList(matchList);\n    },\n\n    updateRoomList:function (roomInfo) {\n        this.content.removeAllChildren();\n        this.content.height = roomInfo.length * this.cellHeight;\n        if (roomInfo.length > 0) {\n            for (var i = 0; i < roomInfo.length; i++) {\n                var cell = cc.instantiate(this.ddz_cell_matchlist);\n                var com = cell.getComponent('ddz_cell_matchlist');\n                com.addDataWithObject(roomInfo[i]);\n                cell.x = 0;\n                cell.y = - i * this.cellHeight - (this.cellHeight / 2);\n                this.content.addChild(cell);\n            }\n        }\n    },\n\n    setPersonalAssets:function () {\n        // 个人财产信息\n        var wimdow = this.personalAssets.getComponent(\"personalAssets\");\n        wimdow.updateInfo();\n    },\n\n    backAction : function () {\n        ddz.LOGD(null, \"file = [RoomListScene] fun = [backAction]\");\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.back_button_click_sound, false);\n        var sceneName = 'Ddz';\n        // cc.director.loadScene(sceneName);\n        hall.GlobalFuncs.popScene();\n    },\n\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n        hall.adManager.destroyWidthBannerAd();\n    },\n\n});\n"]}
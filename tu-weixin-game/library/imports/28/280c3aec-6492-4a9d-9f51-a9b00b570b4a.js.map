{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/Scenes/assets/Script/ComponentScript/Scenes/Ddz.js"],"names":["console","log","cc","Class","extends","Component","properties","_TAG","bg","Node","mainScene","loadingNode","default","type","lblVersion","Label","topUpButton","Button","completeType","nodeAuthorizationFailed","Sprite","lblTimer","ctor","rendererWebGL","_clearColor","r","g","b","a","onShowAuthorizationFailed","node","active","timeCount","string","that","tickFun","wx","openSetting","ty","Timer","cancelTimer","setTimer","onHideDdzMain","ddz","LOGD","onLoad","GlobalFuncs","drawGameCanvas","mainW","getComponent","parentScene","isAction","NotificationCenter","listen","EventType","TCP_OPENED","onReciveHallInfo","START_AUTHORIZATION_FAILED","HIDE_DDZ_MAIN","GET_USER_INFO","onGetUserInfo","WX_LOGIN_SUCCESS","onWxLoginSuccess","MSG_LOGIN_SUCCESS","onUserSDKLoginSuccess","replace","SystemInfo","version","UserInfo","systemType","SYSTEMTYPE","ANDROIDOther","ANDROIDVIVO85","hall","adManager","showAdIco","getSetting","success","res","authSetting","loginBtnManager","showHideAuthorizeBtn","giftBtnClick","showFailMsg","MsgBoxManager","showToast","title","BiLog","clickStat","clickStatEventType","clickStatEventTypeResourceDownloadFail","fs","getFileSystemManager","filePath","env","USER_DATA_PATH","preLogin","access","path","hasRes","checkLoading","fail","showLoading","clickStatEventTypeResourceDownload","remoteFilePath","cdnPath","remotePackPath","downloadFile","url","tempFilePath","statusCode","LOGE","saveFile","unzip","zipFilePath","targetPath","clickStatEventTypeResourceDownloadSuccess","unlinkSync","needLoadRemoteRes","checkNeedLoadRemoteRes","hasOwnProperty","updateManager","getUpdateManager","onCheckForUpdate","hasUpdate","onUpdateReady","showModal","content","confirm","applyUpdate","onUpdateFailed","clickStatEventTypeNewVersionDownloadFail","checkVideoAd","GET_AD_MSG_SUCCESS","showCrossButton","destroyTableBtn","initAdManager","AdManagerTYWX","init","GET_ADMANAGER_ICON_INFO_SUCCESS","createCrossButton","size","director","getWinSize","getAdNodeByTag","showAdNode","showAd","x","width","y","height","_isAdManagerCreated","scheduleOnce","getAdMsg","winSize","wxLoginCode","getOpenData","TuyooSDK","loginWithOutAuthorization","login","clickStatEventTypeLoadingUI","loadingAction","userId","unLoadingAction","matchModel","matchUpdate","needShowLoading","setLocalZOrder","enterTable","animation","Animation","play","startAnimationWithType","event","clickStatEventTypeButtonClick","TCP","connectStatus","CONNECT_STATUS_OK","AudioHelper","playEffect","EffectPath_mp3","button_click_sound","ACTION_ENTER_TABLE","chooseActionForType","once","completeAni","getChildByName","onDetailButton","isInBSGS","gameModel","isNewUser","bc","getSkipCustomsConfigJson","oldCustoms","curWaitInfo","getCurWaitInfo","stageIndex","continuousLogin","ReadStringFromLocalStorage","CONTINUOUSLOGIN","yesterdayShare","YESTERDAYSHARE","onSkipCustom","startMatchProgress","onEnterFriend","gotoRoomListScene","onMatchListButton","onRankButton","isClickShareReward","getDayInviteReward","isClickOpenBox","getOpenBox","onGetRewardButton","canShowUserInfoBtn","onlyAuthorizeAndLogin","showPopWinByPreFab","preFabNode","sceneName","onLaunched","pushScene","logicScene","getScene","no","children","window","showRankListForShare","update","dt","onDestroy","hideAdNode","ignoreScope","destroyHideBtn"],"mappings":"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","file":"Ddz.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/Scenes","sourcesContent":["console.log(\"Ddz loaded\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _TAG : 'Ddz.js',\n        bg : cc.Node,\n        mainScene : cc.Node,\n        // windowCreateRoom : {\n        //     default : null,\n        //     type : cc.Prefab\n        // },\n        loadingNode : {\n            default : null,\n            type : cc.Node\n        },\n        lblVersion: cc.Label,\n\n        topUpButton : cc.Button,\n\n        completeType : '',\n        nodeAuthorizationFailed:cc.Sprite,\n        lblTimer : cc.Label\n    },\n\n    ctor : function () {\n        cc.rendererWebGL._clearColor =  {\n            r: 21/255,\n            g: 173/255,\n            b: 163/255,\n            a: 1\n        };\n    },\n\n    onShowAuthorizationFailed:function () {\n        this.nodeAuthorizationFailed.node.active = true;\n        var timeCount = 3;\n        this.lblTimer.string = timeCount+\"\";\n        var that = this;\n        var tickFun = function () {\n            timeCount--;\n            that.lblTimer.string = timeCount+\"\";\n            if (timeCount <= 0){\n                that.nodeAuthorizationFailed.node.active = false;\n                that.lblTimer.string = \"3\";\n                wx.openSetting();\n                ty.Timer.cancelTimer(this, tickFun);\n            }\n        };\n\n        ty.Timer.setTimer(this, tickFun, 1, 3);\n    },\n\n    onHideDdzMain:function(){\n        if (this.mainScene) {\n            ddz.LOGD(\"\",\"file = [Ddz] fun = [onHideDdzMain]\");\n            this.mainScene.active = false;\n        }\n    },\n\n    \n    // use this for initialization\n    onLoad: function () {\n        ddz.GlobalFuncs.drawGameCanvas();\n\n        var mainW = this.mainScene.getComponent(\"ddz_main\");\n        mainW.parentScene = this;\n        this.isAction = false;\n\n        ty.NotificationCenter.listen(ty.EventType.TCP_OPENED, this.onReciveHallInfo, this);\n        ty.NotificationCenter.listen(ddz.EventType.START_AUTHORIZATION_FAILED, this.onShowAuthorizationFailed, this);\n        ty.NotificationCenter.listen(ddz.EventType.HIDE_DDZ_MAIN, this.onHideDdzMain, this);\n        ty.NotificationCenter.listen(ddz.EventType.GET_USER_INFO, this.onGetUserInfo, this);\n        ty.NotificationCenter.listen(ty.EventType.WX_LOGIN_SUCCESS, this.onWxLoginSuccess, this);\n        ty.NotificationCenter.listen(ty.EventType.MSG_LOGIN_SUCCESS, this.onUserSDKLoginSuccess, this);\n\n        this.lblVersion.string = this.lblVersion.string.replace(\"{version}\", ty.SystemInfo.version);\n\n        if(ty.UserInfo.systemType == ty.UserInfo.SYSTEMTYPE.ANDROIDOther ||\n            ty.UserInfo.systemType == ty.UserInfo.SYSTEMTYPE.ANDROIDVIVO85){\n            this.topUpButton.node.active = false;\n        }\n        hall.adManager.showAdIco();\n\n        var that = this;\n        this.onWxLoginSuccess();\n\n        wx.getSetting({\n            success:function(res) {\n                if (!res.authSetting['scope.userInfo']) {\n                    //把授权按钮显示在礼包位置\n                    hall.loginBtnManager.showHideAuthorizeBtn(ddz.GlobalFuncs.giftBtnClick);\n                }\n            }\n        });\n\n        var showFailMsg = function () {\n            hall.MsgBoxManager.showToast({title : '资源加载失败!请重启游戏再试!'});\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeResourceDownloadFail, [\"Ddz\"]);\n        };\n\n        var fs = wx.getFileSystemManager();\n\n        var filePath = wx.env.USER_DATA_PATH + '/res.zip';\n\n        var preLogin = function () {\n            //检查本地是否有加载过远程资源\n            fs.access({\n                path: filePath,\n                success: function () {\n                    ty.hasRes = true;\n                    that.checkLoading();\n                },\n                fail: function (res) {\n\n                    that.showLoading();\n                    ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeResourceDownload, [\"Ddz\"]);\n                    //下载文件,并解压\n                    var remoteFilePath = ty.SystemInfo.cdnPath + ty.SystemInfo.remotePackPath;\n                    ddz.LOGD(null, \"remote res path:\" + remoteFilePath);\n                    wx.downloadFile({\n                        url: remoteFilePath,\n                        success: function (res) {\n                            var tempFilePath = res.tempFilePath;\n                            if (res.statusCode === 404) {\n                                hall.LOGE(null, \"Download file failed: \" + remoteFilePath);\n                                //下载失败\n                                showFailMsg();\n                            }\n                            else if (tempFilePath) {\n                                wx.saveFile({\n                                    tempFilePath: tempFilePath,\n                                    filePath: filePath,\n                                    success: function (res) {\n                                        //解压文件\n                                        fs.unzip({\n                                            zipFilePath : filePath,\n                                            targetPath : wx.env.USER_DATA_PATH + \"/\",\n                                            success : function (res) {\n                                                ty.hasRes = true;\n                                                that.checkLoading();\n                                                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeResourceDownloadSuccess, [\"Ddz\"]);\n                                            },\n                                            fail : function (res) {\n                                                fs.unlinkSync(filePath);\n                                                showFailMsg();\n                                            }\n                                        });\n\n                                        //删除临时文件\n                                        fs.unlinkSync(tempFilePath);\n                                    },\n                                    fail: function (res) {\n                                        showFailMsg();\n                                    }\n                                });\n                            }\n                        },\n                        fail: function (res) {\n                            showFailMsg();\n                        }\n                    })\n                }\n            });\n        };\n\n        var needLoadRemoteRes = hall.GlobalFuncs.checkNeedLoadRemoteRes();\n        if (needLoadRemoteRes){\n            //版本发生变更,删除本地缓存文件\n            ddz.LOGD(null, \"version is changed ,need load remote res....\");\n\n            fs.access({\n                path: filePath,\n                success: function () {\n                    fs.unlinkSync(filePath);\n                    preLogin();\n                },\n                fail:function () {\n                    preLogin();\n                }\n            });\n        }\n        else{\n            preLogin();\n        }\n\n        if (wx.hasOwnProperty(\"getUpdateManager\")){\n            var updateManager = wx.getUpdateManager();\n\n            updateManager.onCheckForUpdate(function (res) {\n                // 请求完新版本信息的回调\n                ddz.LOGD(null, res.hasUpdate)\n            });\n\n            updateManager.onUpdateReady(function () {\n                wx.showModal({\n                    title: '更新提示',\n                    content: '新版本已经准备好，是否重启应用？',\n                    success: function (res) {\n                        if (res.confirm) {\n                            fs.unlinkSync(filePath); //删除本地资源文件\n                            // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启\n                            updateManager.applyUpdate()\n                        }\n                    }\n                })\n\n            });\n\n            updateManager.onUpdateFailed(function () {\n                // 新的版本下载失败\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeNewVersionDownloadFail, [\"Ddz\"]);\n            });\n        }\n        \n        hall.adManager.checkVideoAd(); //Load广告\n        \n        // this.getAdMsg();\n        ty.NotificationCenter.listen(ty.EventType.GET_AD_MSG_SUCCESS,this.showCrossButton,this);\n\n        hall.loginBtnManager.destroyTableBtn();\n        this.initAdManager();\n        this.showCrossButton();\n    },\n\n    initAdManager:function(){\n        if(hall && hall.AdManagerTYWX){\n            hall.AdManagerTYWX.init();\n            ty.NotificationCenter.listen(ty.EventType.GET_ADMANAGER_ICON_INFO_SUCCESS, this.createCrossButton, this);\n        }\n    },\n\n    createCrossButton: function(){\n        if(hall && hall.AdManagerTYWX){\n            var size = cc.director.getWinSize();\n\n            // hall.AdManagerTYWX.showAd(cc.p(posX, posY));\n            if (hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\")) {\n                hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\").showAdNode();\n            }else {\n                hall.AdManagerTYWX.showAd({x:size.width - 80,y:size.height/2 + 50},\"myFirstAdNode\");\n            }\n\n            this._isAdManagerCreated = true;\n        }\n    },\n\n    showCrossButton: function(){\n        if(hall && hall.AdManagerTYWX){\n            if(this._isAdManagerCreated){\n                // if(Global.mainLayer != null || Global.rankLayer != null){\n                //     return;\n                // }\n                if (hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\")) {\n                    hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\").showAdNode();\n                }\n\n            }else{\n                this.scheduleOnce(this.showCrossButton, 1)\n            }\n        }\n    },\n\n    getAdMsg : function () {\n        var winSize = cc.director.getWinSize();\n        // hall.adManager.showAd({x:80,y:winSize.height/2});\n        hall.AdManagerTYWX.showAd({x:80,y:winSize.height/2},\"myFirstAdNode\");\n\n        // hall.adManager.showAd({x:100,y:100});\n    },\n\n    onUserSDKLoginSuccess:function () {\n        this.checkLoading();\n    },\n\n    onWxLoginSuccess:function () {\n        if (ty.wxLoginCode){\n            //如果已经登录成功了,就检查授权\n            var that = this;\n            wx.getSetting({\n                success:function(res) {\n                    if (!res.authSetting['scope.userInfo']) {\n                        //没有授权过,需要显示授权按钮\n                        that.showLoading();\n                        if (!ddz.GlobalFuncs.getOpenData(true)){\n                            //不能使用开放数据域的版本,还是需要使用原来的方式\n                            // hall.loginBtnManager.showLoginBtn();\n                            ddz.LOGD(\"\",\"file = [Ddz] fun = [onWxLoginSuccess] 111\");\n                            ty.TuyooSDK.loginWithOutAuthorization(ty.wxLoginCode);\n                        }\n                        else{\n                            ty.TuyooSDK.loginWithOutAuthorization(ty.wxLoginCode);\n                            ddz.LOGD(\"\",\"file = [Ddz] fun = [onWxLoginSuccess] 222\");\n                        }\n                        //把授权按钮显示在礼包位置\n                    }\n                    else{\n                        // ty.wxUserInfo = true;\n                        // that.onGetUserInfo(res);\n                        // 已经授权的,直接登录\n                        ddz.LOGD(\"\",\"file = [Ddz] fun = [onWxLoginSuccess] 已经授权,直接登录\");\n                        ty.TuyooSDK.login();\n                    }\n                }\n            });\n        }\n    },\n\n    showLoading : function () {\n        // if(!debugMode){\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeLoadingUI, [\"Ddz\"]);\n            this.loadingAction();\n        // }\n    },\n\n    // checkLogin:function () {\n    //     if (!ty.UserInfo.userId){\n    //         //TODO:加载页\n    //         // if (ty.wxUserInfo && ty.hasRes){\n    //         //     this.showLoading();\n    //         //     //用户授权并且资源加载完成,进行登录\n    //         //     ty.TuyooSDK.login();\n    //         // }\n    //     }else {\n    //         this.unLoadingAction();\n    //         ddz.matchModel.matchUpdate();\n    //     }\n    // },\n\n    checkLoading:function () {\n        if (ty.UserInfo.userId && ty.hasRes){\n            this.unLoadingAction();\n            ddz.matchModel.matchUpdate();\n        }\n    },\n\n    onGetUserInfo:function (needShowLoading) {\n        hall.LOGE(\"\",\"file = [Ddz] fun = [onGetUserInfo]\")\n        if (needShowLoading){\n            this.showLoading();\n        }\n        ty.TuyooSDK.login();\n    },\n\n    loadingAction : function () {\n        var mainW = this.mainScene.getComponent(\"ddz_main\");\n        mainW.loadingAction();\n        this.loadingNode.active = true;\n        this.loadingNode.setLocalZOrder(999999);\n    },\n    unLoadingAction : function () {\n        var mainW = this.mainScene.getComponent(\"ddz_main\");\n        mainW.unLoadingAction();\n        this.loadingNode.active = false;\n        if(ty.UserInfo.systemType == ty.UserInfo.SYSTEMTYPE.ANDROIDOther ||\n            ty.UserInfo.systemType == ty.UserInfo.SYSTEMTYPE.ANDROIDVIVO85){\n            this.topUpButton.node.active = false;\n        }\n    },\n\n    //播放消失动画\n    enterTable: function () {\n        var animation = this.mainScene.getComponent(cc.Animation);\n        animation.play('ddz_main_xiaoshi');\n        // this.startAnimationWithType(null,\"start\");\n    },\n\n    startAnimationWithType : function (event, type) {\n        //按钮打点\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick, [type]);\n        // 控制短时间内不能二次响应\n        if (this.isAction){return}\n        this.isAction = true;\n        var that = this;\n        ty.Timer.setTimer(this, function(){\n            that.isAction = false;\n        }, 0.6, 1, 0);\n        //判断网络状态是否可以响应按钮事件\n        // if(!debugMode){\n            if (ty.TCP.connectStatus != ty.TCP.CONNECT_STATUS_OK){\n                hall.MsgBoxManager.showToast({title : \"正在登录，请稍候\"});\n                ddz.LOGD(null, \"TCP is not ok! Please wait!\");\n                return;\n            }\n        // }\n\n        this.completeType = type;\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.button_click_sound, false);\n        //有关开始游戏的事件处理暂时不播放消失动画,直接进行事件处理\n        if(type == \"begin\" || type == 'friend' ||type == 'gold' || type == 'match'|| type == 'giftBag' || type == 'helpBox'){\n            ty.NotificationCenter.listen(ddz.EventType.ACTION_ENTER_TABLE,this.enterTable,this);//进入牌桌前播放消失动画\n            this.chooseActionForType();\n            return;\n        }\n        if (type == \"diamondNew\" || type == \"diamondInvite\"){\n            this.chooseActionForType();\n        }else {\n            var animation = this.mainScene.getComponent(cc.Animation);\n            animation.once('finished', this.completeAni,this);\n            animation.play('ddz_main_xiaoshi');\n        }\n    },\n    completeAni : function () {\n        this.node.getChildByName('ddz_main').active = false; //防止出场动画播放完成后,按钮还可以点的BUG.\n        this.chooseActionForType();\n    },\n    chooseActionForType : function () {\n        var type = this.completeType;\n        switch (type){\n            case 'detail':{\n                this.onDetailButton();\n                break;\n            }\n            case 'begin':{\n                if (!ty.UserInfo.isInBSGS && !ddz.gameModel.isNewUser) {\n                    var bc = ddz.gameModel.getSkipCustomsConfigJson();\n                    if (bc && bc.oldCustoms > 0) {\n                        var curWaitInfo = ddz.matchModel.getCurWaitInfo();\n                        if (!curWaitInfo || curWaitInfo.stageIndex < bc.oldCustoms){\n                            var continuousLogin = hall.GlobalFuncs.ReadStringFromLocalStorage(ddz.gameModel.CONTINUOUSLOGIN, false);\n                            var yesterdayShare = hall.GlobalFuncs.ReadStringFromLocalStorage(ddz.gameModel.YESTERDAYSHARE, true);\n                            if (continuousLogin){\n                                if (!yesterdayShare){\n                                    hall.GlobalFuncs.onSkipCustom(2);\n                                    return\n                                }\n                            }else {\n                                hall.GlobalFuncs.onSkipCustom(3);\n                                return\n                            }\n                        }\n                    }\n                }\n                ddz.matchModel.startMatchProgress();\n                break;\n            }\n            case 'friend':{\n                this.onEnterFriend();\n                break;\n            }\n            case 'gold':{\n                hall.GlobalFuncs.gotoRoomListScene();\n                break;\n            }\n            case 'match':{\n                //ddz.GlobalFuncs.showNormalTipsWindow(\"<color=#1A6951>即将上线,敬请期待~</c>\");\n                //TODO:比赛赢奖\n                this.onMatchListButton();\n                break;\n            }\n            case 'rank':{\n                this.onRankButton();\n                break;\n            }\n            case 'topUp':{\n                //TODO:充值\n                // hall.GlobalFuncs.gotoRechargeScene();\n                break;\n            }\n            case 'diamondNew':{\n                // ddz.gameModel.queryNewInviteInfo();\n                break;\n            }\n            case 'diamondInvite':{\n                ddz.isClickShareReward = true;\n                ddz.gameModel.getDayInviteReward();\n                break;\n            }\n            case 'helpBox':{\n                ddz.isClickOpenBox = true;\n                ddz.gameModel.getOpenBox();\n                break;\n            }\n            case 'reward':{\n                this.onGetRewardButton();\n                break;\n            }\n            case 'giftBag':{\n                if (ty.TCP.connectStatus != ty.TCP.CONNECT_STATUS_OK){\n                    hall.MsgBoxManager.showToast({title : \"正在登录，请稍候\"});\n                    ddz.LOGD(null, \"TCP is not ok! Please wait!\");\n                    return;\n                }\n                if (hall.loginBtnManager.canShowUserInfoBtn()){\n                    //如果可以显示授权按钮,在未授权的情况下,这个按钮会被授权按钮挡住,不用做特殊处理\n                    ddz.GlobalFuncs.giftBtnClick();\n                }\n                else{\n                    //不能显示授权按钮的情况,需要特殊处理,因为在未授权情况下,事件会直接作用到到这个按钮上\n                    wx.getSetting({\n                        success:function(res) {\n                            if (!res.authSetting['scope.userInfo']) {\n                                hall.loginBtnManager.onlyAuthorizeAndLogin(ddz.GlobalFuncs.giftBtnClick)\n                            }\n                            else{\n                                ddz.GlobalFuncs.giftBtnClick();\n                            }\n                        }\n                    });\n                }\n                break;\n            }\n        }\n    },\n    onEnterFriend : function () {\n        hall.GlobalFuncs.showPopWinByPreFab('prefabs/ddz_window_createRoom', function (preFabNode) {\n        });\n    },\n    onDetailButton : function () {\n        var sceneName = 'ddz_detail';\n        var onLaunched = function () {\n        };\n        // cc.director.loadScene(sceneName,onLaunched);\n        hall.GlobalFuncs.pushScene(sceneName,onLaunched);\n    },\n    onRankButton : function () {\n        var sceneName = 'ddz_rank';\n        var onLaunched = function () {\n            var logicScene = cc.director.getScene();\n            var no = logicScene.children[0];\n            var window = no.getComponent(\"ddz_rank\");\n            window.showRankListForShare();\n        };\n        // cc.director.loadScene(sceneName,onLaunched);\n        hall.GlobalFuncs.pushScene(sceneName,onLaunched);\n        ddz.LOGD(null, \"onRankButton\");\n    },\n\n    onMatchListButton: function() {\n        var sceneName = 'MatchListScene';\n        var onLaunched = function () {\n            //var logicScene = cc.director.getScene();\n            //var no = logicScene.children[0];\n            //var window = no.getComponent(\"ddz_rank\");\n            //window.showRankListForShare();\n        };\n        // cc.director.loadScene(sceneName,onLaunched);\n        hall.GlobalFuncs.pushScene(sceneName,onLaunched);\n    },\n\n    onGetRewardButton : function () {\n        var sceneName = 'ddz_reward';\n        // cc.director.loadScene(sceneName);\n        hall.GlobalFuncs.pushScene(sceneName);\n    },\n    /*============业务方法==============*/\n\n    onReciveHallInfo : function () {\n        ddz.LOGD(this._TAG, \"onReciveHallInfo\");\n        this.checkLoading();\n    },\n    update: function (dt) {\n    },\n    onDestroy : function () {\n        // hall.adManager.hideAdIco();\n        if (hall.AdManagerTYWX && hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\")) {\n            hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\").hideAdNode();\n        }\n        ty.NotificationCenter.ignoreScope(this);\n        hall.loginBtnManager.destroyHideBtn();\n    }\n});\n"]}
{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/component/assets/Script/ComponentScript/component/ddz_cell_roomlist.js"],"names":["cc","Class","extends","Component","properties","roomName","default","type","Label","leftRichText","RichText","rightRichText","selectKuang","Node","redBar","awardText","onLoad","isSelect","cellIndex","ty","NotificationCenter","listen","ddz","EventType","UPDATE_ROOMLIST_KUANG","setSelect","SAVE_MATCH_SUCCESS","onSaveMatch","addDataWithObject","objc","setDetailInformation","resultMap","LOGD","JSON","stringify","string","name","setRightRichText","condition","roomID","id","mixId","play_mode","onLineNum","hall","gameWorld","getRoomOnlineInfo","userCount","node","active","setLeftRichText","gameDes","setAwardText","index","_gameId","SystemInfo","gameId","hallId","MsgFactory","getQuickStart","UserInfo","userId","staticSystemInfo","version","_isAward","_des","num","str","_index","_isSelect","onClickCell","BiLog","clickStat","clickStatEventType","clickStatEventTypeButtonClick","matchModel","getCurWaitInfo","saveMatch","onDestroy","ignoreScope"],"mappings":"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","file":"ddz_cell_roomlist.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/component","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        roomName : {\n            default : null,\n            type : cc.Label\n        },\n        \n        leftRichText : {\n            default : null,\n            type : cc.RichText\n        },\n        rightRichText : {\n            default : null,\n            type : cc.RichText\n        },\n        selectKuang : {\n            default : null,\n            type : cc.Node\n        },\n        redBar : {\n            default : null,\n            type : cc.Node\n        },\n        awardText : {\n            default : null,\n            type : cc.RichText\n        },\n    },\n\n    onLoad:function () {\n        this.isSelect(false);\n        this.cellIndex = -1;\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_ROOMLIST_KUANG,this.setSelect,this);\n        ty.NotificationCenter.listen(ddz.EventType.SAVE_MATCH_SUCCESS, this.onSaveMatch, this);\n    },\n\n    addDataWithObject : function (objc) {\n        this.setDetailInformation(objc);\n    },\n\n    setDetailInformation:function (resultMap) {\n        ddz.LOGD(\"\",\"file = [ddz_cell_roomlist] fun = [setDetailInformation] resultMap = \" + JSON.stringify(resultMap));\n        this.roomName.string = resultMap.name;\n        // this.baseScore.string = resultMap.entry;\n        this.setRightRichText(resultMap.condition);\n        this.roomID = resultMap.id;\n        if (resultMap.mixId){\n            this.mixId = resultMap.mixId;\n        }\n        this.play_mode = resultMap.play_mode;\n        \n        var onLineNum = hall.gameWorld.getRoomOnlineInfo(this.roomID);\n        if (resultMap.userCount) {\n            onLineNum = resultMap.userCount;\n        }\n        // else {\n        //     if (resultMap.name == \"新手场\") {\n        //         onLineNum = onLineNum * 8 + Math.ceil(Math.random()*30) + 50;\n        //     }else if (resultMap.name == \"初级场\") {\n        //         onLineNum = onLineNum * 6 + Math.ceil(Math.random()*20) + 40;\n        //     }\n        // }\n        if (onLineNum != null) {\n            if (onLineNum < 0) {\n                this.leftRichText.node.active = false;\n            } else {\n                this.leftRichText.node.active = true;\n                this.setLeftRichText(onLineNum);\n            }\n        }\n\n        if (resultMap.gameDes && resultMap.gameDes != \"\") {\n            this.setAwardText(true,resultMap.gameDes);\n        }else {\n            this.setAwardText(false);\n        }\n    },\n\n    onSaveMatch:function () {\n        if (this.cellIndex == this.index) {\n            var _gameId = ty.SystemInfo.gameId || ty.SystemInfo.hallId;\n            hall.MsgFactory.getQuickStart(ty.UserInfo.userId, _gameId, this.roomID, hall.staticSystemInfo.version, null, null, null,null,this.mixId,this.play_mode);\n            this.cellIndex = -1;\n        }\n    },\n\n    setAwardText:function (_isAward,_des) {\n        this.redBar.active = _isAward;\n        if (_des) {\n            this.awardText.string = \"<color=#ffffff> \" + _des + \"</c>\";\n        }\n    },\n\n    setLeftRichText:function (num) {\n        this.leftRichText.string = \"<img src='ddz_roomlist_smallPerson' /><color=#1A6951> \" + num + \"</c>\";\n    },\n\n    setRightRichText:function(str) {\n        this.rightRichText.string = \"<img src='ddz_coin_green' height=33.6 width=33.6/><color=#1A6951> \" + str + \"</c>\";\n    },\n\n    setSelect:function (_index) {\n        this.isSelect(false);\n        if (this.index == _index) {\n            this.isSelect(true);\n        }\n    },\n\n    // 选中框\n    isSelect:function (_isSelect) {\n        this.selectKuang.active = _isSelect;\n    },\n\n    onClickCell:function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"roomListClick\",this.roomName.string]);\n        if (ddz.matchModel.getCurWaitInfo()){\n            this.cellIndex = this.index;\n            ddz.LOGD(null,\"file = [ddz_cell_roomlist] fun = [onclickCell] 保存进度\");\n            ddz.MsgFactory.saveMatch();\n        } else {\n            ddz.LOGD(null,\"file = [ddz_cell_roomlist] fun = [onclickCell] 快速开始\");\n            this.cellIndex = -1;\n            var _gameId = ty.SystemInfo.gameId || ty.SystemInfo.hallId;\n            hall.MsgFactory.getQuickStart(ty.UserInfo.userId, _gameId, this.roomID, hall.staticSystemInfo.version, null, null, null,null,this.mixId,this.play_mode);\n        }\n    },\n\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n    },\n\n});\n"]}
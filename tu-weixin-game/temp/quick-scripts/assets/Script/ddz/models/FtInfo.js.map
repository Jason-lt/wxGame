{"version":3,"sources":["FtInfo.js"],"names":["ddz","FtInfo","cc","Class","ftId","results","statics","curRound","goodCard","totalRound","allComplete","isComplete","playMode","iscreator","getScore","index","getScoreInfo","getDelta","fname","length","winloses","clearResult","cleanup","parseGameWin","gamewinAction","LOGD","JSON","stringify","detailsModel","parseFriendRound","parseResults","setIsHisTory","setIsOver","setIsNoWin","nowin","parseTableInfo","tableInfo","ftInfo","Enums","SeatState","SEATDZSTAT_WAIT","creator","ty","UserInfo","userId","Share","shareKeywordReplace","inviteFriendID","displayName","name","NotificationCenter","trigger","EventType","FTINFO_CHANGE","parseGameReady","gameReady","parseFTDisbind","ftDisbindAction"],"mappings":"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","file":"FtInfo.js","sourceRoot":"../../../../../../assets/Script/ddz/models","sourcesContent":["/**\n * Created by xujing on 2018/4/13.\n */\nddz.FtInfo = cc.Class({\n    //数据格式\n    // \"ftInfo\":{\n    //     \"ftId\":\"113383\",\n    //     \"creator\":10001,\n    //     \"curRound\":0,\n    //     \"playMode\":{\n    //         \"name\":\"123\",\n    //         \"displayName\":\"经典\"\n    //     },\n    //     \"totalRound\":6,\n    //     \"double\":0,\n    //     \"goodCard\":0,\n    //     \"fee\":0\n    // },\n\n    ftId: '',\n    results: [],\n    statics: {},\n    curRound: 0,     //好友桌总当前局数\n    goodCard: 0,     //是否为炸弹场\n    totalRound: 0,   //好友桌总局数\n    allComplete: false,   //是否整场都已经结束\n    isComplete:false, //整场是否已经打完所有局数\n    playMode:{\n        \"name\":\"123\",\n        \"displayName\":\"经典\"\n    },\n    iscreator: false,\n    getScore: function (index) {\n        return this.getScoreInfo(index, 'score');\n    },\n\n    getDelta:function (index) {\n        return this.getScoreInfo(index, 'delta');\n    },\n\n    getScoreInfo: function (index, fname) {\n        if (this.results && this.results.length > 0) {\n            return this.results[this.results.length - 1].winloses[index][fname];\n        }\n        return 0;\n    },\n\n    clearResult: function () {\n        this.results = [];\n    },\n\n    cleanup: function () {\n        this.ftId = '';\n        this.results = [];\n        this.statics = {};\n        this.curRound = 0;     //好友桌总当前局数\n        this.totalRound = 0;   //好友桌总局数\n        this.iscreator = false;\n        this.isComplete = false;\n        this.allComplete = false;\n    },\n    parseGameWin: function (gamewinAction) {\n        ddz.LOGD(null, 'parseGameWin ：解析 game_win' + JSON.stringify(gamewinAction));\n        this.curRound = gamewinAction.curRound;\n        this.totalRound = gamewinAction.totalRound;\n        this.results = gamewinAction.results;\n        this.statics = gamewinAction.statics;\n\n        this.isComplete = this.curRound == this.totalRound;\n        this.allComplete = this.curRound == this.totalRound;\n\n        ddz.detailsModel.parseFriendRound(this.curRound,this.totalRound);\n        ddz.detailsModel.parseResults(this.results);\n        ddz.detailsModel.setIsHisTory(false);\n        ddz.detailsModel.setIsOver(this.allComplete);\n        ddz.detailsModel.setIsNoWin(gamewinAction.nowin);\n    },\n    parseTableInfo: function (tableInfo) {\n        ddz.LOGD(null, 'parseTableInfo : ' + JSON.stringify(tableInfo.ftInfo));\n        this.ftId = tableInfo.ftInfo.ftId;\n        this.curRound = tableInfo.ftInfo.curRound;\n        this.totalRound = tableInfo.ftInfo.totalRound;\n        this.goodCard = tableInfo.ftInfo.goodCard;\n        this.results = tableInfo.results;\n        this.isComplete = false;\n        this.allComplete = this.curRound == 0 && tableInfo['seat1']['state'] == ddz.Enums.SeatState.SEATDZSTAT_WAIT;\n\n        ddz.detailsModel.parseFriendRound(this.curRound,this.totalRound);\n        ddz.detailsModel.parseResults(this.results);\n        ddz.detailsModel.setIsOver(this.allComplete);\n        ddz.detailsModel.setIsHisTory(false);\n        this.playMode = tableInfo.ftInfo.playMode;\n        this.iscreator = (tableInfo.ftInfo.creator == ty.UserInfo.userId);\n\n        ddz.Share.shareKeywordReplace.inviteFriendID = this.ftId;\n        ddz.Share.shareKeywordReplace.totalRound = this.totalRound;\n        ddz.Share.shareKeywordReplace.displayName = this.playMode.name == \"happy\" ? \"欢乐\" : this.playMode.name == \"wild\" ? \"癞子\" : \"经典\" ;\n        ddz.Share.shareKeywordReplace.goodCard = tableInfo.ftInfo.goodCard == 0 ? \"标准\" : \"炸弹\";\n        ty.NotificationCenter.trigger(ddz.EventType.FTINFO_CHANGE);\n    },\n    parseGameReady: function (gameReady) {\n        ddz.LOGD(null, 'parseTableInfo : ' + JSON.stringify(gameReady));\n        //有问题,容错\n        this.ftId = gameReady.ftInfo ? gameReady.ftInfo.ftId : \"\";\n        this.curRound = gameReady.ftInfo.curRound;\n        this.totalRound = gameReady.ftInfo.totalRound;\n        this.iscreator = (gameReady.ftInfo.creator == ty.UserInfo.userId);\n        this.isComplete = false;\n\n        ddz.Share.shareKeywordReplace.inviteFriendID = this.ftId;\n        ty.NotificationCenter.trigger(ddz.EventType.FTINFO_CHANGE);\n    },\n    parseFTDisbind: function(ftDisbindAction) {\n        this.results = ftDisbindAction.results;\n        this.statics = ftDisbindAction.statics;\n    }\n});"]}
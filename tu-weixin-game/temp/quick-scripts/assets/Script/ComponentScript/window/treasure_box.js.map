{"version":3,"sources":["treasure_box.js"],"names":["cc","Class","extends","Component","properties","backBg","default","type","Button","coloseButton","centerButton","btnText","Label","descLabel","tips_1","RichText","tips_2","boxSprite","Sprite","boxSpritex","boxSpriteFrame","SpriteFrame","bgLight","Node","onLoad","isAction","ty","NotificationCenter","listen","ddz","EventType","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","REMOVE_TREASURE_BOX","playEndAnimation","BOX_ON_CLOSE","onClose","REWARD_VIDEO_COMPLETE","finishShowRewardVideo","ani","node","getComponent","Animation","anim1","getAnimationState","that","once","play","shareType","bt","gameModel","getBoxShareSuccessTipsJson","Share","onShareType","clickStatShareTypeGiveProp","reultType","resultType","isBringVersion","shareToFriend","hall","MsgBoxManager","showToast","title","UserInfo","isInBSGS","getBoxReward","parseInt","userId","treasureID","setBoxShareInfo","info","windoubles","boxId","isClickGet","getRewardDirectly","string","desc","_shareType","GlobalFuncs","getButtonTitle","active","_config","getCongratulationGetRewardJson","shareConfig","bsgsCity","otherCity","shareNumber","ReadStringFromLocalStorage","YESTERDAY_SHARE_NUMBER","openBox","spriteFrame","clickCenterBtn","seeVideoOpenBox","shareWithType","destroy","LOGW","TCP","connectStatus","CONNECT_STATUS_OK","LOGD","AudioHelper","playEffect","EffectPath_mp3","button_click_sound","BiLog","clickStat","clickStatEventType","clickStatEventTypeButtonClick","adManager","showRewardedVideo","isEnded","anim_1","stop","anim_2","matchResultPanel","showResults","onDestroy","ignoreScope","update","dt","rotation"],"mappings":"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","file":"treasure_box.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        backBg : {\n            default : null,\n            type  : cc.Button\n        },\n        coloseButton : {\n            default : null,\n            type : cc.Button\n        },\n\n        centerButton : {\n            default : null,\n            type : cc.Button\n        },\n        \n        btnText:cc.Label,\n        descLabel:cc.Label,\n        tips_1:cc.RichText,\n        tips_2:cc.RichText,\n\n        boxSprite:cc.Sprite,\n        boxSpritex:cc.Sprite,\n        boxSpriteFrame:[cc.SpriteFrame],\n\n        bgLight:cc.Node,\n\n    },\n\n    onLoad : function () {\n        this.isAction = true;\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n        \n        ty.NotificationCenter.listen(ddz.EventType.REMOVE_TREASURE_BOX, this.playEndAnimation, this);\n        ty.NotificationCenter.listen(ddz.EventType.BOX_ON_CLOSE, this.onClose, this);\n\n        ty.NotificationCenter.listen(ddz.EventType.REWARD_VIDEO_COMPLETE,this.finishShowRewardVideo,this);\n\n        var ani = this.node.getComponent(cc.Animation);\n        var anim1 = ani.getAnimationState('awad_tips_show_box');\n        var that = this;\n        anim1.once(\"finished\", function () {\n            that.isAction = false;\n            // var anim2 = ani.getAnimationState('awad_tips_show_xunhuan');\n            // anim2.play();\n\n        });\n        anim1.play();\n    },\n\n    playAnimationAfterShareWithType : function (shareType) {\n        var bt = ddz.gameModel.getBoxShareSuccessTipsJson();\n        // if (type == ddz.Share.onShareType.clickStatShareTypeGiveProp) {\n        //     hall.MsgBoxManager.showToast({title : '宝箱可以重复送给更多的朋友哦~'});\n        // }\n\n        if (shareType && shareType != ddz.Share.onShareType.clickStatShareTypeGiveProp) {\n            return;\n        }\n        var reultType = ddz.Share.resultType;\n        switch (reultType) {\n            case 1:\n                if (!ddz.gameModel.isBringVersion) {\n                    var tips_1 = '请分享到微信群哦~';\n                    if (bt && bt.shareToFriend) {\n                        tips_1 = bt.shareToFriend;\n                    }\n                    hall.MsgBoxManager.showToast({title : tips_1});\n                }\n\n                break;\n            case 2:\n                if (!ddz.gameModel.isBringVersion) {\n                    // if (ty.UserInfo.isInBSGS) {\n                    //     var tips_2 = ['点击分享卡片可以获得奖励~'];\n                    //     if (bt && bt.shareToCrowd) {\n                    //         tips_2 = bt.shareToCrowd;\n                    //     }\n                    //     var index = hall.GlobalFuncs.getRandomNumberBefore(tips_2.length);\n                    //     hall.MsgBoxManager.showToast({title : tips_2[index]});\n                    // }else {\n                    //     hall.MsgBoxManager.showToast({title : '请不要频繁分享到一个群~'});\n                    // }\n                    hall.MsgBoxManager.showToast({title : '请不要频繁分享到一个群~'});\n                }\n                break;\n            case 3:\n                if (ty.UserInfo.isInBSGS) {\n                    // if (!ddz.gameModel.isBringVersion) {\n                    //     var tips_2 = ['分享到多个群可以获得多个奖励哦~'];\n                    //     if (bt && bt.shareToCrowd) {\n                    //         tips_2 = bt.shareToCrowd;\n                    //     }\n                    //     var index = hall.GlobalFuncs.getRandomNumberBefore(tips_2.length);\n                    //     hall.MsgBoxManager.showToast({title : tips_2[index]});\n                    // }\n                    ddz.gameModel.getBoxReward(parseInt(ty.UserInfo.userId),this.treasureID);\n                }else {\n                    ddz.gameModel.getBoxReward(parseInt(ty.UserInfo.userId),this.treasureID);\n                }\n\n                break;\n            default:\n                break;\n        }\n\n        ddz.Share.resultType = 0;\n    },\n    \n    setBoxShareInfo:function(info,windoubles){\n        if (info) {\n            this.treasureID = info.boxId;\n            this.isClickGet = info.getRewardDirectly == 1 ? true : false;\n            this.descLabel.string = info.desc;\n            this.desc = info.desc;\n        }\n\n\n\n        if (this.isClickGet || ddz.gameModel.isBringVersion){\n            this.btnText.string = \"打开宝箱\";\n        }else {\n            var _shareType = ddz.Share.onShareType.clickStatShareTypeGiveProp;\n            this.btnText.string = hall.GlobalFuncs.getButtonTitle(_shareType);\n            if (ty.UserInfo.isInBSGS){\n                // this.btnText.string = \"打开宝箱\";\n                this.tips_1.node.active = false;\n                this.tips_2.node.active = false;\n            }else {\n                // this.btnText.string = \"分享到群开箱\";\n            }\n\n            var _config = ddz.gameModel.getCongratulationGetRewardJson();\n            var shareConfig;\n            if (_config){\n                if (ty.UserInfo.isInBSGS) {\n                    shareConfig = _config.bsgsCity;\n                }else {\n                    shareConfig = _config.otherCity;\n                }\n            }\n\n            var shareNumber = hall.GlobalFuncs.ReadStringFromLocalStorage(ddz.Share.YESTERDAY_SHARE_NUMBER, 0);\n            if (shareConfig && shareConfig.openBox != null && shareNumber >= shareConfig.openBox){\n                this.btnText.string = \"看广告开宝箱\";\n                // this.btnText.string = \"<color=#ffffff>看广告开宝箱</c>\"\n            }\n        }\n\n        switch(this.desc){\n            case \"青铜宝箱\":\n                this.boxSprite.spriteFrame = this.boxSpriteFrame[0];\n                this.boxSpritex.spriteFrame = this.boxSpriteFrame[0];\n                break;\n            case \"白银宝箱\":\n                this.boxSprite.spriteFrame = this.boxSpriteFrame[1];\n                this.boxSpritex.spriteFrame = this.boxSpriteFrame[1];\n                break;\n            case \"黄金宝箱\":\n                this.boxSprite.spriteFrame = this.boxSpriteFrame[2];\n                this.boxSpritex.spriteFrame = this.boxSpriteFrame[2];\n                break;\n            case \"春天宝箱\":\n                this.boxSprite.spriteFrame = this.boxSpriteFrame[3];\n                this.boxSpritex.spriteFrame = this.boxSpriteFrame[3];\n                break;\n            default:\n                break;\n        }\n    },\n\n    clickCenterBtn:function(){\n        if(this.isClickGet || ddz.gameModel.isBringVersion){\n            ddz.gameModel.getBoxReward(parseInt(ty.UserInfo.userId),this.treasureID);\n            this.onClose();\n        }else{\n            var _config = ddz.gameModel.getCongratulationGetRewardJson();\n            if (_config){\n                var shareConfig;\n                if (ty.UserInfo.isInBSGS) {\n                    shareConfig = _config.bsgsCity;\n                }else {\n                    shareConfig = _config.otherCity;\n                }\n            }\n\n            var shareNumber = hall.GlobalFuncs.ReadStringFromLocalStorage(ddz.Share.YESTERDAY_SHARE_NUMBER, 0);\n            if (shareConfig && shareConfig.openBox != null && shareNumber >= shareConfig.openBox){\n                this.seeVideoOpenBox();\n            }else{\n                ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeGiveProp);\n            }\n\n        }\n    },\n\n    playEndAnimation : function () {\n        if (this.node) {\n            this.node.destroy();\n        }\n    },\n\n    //开广告打开宝箱\n    seeVideoOpenBox:function(){\n        hall.LOGW(\"====\",\"====seeVideoOpenBox===\");\n        if (ty.TCP.connectStatus != ty.TCP.CONNECT_STATUS_OK){\n            hall.MsgBoxManager.showToast({title : \"正在登录，请稍候\"});\n            ddz.LOGD(null, \"TCP is not ok! Please wait!\");\n            return;\n        }\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.button_click_sound, false);\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"seeVideoOpenBox\"]);\n        // var adId = this.adIds[hall.GlobalFuncs.getRandomNumberBefore(this.adIds.length)];\n\n        hall.adManager.showRewardedVideo(\"\",\"openBox\");\n    },\n\n    finishShowRewardVideo : function (isEnded) {\n        if(isEnded){\n            ddz.gameModel.getBoxReward(parseInt(ty.UserInfo.userId),this.treasureID);\n        }\n    },\n\n\n    onClose:function () {\n        if (this.isAction){\n            return\n        }\n\n        var ani = this.node.getComponent(cc.Animation);\n        var anim_1 = ani.getAnimationState('awad_tips_show_box');\n        anim_1.stop();\n\n        var anim_2 = ani.getAnimationState('awad_tips_show_xunhuan');\n        anim_2.stop();\n\n        if (ddz.matchResultPanel) {\n            ddz.matchResultPanel.showResults(true);\n        }\n        \n        this.isAction = true;\n        this.playEndAnimation();\n    },\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n    },\n\n    update:function (dt) {\n        if (!this.isAction){\n            this.bgLight.rotation += 0.5;\n        }\n\n    },\n});\n\n"]}
{"version":3,"sources":["treasure_box_newer.js"],"names":["cc","Class","extends","Component","properties","chipNode","Node","diamondNode","chipNumberLabel","default","type","Label","diamondNumberLabel","countDownRich","RichText","lastNumber","onBlack","playEndAnimation","node","destroy","onClose","event","isAction","ddz","ddz_newUserBox","onHelp","Share","shareWithType","onShareType","clickStatShareTypeNewUserGifts","setCountDownWithNumber","number","active","new_gift_reward","matchModel","shareKeywordReplace","newerTreasureID","giftId","reward","rewards","i","length","rewardInfo","itemId","string","count","hall","GlobalFuncs","formatMinSeconds","ty","Timer","setTimer","countDown","onLoad","animation","getComponent","Animation","anim1","getAnimationState","on","play","NotificationCenter","listen","EventType","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","adManager","showAllWidthBannerAd","shareType","MsgBoxManager","showToast","title","onDestroy","unscheduleAllCallbacks","ignoreScope","destroyWidthBannerAd"],"mappings":"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","file":"treasure_box_newer.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        chipNode : cc.Node,\n        diamondNode : cc.Node,\n        chipNumberLabel : {\n            default : null,\n            type : cc.Label\n        },\n        diamondNumberLabel : {\n            default : null,\n            type : cc.Label\n        },\n        countDownRich : {\n            default : null,\n            type : cc.RichText\n        },\n        lastNumber : 0\n    },\n\n    onBlack : function () {\n    },\n\n    playEndAnimation : function () {\n        if (this.node) {\n            this.node.destroy();\n        }\n    },\n    onClose:function (event) {\n        if (this.isAction){\n            return\n        }\n        this.isAction = true;\n        this.playEndAnimation();\n        ddz.ddz_newUserBox = null;\n    },\n\n    onHelp : function () {\n        ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeNewUserGifts);\n    },\n\n    setCountDownWithNumber : function (number) {\n        this.chipNode.active = false;\n        this.diamondNode.active = false;\n        var new_gift_reward = ddz.matchModel.new_gift_reward;\n        ddz.Share.shareKeywordReplace.newerTreasureID = new_gift_reward.giftId;\n        var reward = new_gift_reward.rewards;\n        for (var i = 0 ; i < reward.length ; i ++){\n            var rewardInfo = reward[i];\n            if(rewardInfo.itemId == \"item:1311\"){\n                this.diamondNode.active = true;\n                this.diamondNumberLabel.string = rewardInfo.count;\n            }else if(rewardInfo.itemId == \"user:chip\"){\n                this.chipNode.active = true;\n                this.chipNumberLabel.string = rewardInfo.count;\n            }\n\n        }\n        // this.lastNumber = new_gift_reward.cdTime;\n        this.lastNumber = number;\n        this.countDownRich.string = \"消失倒计时 \"+hall.GlobalFuncs.formatMinSeconds(this.lastNumber);\n        ty.Timer.setTimer(this,this.countDown,0.1,this.lastNumber);\n\n    },\n    countDown : function () {\n        this.lastNumber --;\n        if(this.lastNumber > 0 ){\n            this.countDownRich.string = \"消失倒计时 \"+hall.GlobalFuncs.formatMinSeconds(this.lastNumber);\n        }else {\n            this.onClose();\n        }\n    },\n\n    onLoad :function() {\n        this.isAction = true;\n        var animation = this.getComponent(cc.Animation);\n        var anim1 = animation.getAnimationState('awad_tips_show');\n        anim1.on('finished', function(){\n            this.isAction = false;\n        },this);\n        anim1.play();\n\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n\n        // if (!ddz.curAllWidthBannerAd){\n        //     hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n        // }\n        hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n\n        // this.setCountDownWithNumber();\n    },\n\n    playAnimationAfterShareWithType : function (shareType) {\n        if (shareType && shareType != ddz.Share.onShareType.clickStatShareTypeNewUserGifts) {\n            return;\n        }\n        hall.MsgBoxManager.showToast({title : \"分享到更多群邀请更多好友吧～\"});\n    },\n\n    onDestroy : function () {\n        this.unscheduleAllCallbacks();\n        ty.NotificationCenter.ignoreScope(this);\n        hall.adManager.destroyWidthBannerAd();\n    }\n\n    // LIFE-CYCLE CALLBACKS:\n\n\n    // start () {\n    //\n    // },\n\n    // update (dt) {},\n});\n"]}
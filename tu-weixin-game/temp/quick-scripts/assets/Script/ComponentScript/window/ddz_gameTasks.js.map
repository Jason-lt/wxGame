{"version":3,"sources":["ddz_gameTasks.js"],"names":["cc","Class","extends","Component","properties","tasksBg","default","type","Sprite","tasksRich","RichText","onLoad","ty","NotificationCenter","listen","ddz","EventType","MSG_TBOX_GETREWARD","playSuccessAni","updateProgress","curCount","totalCount","roomId","str","MsgFactory","getTboxReward","_info","setTaskRich","ani","getComponent","Animation","clipName","getClips","name","anim","getAnimationState","that","once","Timer","setTimer","clipName_2","anim_2","play","node","destroy","string","_size","getContentSize","tSize","width","setContentSize","onDestroy","ignoreScope"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,iBAAU;AACNC,qBAAU,IADJ;AAENC,kBAAOP,GAAGQ;AAFJ,SADF;;AAMRC,mBAAY;AACRH,qBAAU,IADF;AAERC,kBAAOP,GAAGU;AAFF;AANJ,KAHP;;AAeLC,YAAQ,kBAAY;AAChBC,WAAGC,kBAAH,CAAsBC,MAAtB,CAA6BC,IAAIC,SAAJ,CAAcC,kBAA3C,EAA8D,KAAKC,cAAnE,EAAkF,IAAlF;AACH,KAjBI;AAkBLC,oBAAiB,wBAAUC,QAAV,EAAmBC,UAAnB,EAA8BC,MAA9B,EAAsC;AACpD,YAAIF,WAAWC,UAAf,EAA0B;AACtB,gBAAIE,MAAM,qBAAqBH,QAArB,GAA+B,GAA/B,GAAqCC,UAArC,GAAiD,WAA3D;AACA,iBAAKH,cAAL,CAAoBK,GAApB;AACH,SAHD,MAGM,IAAIH,YAAYC,UAAZ,IAA0BA,aAAa,CAA3C,EAA6C;AAC/CN,gBAAIS,UAAJ,CAAeC,aAAf,CAA6BH,MAA7B;AACH,SAFK,MAEA,IAAIF,WAAWC,UAAf,EAA0B;AAC5B;AACAN,gBAAIS,UAAJ,CAAeC,aAAf,CAA6BH,MAA7B;AACH;AACH,KA5BI;;AA8BL;AACAJ,oBAAe,wBAAUQ,KAAV,EAAiB;AAC5B;AACA,aAAKC,WAAL,CAAiBD,KAAjB;AACA,YAAIE,MAAM,KAAKC,YAAL,CAAkB7B,GAAG8B,SAArB,CAAV;AACA,YAAIC,WAAWH,IAAII,QAAJ,GAAe,CAAf,EAAkBC,IAAjC;AACA,YAAIC,OAAON,IAAIO,iBAAJ,CAAsBJ,QAAtB,CAAX;AACA,YAAIK,OAAO,IAAX;AACAF,aAAKG,IAAL,CAAU,UAAV,EAAsB,YAAY;AAC9BzB,eAAG0B,KAAH,CAASC,QAAT,CAAkBH,IAAlB,EAAwB,YAAU;AAC9B,oBAAII,aAAaZ,IAAII,QAAJ,GAAe,CAAf,EAAkBC,IAAnC;AACA,oBAAIQ,SAASb,IAAIO,iBAAJ,CAAsBK,UAAtB,CAAb;AACAC,uBAAOC,IAAP;AACAD,uBAAOJ,IAAP,CAAY,UAAZ,EAAwB,YAAY;AAChCD,yBAAKO,IAAL,CAAUC,OAAV;AACH,iBAFD;AAGH,aAPD,EAOG,CAPH,EAOK,CAPL,EAOO,CAPP;AASH,SAVD;AAWAV,aAAKQ,IAAL;AACH,KAlDI;;AAoDLf,iBAAc,qBAAUJ,GAAV,EAAe;AACzB,aAAKd,SAAL,CAAeoC,MAAf,GAAwBtB,GAAxB;AACA,YAAIuB,QAAQ,KAAKrC,SAAL,CAAekC,IAAf,CAAoBI,cAApB,EAAZ;AACA,YAAIC,QAAQ,KAAK3C,OAAL,CAAasC,IAAb,CAAkBI,cAAlB,EAAZ;AACAC,cAAMC,KAAN,GAAcH,MAAMG,KAAN,GAAc,EAA5B;AACA,aAAK5C,OAAL,CAAasC,IAAb,CAAkBO,cAAlB,CAAiCF,KAAjC;AACH,KA1DI;;AA4DLG,eAAY,qBAAY;AACpBvC,WAAGC,kBAAH,CAAsBuC,WAAtB,CAAkC,IAAlC;AACH;AA9DI,CAAT","file":"ddz_gameTasks.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        tasksBg : {\n            default : null,\n            type : cc.Sprite\n        },\n\n        tasksRich : {\n            default : null,\n            type : cc.RichText\n        },\n    },\n\n    onLoad: function () {\n        ty.NotificationCenter.listen(ddz.EventType.MSG_TBOX_GETREWARD,this.playSuccessAni,this);\n    },\n    updateProgress : function (curCount,totalCount,roomId) {\n       if (curCount < totalCount){\n           var str = \"<color=#ffffff>第\" + curCount +\"/\" + totalCount +\"局</color>\";\n           this.playSuccessAni(str);\n       }else if (curCount == totalCount && totalCount > 0){\n           ddz.MsgFactory.getTboxReward(roomId);\n       }else if (curCount > totalCount){\n           // this.playSuccessAni(\"任务失效\");\n           ddz.MsgFactory.getTboxReward(roomId);\n       }\n    },\n\n    // 完成局数发起请求后等待后端驱动\n    playSuccessAni:function (_info) {\n        // this.setSuccessTaskRich(result._info);\n        this.setTaskRich(_info);\n        var ani = this.getComponent(cc.Animation);\n        var clipName = ani.getClips()[0].name;\n        var anim = ani.getAnimationState(clipName);\n        var that = this;\n        anim.once(\"finished\", function () {\n            ty.Timer.setTimer(that, function(){\n                var clipName_2 = ani.getClips()[1].name;\n                var anim_2 = ani.getAnimationState(clipName_2);\n                anim_2.play();\n                anim_2.once(\"finished\", function () {\n                    that.node.destroy();\n                });\n            }, 2,0,0);\n\n        });\n        anim.play();\n    },\n\n    setTaskRich : function (str) {\n        this.tasksRich.string = str;\n        var _size = this.tasksRich.node.getContentSize();\n        var tSize = this.tasksBg.node.getContentSize();\n        tSize.width = _size.width + 64;\n        this.tasksBg.node.setContentSize(tSize);\n    },\n\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n    },\n});\n"]}
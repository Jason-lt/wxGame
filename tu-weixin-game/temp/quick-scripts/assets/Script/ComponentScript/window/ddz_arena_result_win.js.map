{"version":3,"sources":["ddz_arena_result_win.js"],"names":["cc","Class","extends","Component","ctor","properties","rankLable","Label","rankLable_2","rankOuter","shareBtn","Button","onceMoreBtn","aniNode","Node","twoRewardsArea","oneRewardArea","reward1","reward2","reward0","btnBack","onLoad","ddz","matchModel","isShowingRevive","Share","isMatchShare","ty","NotificationCenter","listen","onSigninSuccess","EventType","RECEIVE_MATCH_WAIT_STATE","onMatchWait","ani","getComponent","Animation","play","backButtonH","GlobalFuncs","getBackButtonPositionY","node","y","setOverInfo","overInfo","shareKeywordReplace","arenaRanking","rank","active","string","rewards","length","sr","setRewardInfo","sr1","sr2","rwd","i","icon","noteToFriend","parseInt","count","cleanWaitInfo","onSigninFail","value","showTipsWindow","error","info","tipsString","buttonStr","preFabPath","comName","hall","showPopWinByPreFab","preFabNode","window","tiString","setTitleContentAndButtonsString","title","callFunc","onClickShare","ranking","shareWithType","onShareType","clickStatShareTypeMatchFirst","clickStatShareTypeMatchSecond","clickStatShareTypeMatchThird","clickStatShareTypeArenaWin","onClickOnceMore","matchSignin","roomId","matchId","removeAni","trigger","REMOVE_TABLE_ANI","RESET_TABLE","removeFromParent","onClickBack","ignoreScope","shut","popScene","ARENA_BACK_TO_SCENE","state","destroy","arenaResultPanel","onDestroy"],"mappings":"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","file":"ddz_arena_result_win.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["\n// var ddz_main = cc.instantiate(this.tipsWindow);\n// this.node.addChild(ddz_main);\n// var window = ddz_main.getComponent('ddz_fail');\n// window.setDiamondCount(\"五\",\"56\");\ncc.Class({\n    extends: cc.Component,\n    ctor:function () {\n\n    },\n\n    properties: {\n        rankLable: cc.Label,\n        rankLable_2: cc.Label,\n        rankOuter: cc.Label,\n        shareBtn: cc.Button,\n        onceMoreBtn: cc.Button,\n        aniNode: cc.Node,\n        twoRewardsArea: cc.Node,\n        oneRewardArea: cc.Node,\n        reward1: cc.Node,\n        reward2: cc.Node,\n        reward0: cc.Node,\n        btnBack : cc.Button\n    },\n\n    onLoad:function () {\n        //var backButtonH = ddz.GlobalFuncs.getBackButtonPositionY();\n        //if (backButtonH){\n        //    this.backButton.node.y = backButtonH;\n        //}\n        ddz.matchModel.isShowingRevive = false;\n        ddz.Share.isMatchShare = false;\n        //ty.NotificationCenter.listen(\"signin_fail\", this.onSigninFail, this);\n        ty.NotificationCenter.listen(\"signin_success\", this.onSigninSuccess, this);\n        ty.NotificationCenter.listen(ddz.EventType.RECEIVE_MATCH_WAIT_STATE, this.onMatchWait, this);\n        var ani = this.aniNode.getComponent(cc.Animation);\n        ani.play('qiansan');\n\n        var backButtonH = ddz.GlobalFuncs.getBackButtonPositionY();\n        if (backButtonH){\n            this.btnBack.node.y = backButtonH;\n        }\n    },\n\n    setOverInfo: function(overInfo) {\n        this.overInfo = overInfo;\n        ddz.Share.shareKeywordReplace.arenaRanking = overInfo.rank;\n        if (overInfo.rank <= 3){\n            this.rankLable.node.active = true;\n            this.rankLable_2.node.active = false;\n            this.rankLable.string = overInfo.rank;\n        }else {\n            this.rankLable.node.active = false;\n            this.rankLable_2.node.active = true;\n            this.rankLable_2.string = overInfo.rank;\n        }\n        this.rankOuter.string = overInfo.rank >= 10 ? '第    名' : '第   名';\n        var rewards = overInfo.rewards;\n        if(rewards) {\n            if(rewards.length == 1) {\n                this.twoRewardsArea.active = false;\n                this.oneRewardArea.active = true;\n                var sr = this.reward0.getComponent(\"SingleReward\");\n                sr.setRewardInfo(rewards[0]);\n            }\n\n            if(rewards.length >=2 ) {\n                this.twoRewardsArea.active = true;\n                this.oneRewardArea.active = false;\n                var sr1 = this.reward1.getComponent(\"SingleReward\");\n                sr1.setRewardInfo(rewards[0]);\n                var sr2 = this.reward2.getComponent(\"SingleReward\");\n                sr2.setRewardInfo(rewards[1]);\n            }\n\n            if (overInfo.rank == 1){\n                var rwd;\n                for (var i = 0; i < rewards.length; i++){\n                    rwd = rewards[i];\n                    if (rwd.icon = 'user:coupon'){\n                        //夺冠,通知好友\n                        ddz.GlobalFuncs.noteToFriend('arena', parseInt(rwd.count/100));\n                    }\n                }\n            }\n        }\n        ddz.matchModel.cleanWaitInfo();\n    },\n\n    onSigninFail: function(value) {\n        //报名失败\n        this.showTipsWindow(value.error.info, \"确定\");\n    },\n\n    showTipsWindow : function (tipsString, buttonStr) {\n        var preFabPath = \"prefabs/ddz_window_normal\";\n        var  comName = \"ddz_window_normal\";\n        hall.GlobalFuncs.showPopWinByPreFab(preFabPath, function (preFabNode) {\n            var window = preFabNode.getComponent(comName);\n            var tiString = \"分享\";\n            if(buttonStr){\n                tiString = buttonStr;\n            }\n            window.setTitleContentAndButtonsString(\"提示\",\"<color=#1A6951>\" + tipsString + \"</c>\",[{title:tiString,callFunc : function () {\n                //ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeGetDiamondHall);\n            }}]);\n\n        });\n    },\n\n    onSigninSuccess: function() {\n        //报名成功\n        //this.removeAni();\n        //ty.NotificationCenter.ignoreScope(this);\n        //this.node.destroy();\n    },\n\n    onClickShare: function () {\n        var ranking = this.overInfo.rank;\n        if(ranking == 1){\n            ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeMatchFirst);\n        }else if(ranking == 2){\n            ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeMatchSecond);\n        }else if(ranking == 3){\n            ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeMatchThird);\n        }else {\n            ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeArenaWin);\n        }\n    },\n\n    onClickOnceMore: function() {\n        ddz.matchModel.matchSignin(this.overInfo.roomId, this.overInfo.matchId, 0);\n    },\n\n    removeAni : function () {\n        ty.NotificationCenter.trigger(ddz.EventType.REMOVE_TABLE_ANI);\n        ty.NotificationCenter.trigger(ddz.EventType.RESET_TABLE);\n        this.node.removeFromParent();\n    },\n\n    onClickBack: function() {\n        this.removeAni();\n        ty.NotificationCenter.ignoreScope(this);\n        this.shut();\n        hall.GlobalFuncs.popScene();\n        ty.NotificationCenter.trigger(ddz.EventType.ARENA_BACK_TO_SCENE);\n    },\n\n    onMatchWait: function(state) {\n        ddz.matchModel.onMatchWait(state);\n        this.removeAni();\n        ty.NotificationCenter.ignoreScope(this);\n        this.node.destroy();\n    },\n\n\n    shut:function () {\n        ddz.arenaResultPanel = null;\n        this.node.destroy();\n    },\n\n    onDestroy: function() {\n        ty.NotificationCenter.ignoreScope(this);\n    }\n    // update (dt) {},\n});\n"]}
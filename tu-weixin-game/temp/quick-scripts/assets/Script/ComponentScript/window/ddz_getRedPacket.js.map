{"version":3,"sources":["ddz_getRedPacket.js"],"names":["cc","Class","extends","Component","properties","ddz_redpacket","default","type","Node","shareButton","Button","shareLabel","Label","buttonText","RichText","numberString","setRedPacketNumber","buttonString","window","getComponent","string","onShareButton","event","ddz","LOGD","shareType","Share","onShareType","clickStatShareTypeWithDraw","shareWithType","getDiamond","hall","LOGW","GlobalFuncs","playZuanShi","playAnimationAfterShareWithType","gameModel","checkShareReward","SharePointType","redPacket","addTipsWindow","tips","timer","_shareType","_string","getButtonTitle","preFabPath","comName","that","showPopWinByPreFab","preFabNode","parentScene","testArray","title","bottomType","setTitleContentAndButtons","updatePos","onClickCenterButton","updateButtonText","data","leftCount","pointId","onLoad","node","on","ty","NotificationCenter","listen","EventType","GET_DIAMOND","UPDATE_SHARE_STATE","UPDATE_BUTTON_TEXT","onDestroy","ignoreScope"],"mappings":"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","file":"ddz_getRedPacket.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["\n\n// var ddz_getRedPacket = cc.instantiate(this.tipsWindow);\n// this.node.addChild(ddz_getRedPacket);\n// var window = ddz_getRedPacket.getComponent('ddz_getRedPacket');\n// window.setRedPacketNumber(\"20.98\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        ddz_redpacket:{\n            default : null,\n            type : cc.Node\n        },\n        shareButton : {\n            default : null,\n            type : cc.Button\n        },\n        shareLabel : {\n            default : null,\n            type : cc.Label\n        },\n\n        buttonText :{\n            default : null,\n            type : cc.RichText\n        },//白框\n\n        numberString :\"\"\n    },\n\n    setRedPacketNumber:function (numberString,buttonString) {\n        this.numberString = numberString+\"\";\n        var window = this.ddz_redpacket.getComponent('ddz_redPacket');\n        window.setRedPacketNumber(this.numberString);\n        if(buttonString){\n            this.shareLabel.string = buttonString;\n        }\n        // this.shareButton.node.on(\"click\",this.onShareButton,this);\n    },\n\n    onShareButton : function (event) {\n        ddz.LOGD(null, \"onShareButton\");\n        var shareType = ddz.Share.onShareType.clickStatShareTypeWithDraw;\n        ddz.Share.shareWithType(shareType);\n    },\n\n    getDiamond:function(){\n        hall.LOGW(\"==\",\" file = [ddz_getRedPacket] fun = [getDiamond] \");\n        ddz.GlobalFuncs.playZuanShi(true);\n    },\n\n    playAnimationAfterShareWithType : function (shareType) {\n        if (shareType && shareType != ddz.Share.onShareType.clickStatShareTypeWithDraw) {\n            return;\n        }\n        ddz.gameModel.checkShareReward(ddz.Share.SharePointType.redPacket);\n        // var type = ddz.Share.resultType;\n        // hall.LOGD(\"==\",\" file = [ddz_getRedPacket] fun = [playAnimationAfterShareWithType] type = \" + type);\n        // switch (type){\n        //     case 1:\n        //         //\n        //         var tips = \"只有分享到微信群才能领取奖励哦\";\n        //         this.addTipsWindow(tips);\n        //         break;\n        //     case 2:\n        //         var tips = \"这个群已经分享过啦，分享到其他群吧\";\n        //         this.addTipsWindow(tips);\n        //         break;\n        //     case 3:\n        //         break;\n        //     default:\n        //         break;\n        // }\n        // ddz.Share.resultType = 0;\n    },\n\n    addTipsWindow : function (tips,timer) {\n        var _shareType = ddz.Share.onShareType.clickStatShareTypeWithDraw;\n        var _string = hall.GlobalFuncs.getButtonTitle(_shareType);\n        var preFabPath = \"prefabs/ddz_window_tips\";\n        var  comName = \"ddz_tipsWindow\";\n        var that = this;\n        hall.GlobalFuncs.showPopWinByPreFab(preFabPath, function (preFabNode) {\n            var window = preFabNode.getComponent(comName);\n            window.parentScene = that;\n            var testArray = [\n                {\n                    title :_string,\n                    bottomType : 0\n                }\n            ];\n            window.setTitleContentAndButtons(\"提示\",tips, testArray);\n            if (timer && timer > 0){\n                window.updatePos(timer);\n            }\n        });\n    },\n\n    // 点击tips 确定按钮\n    onClickCenterButton:function(){\n        var shareType = ddz.Share.onShareType.clickStatShareTypeWithDraw;\n        ddz.Share.shareWithType(shareType);\n    },\n\n    updateButtonText:function(data){\n        hall.LOGW(\"==\",\" file = [ddz_getRedPacket] fun = [updateButtonText] diamond = \" + data.leftCount);\n        if (data.pointId != ddz.Share.SharePointType.redPacket){\n            return;\n        }\n        var _shareType = ddz.Share.onShareType.clickStatShareTypeWithDraw;\n        if (!data.leftCount || data.leftCount <= 0) {\n            this.buttonText.string = \"<color=#FFFFFF>\"+ hall.GlobalFuncs.getButtonTitle() +\"</c>\";\n        }else {\n            this.buttonText.string = \"<color=#FFFFFF>\"+ hall.GlobalFuncs.getButtonTitle(_shareType) +\"</c>\";\n        }\n    },\n\n    onLoad :function() {\n        this.shareButton.node.on(\"click\",this.onShareButton,this);\n        ty.NotificationCenter.listen(ty.EventType.GET_DIAMOND, this.getDiamond, this);\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n        ty.NotificationCenter.listen(ty.EventType.UPDATE_BUTTON_TEXT, this.updateButtonText, this);\n        ddz.gameModel.checkShareReward(ddz.Share.SharePointType.redPacket);\n        // this.setRedPacketNumber(\"58.62\");\n    },\n    onDestroy : function () {\n        // this.shareButton.node.off(\"click\",this.onShareButton,this);\n        ty.NotificationCenter.ignoreScope(this);\n    }\n\n    // update (dt) {},\n});"]}
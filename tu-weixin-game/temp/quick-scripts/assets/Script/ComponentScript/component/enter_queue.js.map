{"version":3,"sources":["enter_queue.js"],"names":["cc","Class","extends","Component","ctor","_TAG","isPlaying","properties","bgBtn","default","type","Button","tipsLabel","Label","tipsLabel2","bgSprite","Sprite","backBtn","feeText","RichText","nowIndex","massageList","onLoad","ty","NotificationCenter","listen","ddz","EventType","REMOVE_MATCHING","shutSelf","GAME_HIDE","backButtonH","GlobalFuncs","getBackButtonPositionY","node","y","size","director","getWinSize","setContentSize","trigger","REMOVE_TREASURE_BOX","bc","gameModel","getRoomListBannerConfigJson","winnerCount","matchModel","getCurWinnerCount","start","hall","adManager","showAllWidthBannerAd","zuanshiBoxCom","onClose","AdManagerTYWX","getAdNodeByTag","hideAdNode","enterQueue","LOGD","isLoadTableScene","string","active","_queueInfo","getCurQueueInfo","roomFee","backAction","REMOVE_TABLE_ANI","AudioHelper","playEffect","EffectPath_mp3","back_button_click_sound","_mixID","mixId","_mixedRoomId","mixedRoomId","MsgFactory","getRoomLeave","roomId","playAni","value","ani","getComponent","Animation","anim","getAnimationState","play","stop","noDelete","ignoreScope","destroy","isInAtScene","canShowTableBanner","canShowTableTopBanner","SHOW_TABLE_BANNER","onDestroy","destroyWidthBannerAd"],"mappings":"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","file":"enter_queue.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/component","sourcesContent":["/**\n * Created by tuyoo on 2018/2/23.\n */\ncc.Class({\n    extends: cc.Component,\n    ctor : function () {\n        this._TAG = \"enter_queue\";\n        this.isPlaying = false;\n    },\n\n    properties: {\n        bgBtn: {\n            default : null,\n            type : cc.Button\n        },\n        tipsLabel: {\n            default : null,\n            type : cc.Label\n        },\n        tipsLabel2: {\n            default : null,\n            type : cc.Label\n        },\n        bgSprite: {\n            default : null,\n            type : cc.Sprite\n        },\n        backBtn: {\n            default : null,\n            type : cc.Button\n        },\n        feeText: {\n            default : null,\n            type : cc.RichText\n        },\n        nowIndex : 1,\n        massageList :null\n    },\n\n    onLoad :function() {\n        ty.NotificationCenter.listen(ddz.EventType.REMOVE_MATCHING, this.shutSelf, this);\n        ty.NotificationCenter.listen(ddz.EventType.GAME_HIDE,this.shutSelf,this);\n\n        var backButtonH = ddz.GlobalFuncs.getBackButtonPositionY();\n        if (backButtonH){\n            this.backBtn.node.y = backButtonH;\n        }\n\n        var size = cc.director.getWinSize();\n        if(this.bgBtn){\n            this.bgBtn.node.setContentSize(size);\n        }\n        ty.NotificationCenter.trigger(ddz.EventType.REMOVE_TREASURE_BOX);\n\n        var bc = ddz.gameModel.getRoomListBannerConfigJson();\n        if (bc) {\n            var winnerCount = ddz.matchModel.getCurWinnerCount();\n            if (bc.start) {\n                if (winnerCount >= bc.start) {\n                    // if (!ddz.curAllWidthBannerAd){\n                    //     hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n                    //     this.feeText.node.y = -200;\n                    // }\n                    hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n                    this.feeText.node.y = -200;\n                }\n            }else {\n                // if (!ddz.curAllWidthBannerAd){\n                //     hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n                //     this.feeText.node.y = -200;\n                // }\n                hall.adManager.showAllWidthBannerAd('adunit-811cc4e234425489');\n                this.feeText.node.y = -200;\n            }\n        }\n\n        if (ddz.zuanshiBoxCom && ddz.zuanshiBoxCom.onClose) {\n            ddz.zuanshiBoxCom.onClose();\n        }\n\n        // hall.adManager.hideAd();\n        if (hall.AdManagerTYWX && hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\")) {\n            hall.AdManagerTYWX.getAdNodeByTag(\"myFirstAdNode\").hideAdNode();\n        }\n    },\n\n    enterQueue:function(){\n        ddz.LOGD(\"\",\"file = [enter_queue] fun = [enterQueue] \");\n        if (ddz.gameModel.isLoadTableScene) {\n            this.shutSelf();\n        }else {\n            this.tipsLabel.string = '匹配中...';\n            this.tipsLabel2.string = '';\n            this.bgSprite.node.active = true;\n            var _queueInfo = ddz.matchModel.getCurQueueInfo();\n            if (_queueInfo.roomFee && _queueInfo.roomFee > 0) {\n                if (this.feeText) {\n                    this.feeText.node.active = true;\n                    this.feeText.string = \"<color=#ffffff>本局服务费</color><img src='ddz_coin_white'/><color=#FFFFFF>\" + _queueInfo.roomFee + \"</c>\";\n                }\n            }\n        }\n    },\n\n    backAction:function(){\n        var _queueInfo = ddz.matchModel.getCurQueueInfo();\n        this.shutSelf();\n        ty.NotificationCenter.trigger(ddz.EventType.REMOVE_TABLE_ANI);\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.back_button_click_sound, false);\n        var _mixID = _queueInfo.mixId;\n        var _mixedRoomId = _queueInfo.mixedRoomId;\n        ddz.MsgFactory.getRoomLeave(_queueInfo.roomId, null, null, _mixID,_mixedRoomId);\n    },\n\n    /**\n     * 播放动画\n     * @param value\n     */\n    playAni : function (value) {\n        if (this.node){\n            var ani = this.node.getComponent(cc.Animation);\n            var anim = ani.getAnimationState('ddz_matching');\n            if (value && !ddz.gameModel.isLoadTableScene){\n                anim.play();\n            }\n            else{\n                anim.stop();\n            }\n        }\n\n        this.isPlaying = value;\n    },\n\n    shutSelf:function (noDelete) {\n        ddz.LOGD(\"\",\"file = [enter_queue] fun = [shutSelf] this.isPlaying = \" + this.isPlaying);\n        if (this.isPlaying){\n            this.playAni(false);\n        }\n\n        if (this.node) {\n            var ani = this.node.getComponent(cc.Animation);\n            if (ani) {\n                ani.stop();\n            }\n        }\n        ty.NotificationCenter.ignoreScope(this);\n        if (!noDelete) {\n            if (this.node) {\n                this.node.destroy();\n            }\n        }\n\n        if (hall.GlobalFuncs.isInAtScene(\"TableScene\")) {\n            hall.adManager.canShowTableBanner = true;\n            hall.adManager.canShowTableTopBanner = true;\n            ty.NotificationCenter.trigger(ddz.EventType.SHOW_TABLE_BANNER);\n        }\n    },\n\n    onDestroy:function () {\n        hall.adManager.destroyWidthBannerAd();\n    }\n\n    // start () {\n    //\n    // },\n\n    // update (dt) {},\n});"]}
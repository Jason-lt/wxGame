{"version":3,"sources":["double_newResult.js"],"names":["cc","Class","extends","Component","properties","titleLabel","default","type","Label","addNode","Node","addNumberLabel","coinNumber","coinLabel","RichText","bgSprite","Sprite","bgSpriteFrameList","SpriteFrame","rollNode1","rollNode2","rollNode3","topButton","Button","topBtnTitleLabel","bottomButton","bottomBtnTitle","isStartAni","isEndAni","resultIndex1","resultIndex2","resultIndex3","resultNumber","blackAction","backAction","onLoad","ty","NotificationCenter","listen","double","EventType","GAME_ROLL_STOP","endRollAnimation","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","updateNewResultInfo","string","GameWorld","totalLevel","spriteFrame","active","node","hall","GlobalFuncs","getRandomNumberBefore","newestObjectIndex","getComponent","setRollTypeAndScale","windowNewWeaponType","newResultRollOne","newResultRollTwo","newResultRollThree","setRollTime","startRollAnimation","rollType","objectConfig","doubleObjectList","goldNumber","resultAdd","getMoreCoinAction","Share","shareWithType","onShareType","clickStatShareTypeAddBullet","shareType","clickStatShareTypeOpenSecretBoxB","resultType","MsgBoxManager","showToast","title","getCoinAction","chipNumber","setInLocalStorage","gameModel","GAME_COIN_NUMBER","removeFromParent","onDestroy","ignoreScope","unscheduleAllCallbacks"],"mappings":"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","file":"double_newResult.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        titleLabel : {\n            default : null,\n            type : cc.Label\n        },\n\n        addNode : {\n            default : null,\n            type : cc.Node\n        },\n        addNumberLabel : {\n            default : null,\n            type : cc.Label\n        },\n\n        coinNumber : 0,\n        coinLabel : {\n            default : null,\n            type : cc.RichText\n        },\n\n        bgSprite : {\n            default : null,\n            type : cc.Sprite\n        },\n        bgSpriteFrameList : [cc.SpriteFrame],\n\n        rollNode1 : {\n            default : null,\n            type : cc.Node\n        },\n        rollNode2 : {\n            default : null,\n            type : cc.Node\n        },\n        rollNode3 : {\n            default : null,\n            type : cc.Node\n        },\n\n        topButton : {\n            default : null,\n            type : cc.Button\n        },\n        topBtnTitleLabel : {\n            default : null,\n            type : cc.Label\n        },\n        bottomButton : {\n            default : null,\n            type : cc.Button\n        },\n        bottomBtnTitle : {\n            default : null,\n            type : cc.Label\n        },\n\n        isStartAni : false,\n        isEndAni : false,\n\n        resultIndex1 : 0,\n        resultIndex2 : 0,\n        resultIndex3 : 0,\n        resultNumber : 0\n    },\n\n    blackAction : function () {\n\n    },\n    backAction : function () {\n\n    },\n    onLoad : function() {\n        ty.NotificationCenter.listen(double.EventType.GAME_ROLL_STOP,this.endRollAnimation,this);\n        ty.NotificationCenter.listen(double.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n    },\n    updateNewResultInfo : function () {\n        this.titleLabel.string = \"第\"+(double.GameWorld.totalLevel-1)+\"关\";\n        this.bgSprite.spriteFrame = this.bgSpriteFrameList[0];\n        this.coinNumber = 0;\n        this.addNode.active = false;\n        this.isStartAni = false;\n        this.isEndAni = false;\n        this.resultNumber = 0;\n        this.topButton.node.active = false;\n        this.bottomBtnTitle.string = \"赚金币\";\n        //TODO:计算结果\n        this.resultIndex1 = hall.GlobalFuncs.getRandomNumberBefore(double.GameWorld.newestObjectIndex+1);\n        this.resultIndex2 = 0;\n        this.resultIndex3 = 0;\n        this.rollNode1.getComponent(\"double_cell_newResult\").setRollTypeAndScale(\n            double.windowNewWeaponType.newResultRollOne,double.GameWorld.newestObjectIndex,this.resultIndex1);\n        this.rollNode2.getComponent(\"double_cell_newResult\").setRollTypeAndScale(\n            double.windowNewWeaponType.newResultRollTwo,double.GameWorld.newestObjectIndex,this.resultIndex2);\n        this.rollNode3.getComponent(\"double_cell_newResult\").setRollTypeAndScale(\n            double.windowNewWeaponType.newResultRollThree,double.GameWorld.newestObjectIndex,this.resultIndex3);\n        this.rollNode1.getComponent(\"double_cell_newResult\").setRollTime(10,55);\n        this.rollNode2.getComponent(\"double_cell_newResult\").setRollTime(10,50);\n        this.rollNode3.getComponent(\"double_cell_newResult\").setRollTime(10,45);\n    },\n    startRollAnimation : function () {\n        this.isStartAni = true;\n        this.rollNode1.getComponent(\"double_cell_newResult\").setRollTime(10,120);\n        this.rollNode2.getComponent(\"double_cell_newResult\").setRollTime(10,100);\n        this.rollNode3.getComponent(\"double_cell_newResult\").setRollTime(10,115);\n    },\n    endRollAnimation : function (rollType) {\n        if(rollType  < double.windowNewWeaponType.newResultRollOne){\n            return;\n        }\n        if(!this.isStartAni){\n            this.isStartAni = true;\n            this.rollNode1.getComponent(\"double_cell_newResult\").setRollTime(20,330);\n            this.rollNode2.getComponent(\"double_cell_newResult\").setRollTime(20,350);\n            this.rollNode3.getComponent(\"double_cell_newResult\").setRollTime(20,370);\n            return;\n        }\n        if(rollType == double.windowNewWeaponType.newResultRollOne){\n            this.coinNumber += double.GameWorld.objectConfig[double.GameWorld.doubleObjectList[this.resultIndex1]].goldNumber;\n            // this.coinNumber += this.resultIndex1;\n        }else if(rollType == double.windowNewWeaponType.newResultRollTwo){\n            this.coinNumber += double.GameWorld.objectConfig[double.GameWorld.doubleObjectList[this.resultIndex2]].goldNumber;\n            // this.coinNumber += this.resultIndex2;\n        }else {\n            this.coinNumber += double.GameWorld.objectConfig[double.GameWorld.doubleObjectList[this.resultIndex3]].goldNumber;\n            // this.coinNumber += this.resultIndex3;\n        }\n        this.coinLabel.string = \"<color=#000000>获得 </c><img src='double_titlePage_coin'/><color=#000000> \"+this.coinNumber+\"0</color>\";\n        this.resultNumber ++;\n        if(this.resultNumber >= 3){\n            //TODO:计算翻倍结果\n            this.isEndAni = true;\n            var resultAdd = 1;\n            if(this.resultIndex1 == this.resultIndex2 && this.resultIndex2 == this.resultIndex3){\n                resultAdd = 3;\n            }else if(this.resultIndex1 == this.resultIndex2 || this.resultIndex2 == this.resultIndex3){\n                resultAdd = 2;\n            }\n            if(resultAdd != 1){\n                this.addNode.active = true;\n                this.addNumberLabel.string = resultAdd +\"倍\";\n            }\n            this.coinNumber *= resultAdd;\n            this.coinLabel.string = \"<color=#000000>获得 </c><img src='double_titlePage_coin'/><color=#000000> \"+this.coinNumber+\"0</color>\";\n\n            this.bgSprite.spriteFrame = this.bgSpriteFrameList[1];\n        }\n    },\n\n    getMoreCoinAction : function () {\n        double.Share.shareWithType(double.Share.onShareType.clickStatShareTypeAddBullet);\n    },\n    playAnimationAfterShareWithType : function (shareType) {\n        if (shareType && (shareType == double.Share.onShareType.clickStatShareTypeOpenSecretBoxB)) {\n            var resultType = double.Share.resultType;\n            switch (resultType) {\n                case 1:\n                    hall.MsgBoxManager.showToast({title : '分享到群才有效哦~'});\n                    break;\n                case 2:\n                    hall.MsgBoxManager.showToast({title : '这个群今天已经打扰过了哦~'});\n                    break;\n                case 3:\n                    this.coinNumber *= 2;\n                    this.getCoinAction();\n                    break;\n                case 6:\n                    hall.MsgBoxManager.showToast({title : '分享失败'});\n                    break;\n                default:\n                    hall.MsgBoxManager.showToast({title : '分享失败了'});\n                    break;\n            }\n        }\n        double.Share.resultType = 0;\n    },\n\n    getCoinAction : function () {\n        //TODO:领取金币\n        double.GameWorld.chipNumber += this.coinNumber;\n        hall.GlobalFuncs.setInLocalStorage(double.gameModel.GAME_COIN_NUMBER,double.GameWorld.chipNumber);\n\n        this.node.removeFromParent();\n    },\n\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n        this.unscheduleAllCallbacks();\n    }\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    // start () {\n    //\n    // },\n\n    // update (dt) {},\n});\n"]}
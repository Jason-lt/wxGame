{"version":3,"sources":["../../../../../assets/Script/Framework/assets/Script/Framework/MsgCache.js"],"names":["double","msgCache","needCacheMsg","blocked","msgQueue","pushMsg","msg","msgKey","cmd","result","action","hasOwnProperty","push","ty","TCP","triggerMsg","dump","length","shift"],"mappings":";;;;;;AAAA;;;;AAIAA,OAAOC,QAAP,GAAkB;;AAEd;AACAC,kBAAa;AACT,4BAAqB,IADZ;AAET,iCAA0B,IAFjB;AAGT,2BAAoB,IAHX;AAIT,8BAAuB,IAJd;AAKT,2BAAmB,IALV;AAMT,iCAAyB,IANhB;AAOT,2BAAmB,IAPV;AAQT,yBAAiB,IARR;AAST,+BAAuB,IATd;AAUT,gCAAwB;AAVf,KAHC;;AAgBdC,aAAQ,IAhBM,EAgBA;AACdC,cAAW,EAjBG;;AAqBd;;;;AAIAC,aAAQ,iBAAUC,GAAV,EAAe;AACnB,YAAIC,SAASD,IAAIE,GAAjB;AACA,YAAIF,IAAIG,MAAJ,IAAcH,IAAIG,MAAJ,CAAWC,MAA7B,EAAoC;AAChCH,qBAASA,SAAS,GAAT,GAAeD,IAAIG,MAAJ,CAAWC,MAAnC;AACH;AACD,YAAI,KAAKR,YAAL,CAAkBS,cAAlB,CAAiCJ,MAAjC,CAAJ,EAA6C;AACzC,iBAAKH,QAAL,CAAcQ,IAAd,CAAmBN,GAAnB;AACH,SAFD,MAGI;AACAO,eAAGC,GAAH,CAAOC,UAAP,CAAkBT,GAAlB;AACH;AACJ,KApCa;;AAsCdU,UAAK,gBAAY;AACb,eAAO,KAAKZ,QAAL,CAAca,MAAd,GAAuB,CAA9B,EAAgC;AAC5B,gBAAIX,MAAM,KAAKF,QAAL,CAAcc,KAAd,EAAV;AACAL,eAAGC,GAAH,CAAOC,UAAP,CAAkBT,GAAlB;AACH;AACD,aAAKH,OAAL,GAAe,KAAf;AACH;AA5Ca,CAAlB","file":"MsgCache.js","sourceRoot":"../../../../../assets/Script/Framework","sourcesContent":["/**\n * 消息缓存类,用来缓存table_info之后来的消息,table_info来之后,牌桌新创建的时候,耗时比较长,会导致丢消息,要用缓存来缓住。\n * Created by xujing on 2018/4/15.\n */\ndouble.msgCache = {\n\n    //主要是缓存打牌的消息\n    needCacheMsg:{\n        'table_call:ready' : null,\n        'table_call:game_ready' : null,\n        'table_call:next' : null,\n        'table_call:smilies' : null,\n        'table_call:call': null,\n        'table_call:game_start': null,\n        'table_call:card': null,\n        'table_call:rb': null,\n        'table_call:game_win': null,\n        'table_call:wild_card': null\n    },\n\n    blocked:true, //阻拦状态\n    msgQueue : [\n\n    ],\n\n    /**\n     * 添加消息到缓存队列\n     * @param msg\n     */\n    pushMsg:function (msg) {\n        var msgKey = msg.cmd;\n        if (msg.result && msg.result.action){\n            msgKey = msgKey + ':' + msg.result.action;\n        }\n        if (this.needCacheMsg.hasOwnProperty(msgKey)){\n            this.msgQueue.push(msg);\n        }\n        else{\n            ty.TCP.triggerMsg(msg);\n        }\n    },\n\n    dump:function () {\n        while (this.msgQueue.length > 0){\n            var msg = this.msgQueue.shift();\n            ty.TCP.triggerMsg(msg);\n        }\n        this.blocked = false;\n    }\n};"]}
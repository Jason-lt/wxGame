{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/window/assets/Script/ComponentScript/window/double_rank.js"],"names":["cc","Class","extends","Component","properties","backButton","default","type","Button","seeHolkButton","startGameButton","titleLabel","Label","rankSprite","Sprite","texture","Texture2D","spriteFrame","SpriteFrame","shareTicket","backAction","double","LOGD","node","destroy","onBlack","useModel","ctor","onLoad","GlobalFuncs","drawGameCanvas","backButtonH","getBackButtonPositionY","y","openDataContext","getOpenData","sharedCanvas","canvas","width","height","showOrigin","sprite","main","initWithElement","handleLoadedTexture","_refreshTexture","ty","Timer","setTimer","NotificationCenter","listen","EventType","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","hideAdBtnWithTag","shareType","Share","onShareType","clickStatShareTypeRankList","_config","GameWorld","gunnerShareSchemeConfig","reultType","resultType","hall","MsgBoxManager","showToast","title","showRankListForShare","unscheduleAllCallbacks","showFriendRank","showGroupRank","changeButtonToRank","string","active","onRankButton","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeButtonClick","shareWithType","onStartButton","hideBackButton","curScene","director","getScene","name","trigger","GAME_START","sceneName","onLaunched","loadScene","start","onDestroy","gameModel","rankWindow","ignoreScope","showBackButton"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,oBAAa;AACTC,qBAAU,IADD;AAETC,kBAAOP,GAAGQ;AAFD,SADL;AAKRC,uBAAgB;AACZH,qBAAU,IADE;AAEZC,kBAAOP,GAAGQ;AAFE,SALR;AASRE,yBAAkB;AACdJ,qBAAU,IADI;AAEdC,kBAAOP,GAAGQ;AAFI,SATV;AAaRG,oBAAaX,GAAGY,KAbR;;AAeRC,oBAAab,GAAGc,MAfR;;AAiBRC,iBAAQf,GAAGgB,SAjBH;AAkBRC,qBAAY;AACRX,qBAAU,IADF;AAERC,kBAAOP,GAAGkB;AAFF,SAlBJ;;AAuBRC,qBAAc;AAvBN,KAFP;AA2BLC,gBAAa,sBAAY;AACrB;AACAC,eAAOC,IAAP,CAAY,IAAZ,EAAkB,YAAlB;AACA,aAAKC,IAAL,CAAUC,OAAV;AACH,KA/BI;AAgCLC,aAAU,mBAAY,CAErB,CAlCI;AAmCLC,cAAW,oBAAY,CACtB,CApCI;AAqCL;AACAC,UAAO,gBAAY,CAClB,CAvCI;AAwCLC,YAAS,kBAAY;AACjBP,eAAOQ,WAAP,CAAmBC,cAAnB;AACA,YAAIC,cAAcV,OAAOQ,WAAP,CAAmBG,sBAAnB,EAAlB;AACA,YAAID,WAAJ,EAAgB;AACZ,iBAAK1B,UAAL,CAAgBkB,IAAhB,CAAqBU,CAArB,GAAyBF,WAAzB;AACH;;AAED,YAAIG,kBAAkBb,OAAOQ,WAAP,CAAmBM,WAAnB,EAAtB;AACA,YAAG,CAACD,eAAJ,EAAoB;AAChB;AACH;AACD,YAAIE,eAAeF,gBAAgBG,MAAnC;AACAD,qBAAaE,KAAb,GAAsB,GAAtB;AACAF,qBAAaG,MAAb,GAAsB,IAAtB;;AAEAlB,eAAOQ,WAAP,CAAmBW,UAAnB;AACA,aAAKzB,OAAL,GAAe,IAAIf,GAAGgB,SAAP,EAAf;AACA,aAAKC,WAAL,GAAmB,IAAIjB,GAAGkB,WAAP,CAAmB,KAAKH,OAAxB,CAAnB;AACA,YAAIA,UAAU,KAAKA,OAAnB;AACA,YAAIE,cAAc,KAAKA,WAAvB;AACA,YAAIwB,SAAS,KAAK5B,UAAlB;AACA,YAAI6B,OAAO,SAAPA,IAAO,GAAY;AACnB3B,oBAAQ4B,eAAR,CAAwBP,YAAxB;AACArB,oBAAQ6B,mBAAR;AACAH,mBAAOxB,WAAP,GAAqBA,WAArB;AACAwB,mBAAOxB,WAAP,CAAmB4B,eAAnB,CAAmC9B,OAAnC;AACH,SALD;AAMA2B;AACAI,WAAGC,KAAH,CAASC,QAAT,CAAkB,IAAlB,EAAwBN,IAAxB,EAA8B,IAAE,EAAhC,EAAmC,IAAnC;AACA;AACAI,WAAGG,kBAAH,CAAsBC,MAAtB,CAA6B7B,OAAO8B,SAAP,CAAiBC,kBAA9C,EAAkE,KAAKC,+BAAvE,EAAwG,IAAxG;;AAEAhC,eAAOQ,WAAP,CAAmByB,gBAAnB,CAAoC,IAApC,EAAyC,IAAzC;AACAjC,eAAOQ,WAAP,CAAmByB,gBAAnB,CAAoC,IAApC,EAAyC,IAAzC;AACH,KA1EI;;AA4ELD,qCAAkC,yCAAUE,SAAV,EAAqB;AACnD,YAAIA,aAAaA,aAAalC,OAAOmC,KAAP,CAAaC,WAAb,CAAyBC,0BAAvD,EAAmF;AAC/E;AACH;AACD,YAAIC,UAAUtC,OAAOuC,SAAP,CAAiBC,uBAA/B;AACA,YAAIF,OAAJ,EAAY;AACR,gBAAIG,YAAYzC,OAAOmC,KAAP,CAAaO,UAA7B;AACA,oBAAQD,SAAR;AACI,qBAAK,CAAL;AACIE,yBAAKC,aAAL,CAAmBC,SAAnB,CAA6B,EAACC,OAAQ,WAAT,EAA7B;AACA;AACJ;AACI;AALR;AAOH,SATD,MASM;AACFH,iBAAKC,aAAL,CAAmBC,SAAnB,CAA6B,EAACC,OAAQ,cAAT,EAA7B;AACH;;AAED9C,eAAOmC,KAAP,CAAaO,UAAb,GAA0B,CAA1B;AACH,KA/FI;AAgGLK,0BAAuB,gCAAY;AAC/B;AACA,aAAKC,sBAAL;AACA,YAAInC,kBAAkBb,OAAOQ,WAAP,CAAmBM,WAAnB,EAAtB;AACA,YAAG,CAACD,eAAJ,EAAoB;AAChB;AACH;AACD,YAAIE,eAAeF,gBAAgBG,MAAnC;AACA,YAAG,CAAC,KAAKlB,WAAN,IAAqB,KAAKA,WAAL,IAAoB,EAA5C,EAA+C;AAC3CE,mBAAOQ,WAAP,CAAmByC,cAAnB;AACH,SAFD,MAEM;AACFjD,mBAAOQ,WAAP,CAAmB0C,aAAnB,CAAiC,KAAKpD,WAAtC;AACH;AACD;AACA,YAAIJ,UAAU,KAAKA,OAAnB;AACA,YAAIE,cAAc,KAAKA,WAAvB;AACA,YAAIwB,SAAS,KAAK5B,UAAlB;AACA,YAAI6B,OAAO,SAAPA,IAAO,GAAY;AACnB3B,oBAAQ4B,eAAR,CAAwBP,YAAxB;AACArB,oBAAQ6B,mBAAR;AACAH,mBAAOxB,WAAP,GAAqBA,WAArB;AACAwB,mBAAOxB,WAAP,CAAmB4B,eAAnB,CAAmC9B,OAAnC;AACH,SALD;AAMA+B,WAAGC,KAAH,CAASC,QAAT,CAAkB,IAAlB,EAAwBN,IAAxB,EAA8B,IAAE,EAAhC,EAAmC,IAAnC;AACH,KAxHI;AAyHL8B,wBAAqB,4BAAUrD,WAAV,EAAuB;AACxC,aAAKA,WAAL,GAAmBA,WAAnB;AACA,aAAKiD,oBAAL;AACA,YAAGjD,eAAeA,eAAe,EAAjC,EAAoC;AAChC;AACA,iBAAKR,UAAL,CAAgB8D,MAAhB,GAAyB,KAAzB;AACA,iBAAKhE,aAAL,CAAmBc,IAAnB,CAAwBmD,MAAxB,GAAiC,KAAjC;AACA,iBAAKhE,eAAL,CAAqBa,IAArB,CAA0BmD,MAA1B,GAAmC,IAAnC;AACH,SALD,MAKM;AACF,iBAAK/D,UAAL,CAAgB8D,MAAhB,GAAyB,MAAzB;AACA,iBAAKhE,aAAL,CAAmBc,IAAnB,CAAwBmD,MAAxB,GAAiC,IAAjC;AACA,iBAAKhE,eAAL,CAAqBa,IAArB,CAA0BmD,MAA1B,GAAmC,KAAnC;AACH;AACJ,KAtII;AAuILC,kBAAe,wBAAY;AACvB7B,WAAG8B,KAAH,CAASC,SAAT,CAAmB/B,GAAGgC,QAAH,CAAYC,kBAAZ,CAA+BC,6BAAlD,EAAgF,CAAC,iBAAD,CAAhF;AACA,YAAIzB,YAAYlC,OAAOmC,KAAP,CAAaC,WAAb,CAAyBC,0BAAzC;AACArC,eAAOmC,KAAP,CAAayB,aAAb,CAA2B1B,SAA3B;AACH,KA3II;AA4IL2B,mBAAgB,yBAAY;AACxBpC,WAAG8B,KAAH,CAASC,SAAT,CAAmB/B,GAAGgC,QAAH,CAAYC,kBAAZ,CAA+BC,6BAAlD,EAAgF,CAAC,iBAAD,CAAhF;AACA,aAAKG,cAAL;AACA,YAAIC,WAAWpF,GAAGqF,QAAH,CAAYC,QAAZ,EAAf;AACA,YAAIF,SAASG,IAAT,IAAiB,aAArB,EAAmC;AAC/BzC,eAAGG,kBAAH,CAAsBuC,OAAtB,CAA8BnE,OAAO8B,SAAP,CAAiBsC,UAA/C,EAA0D,OAA1D;AACH,SAFD,MAEM;AACF,gBAAIC,YAAY,aAAhB;AACA,gBAAIC,aAAa,SAAbA,UAAa,GAAY,CAC5B,CADD;AAEA3F,eAAGqF,QAAH,CAAYO,SAAZ,CAAsBF,SAAtB,EAAgCC,UAAhC;AACH;AACD,aAAKpE,IAAL,CAAUC,OAAV;AACH,KAzJI;AA0JLqE,WAAO,iBAAW,CACjB,CA3JI;AA4JLC,eAAY,qBAAY;AACpBzE,eAAO0E,SAAP,CAAiBC,UAAjB,GAA8B,IAA9B;AACAlD,WAAGG,kBAAH,CAAsBgD,WAAtB,CAAkC,IAAlC;AACA,aAAK5B,sBAAL;AACH,KAhKI;AAiKLc,oBAAiB,0BAAY;AACzB,aAAK9E,UAAL,CAAgBkB,IAAhB,CAAqBmD,MAArB,GAA8B,KAA9B;AACH,KAnKI;;AAqKLwB,oBAAiB,0BAAY;AACzB,aAAK7F,UAAL,CAAgBkB,IAAhB,CAAqBmD,MAArB,GAA8B,IAA9B;AACH;AAvKI,CAAT","file":"double_rank.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        backButton : {\n            default : null,\n            type : cc.Button\n        },\n        seeHolkButton : {\n            default : null,\n            type : cc.Button\n        },\n        startGameButton : {\n            default : null,\n            type : cc.Button\n        },\n        titleLabel : cc.Label,\n\n        rankSprite : cc.Sprite,\n\n        texture:cc.Texture2D,\n        spriteFrame:{\n            default : null,\n            type : cc.SpriteFrame\n        },\n\n        shareTicket : \"\"\n    },\n    backAction : function () {\n        // ty.NotificationCenter.trigger(double.EventType.UPDATE_RESULT_RANK);\n        double.LOGD(null, \"backAction\");\n        this.node.destroy();\n    },\n    onBlack : function () {\n\n    },\n    useModel : function () {\n    },\n    // LIFE-CYCLE CALLBACKS:\n    ctor : function () {\n    },\n    onLoad : function () {\n        double.GlobalFuncs.drawGameCanvas();\n        var backButtonH = double.GlobalFuncs.getBackButtonPositionY();\n        if (backButtonH){\n            this.backButton.node.y = backButtonH;\n        }\n\n        var openDataContext = double.GlobalFuncs.getOpenData();\n        if(!openDataContext){\n            return;\n        }\n        var sharedCanvas = openDataContext.canvas;\n        sharedCanvas.width  = 566;\n        sharedCanvas.height = 1890;\n\n        double.GlobalFuncs.showOrigin();\n        this.texture = new cc.Texture2D();\n        this.spriteFrame = new cc.SpriteFrame(this.texture);\n        var texture = this.texture;\n        var spriteFrame = this.spriteFrame;\n        var sprite = this.rankSprite;\n        var main = function () {\n            texture.initWithElement(sharedCanvas);\n            texture.handleLoadedTexture();\n            sprite.spriteFrame = spriteFrame;\n            sprite.spriteFrame._refreshTexture(texture);\n        };\n        main();\n        ty.Timer.setTimer(this, main, 1/10,1000);\n        // ddz.matchModel.getRankList();\n        ty.NotificationCenter.listen(double.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n\n        double.GlobalFuncs.hideAdBtnWithTag(5004,true);\n        double.GlobalFuncs.hideAdBtnWithTag(5001,true);\n    },\n\n    playAnimationAfterShareWithType : function (shareType) {\n        if (shareType && shareType != double.Share.onShareType.clickStatShareTypeRankList) {\n            return;\n        }\n        var _config = double.GameWorld.gunnerShareSchemeConfig;\n        if (_config){\n            var reultType = double.Share.resultType;\n            switch (reultType) {\n                case 1:\n                    hall.MsgBoxManager.showToast({title : '分享到群才有效哦~'});\n                    break;\n                default:\n                    break;\n            }\n        }else {\n            hall.MsgBoxManager.showToast({title : \"可入群查看自己的排行哦~\"});\n        }\n\n        double.Share.resultType = 0;\n    },\n    showRankListForShare : function () {\n        // hall.LOGD(\"==\",\"file = [ddz_rank] fun = [showRankListForShare] data = \" + JSON.stringify(this.shareTicket));\n        this.unscheduleAllCallbacks();\n        var openDataContext = double.GlobalFuncs.getOpenData();\n        if(!openDataContext){\n            return;\n        }\n        var sharedCanvas = openDataContext.canvas;\n        if(!this.shareTicket || this.shareTicket == \"\"){\n            double.GlobalFuncs.showFriendRank();\n        }else {\n            double.GlobalFuncs.showGroupRank(this.shareTicket);\n        }\n        // double.GlobalFuncs.showGroupRank(this.shareTicket,this.rankType);\n        var texture = this.texture;\n        var spriteFrame = this.spriteFrame;\n        var sprite = this.rankSprite;\n        var main = function () {\n            texture.initWithElement(sharedCanvas);\n            texture.handleLoadedTexture();\n            sprite.spriteFrame = spriteFrame;\n            sprite.spriteFrame._refreshTexture(texture);\n        };\n        ty.Timer.setTimer(this, main, 1/10,1000);\n    },\n    changeButtonToRank : function (shareTicket) {\n        this.shareTicket = shareTicket;\n        this.showRankListForShare();\n        if(shareTicket && shareTicket != \"\"){\n            // this.titleLabel.string = \"<color=#F1A955><b>群排行</b></c>\";\n            this.titleLabel.string = \"群排行\";\n            this.seeHolkButton.node.active = false;\n            this.startGameButton.node.active = true;\n        }else {\n            this.titleLabel.string = \"好友排行\";\n            this.seeHolkButton.node.active = true;\n            this.startGameButton.node.active = false;\n        }\n    },\n    onRankButton : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"groupRankAtRank\"]);\n        var shareType = double.Share.onShareType.clickStatShareTypeRankList;\n        double.Share.shareWithType(shareType);\n    },\n    onStartButton : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"startGameAtRank\"]);\n        this.hideBackButton();\n        var curScene = cc.director.getScene();\n        if (curScene.name == 'double_main'){\n            ty.NotificationCenter.trigger(double.EventType.GAME_START,\"start\");\n        }else {\n            var sceneName = 'double_main';\n            var onLaunched = function () {\n            };\n            cc.director.loadScene(sceneName,onLaunched);\n        }\n        this.node.destroy();\n    },\n    start :function() {\n    },\n    onDestroy : function () {\n        double.gameModel.rankWindow = null;\n        ty.NotificationCenter.ignoreScope(this);\n        this.unscheduleAllCallbacks();\n    },\n    hideBackButton : function () {\n        this.backButton.node.active = false;\n    },\n\n    showBackButton : function () {\n        this.backButton.node.active = true;\n    }\n});\n"]}
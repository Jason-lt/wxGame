{"version":3,"sources":["../../../../../../assets/Script/hall/utils/assets/Script/hall/utils/AdManager.js"],"names":["hall","adManager","videoAdId","rewardedVideoType","videoAdManager","checkVideoTime","retryCrossTimes","retryBannerTimes","AnimType","STATIC","SHAKE","FRAME","adNodeList","bannerNodeList","allAdInfoList","allBannerInfoList","rawAdInfoList","rawBannerInfoList","showRewardedVideo","type","wx","hasOwnProperty","ty","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeWatchVideo","LOGW","NotificationCenter","trigger","double","EventType","REWARD_VIDEO_COMPLETE_ERROR","destroyBannerAd","onvVdClose","res","LOGD","playEnded","isEnded","REWARD_VIDEO_COMPLETE","offClose","canPlay","checkVideoAd","show","onClose","createRewardedVideoAd","adUnitId","load","then","catch","err","JSON","stringify","setTimeout","getSysInfo","sysInfo","getSystemInfoSync","canShowBanner","showBannerAd","adid","refresh","GameWorld","gunnerShareSchemeConfig","showBanner","screenWidth","screenHeight","top","curBannerAd","createBannerAd","style","left","width","onResize","height","systemType","SYSTEMTYPE","iPhoneXType","hideBannerAd","hide","destroy","showAd","position","tag","_adnode","adNodeClass","adInfoList","parse","adType","adTag","createAdNode","push","getAdNodeList","getAdNodeByTag","n","toString","getBannerNodeList","getBannerNodeByTag","getAdInfoList","getBannerInfoList","adIconBtn","currentAdInfo","currentWebPage","adNodeObj","pos","genRandomFirstAdInfo","active","that","cc","loader","loadRes","prefab","preFabNode","instantiate","_pos","x","y","p","zIndex","game","addPersistRootNode","adIconNode","adButton","getChildByName","on","onClickAdIconBtn","length","weight_list","i","_randomObj","parseInt","icon_weight","icon_id","sort","a","b","weight","_total","forEach","element","_randomIndex","Math","random","_tTotal","_selectIndex","_selectObj","id","genRandomSecondAdInfo","_webPages","webpages","webpage_weight","config_id","_animaType","icon_type","spriteIco","stopAllActions","removeComponent","Animation","setRotation","url","icon_url","texture","getComponent","Sprite","spriteFrame","SpriteFrame","setContentSize","size","error","anchorX","anchorY","_act1","rotateBy","_act2","_act3","_act4","_delay","delayTime","runAction","repeatForever","sequence","repeat","allFrames","playFrameAction","_firstFrameIcon","getTexture","_time_interval","time_interval","_frameRate","animation","addComponent","clip","AnimationClip","createWithSpriteFrames","name","wrapMode","WrapMode","Loop","addClip","play","results","log","getError","getContent","_frame","GlobalFuncs","setInLocalStorage","gameModel","OPEN_ADBTN_TYPE_TODAY","skip_type","icon_skip_type","toappid","togame","topath","path","second_toappid","webpage_url","webpage_id","bi_paramlist","clickStatEventTypeClickAdBtn","navigateToMiniProgram","appId","envVersion","extraData","from","success","clickStatEventTypeClickDirectToMiniGameSuccess","fail","clickStatEventTypeClickDirectToMiniGameFail","complete","resetBtnIcon","console","clickStatEventTypeClickShowQRCode","previewImage","current","urls","onForeGround","showAdNode","hideAdNode","freshAdIconByTime","_adNode","freshAdBannerByTime","startFreshAdIcon","icon_interval","_icon_interval","Timer","cancelTimer","director","setTimer","macro","REPEAT_FOREVER","banner_interval","getConfigSignStr","reqObj","sortedKeys","Object","keys","signStr","key","finalSign","hex_md5","requestADInfo","timeStamp","Date","getTime","act","time","game_mark","SystemInfo","cloudid","gameId","paramStrList","finalUrl","shareManagerUrlShare","join","request","method","statusCode","ret","data","retmsg","processRawConfigInfo","LOGE","requestBannerInfo","requestLocalIPInfo","_url","loc","ipLocInfo","isInBSGS","checkBSGS","_locProvince","v","undefined","floor","isForbidden","province","Array","_iProvince","indexOf","init","prototype"],"mappings":"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","file":"AdManager.js","sourceRoot":"../../../../../../assets/Script/hall/utils","sourcesContent":["/**\n * 导量广告ICO\n * Created by xujing on 2018/5/16.\n */\nhall.adManager = {\n    // icoBtn:null,\n    // openBoxVideoAdId:\"adunit-7771c980013f4603\",\n    // addBulletVideoAdId:\"adunit-0f8c4455096206d1\",\n    // resurgenceVideoAdId:\"adunit-547bbb5117a6e8ae\",\n    videoAdId : \"adunit-547bbb5117a6e8ae\",\n    rewardedVideoType:\"\",\n    videoAdManager : null,\n    checkVideoTime : 300000,\n\n\n    retryCrossTimes : 3, //3次网络重试的机会\n    retryBannerTimes : 3, //3次网络重试的机会\n\n    AnimType : {\n        STATIC : 1, //静态\n        SHAKE  : 2, //抖动\n        FRAME  : 3  //帧动画\n\n    },\n\n    adNodeList :[],         //存放icon节点列表\n    bannerNodeList : [],    //存放banner节点列表\n    allAdInfoList : [],     //存放icon信息列表\n    allBannerInfoList : [], //存放banner信息列表\n    rawAdInfoList : [],     //存放服务端返回的原始icon信息\n    rawBannerInfoList : [], //存放服务端返回的原始banner信息\n\n    /**\n     * 播放激励广告视频\n     * @param type\n     */\n    showRewardedVideo:function (type) {\n\n        this.rewardedVideoType = type;\n\n        // var adId = 'adunit-8bde7ac62d379503';\n        if (!wx.hasOwnProperty('createRewardedVideoAd')){\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo,\n                [\"no_support\",type]);\n            hall.LOGW(null, '玩家基础库,不支持激励广告视频!');\n            ty.NotificationCenter.trigger(double.EventType.REWARD_VIDEO_COMPLETE_ERROR,'您的微信版本过低,请升级至6.6.6以上');\n            return;\n        }\n\n        this.destroyBannerAd();\n\n        // if (!this.videoAdManager){\n        //     this.videoAdManager = wx.createRewardedVideoAd({\n        //         adUnitId: hall.adManager.videoAdId\n        //     });\n        // }\n\n        var onvVdClose = function (res) {\n            double.LOGD(null, '广告播放完毕!');\n            var playEnded = (!res || (res && res.isEnded));\n            if(!playEnded){\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo,\n                    [\"noComplete\",type]);\n            }else {\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo,\n                    [\"success\",type]);\n            }\n            //只有播放完成才发奖\n            ty.NotificationCenter.trigger(double.EventType.REWARD_VIDEO_COMPLETE, playEnded);\n            hall.adManager.videoAdManager.offClose(onvVdClose);\n            hall.adManager.canPlay = false;\n            hall.adManager.checkVideoAd();\n        };\n\n        if (hall.adManager.canPlay){\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo, [\"begin\", type]);\n            hall.adManager.videoAdManager.show();\n            this.destroyBannerAd();\n            hall.adManager.videoAdManager.onClose(onvVdClose);\n        }else{\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo, [\"fail\", type]);\n            ty.NotificationCenter.trigger(double.EventType.REWARD_VIDEO_COMPLETE, true);\n        }\n        // videoAd.load().then(function () {\n        //     ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo,\n        //         [\"begin\",type]);\n        //     videoAd.show();\n        //     videoAd.onClose(onvVdClose);\n        // }).catch(function (err) {\n        //     videoAd.load().then(function () {\n        //         ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo,\n        //             [\"begin\",type]);\n        //         videoAd.show();\n        //         videoAd.onClose(onvVdClose);\n        //     }).catch(function (err) {\n        //         ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo,\n        //             [\"fail\",type]);\n        //         if (err.errMsg == 'no advertisement'){\n        //             err.errMsg = '系统繁忙、或网络状态较差,请稍后重试!';\n        //         }\n        //         ty.NotificationCenter.trigger(double.EventType.REWARD_VIDEO_COMPLETE_ERROR, err.errMsg);\n        //         double.LOGD(null, err.errMsg)\n        //     });\n        // });\n    },\n\n    checkVideoAd:function () {\n        if (!wx.hasOwnProperty('createRewardedVideoAd')){\n            hall.adManager.canPlay = false;\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeWatchVideo, [\"not support\"]);\n            hall.LOGW(null, '玩家基础库,不支持激励广告视频!');\n            return;\n        }\n\n        if (!this.videoAdManager){\n            this.videoAdManager = wx.createRewardedVideoAd({\n                adUnitId: hall.adManager.videoAdId\n            });\n        }\n\n        this.videoAdManager.load().then(function () {\n            hall.LOGW(\"====== 成功获取广告\");\n            hall.adManager.canPlay = true;\n        }).catch(function (err) {\n            hall.LOGW(\"====== 获取广告失败,继续获取\", JSON.stringify(err));\n            hall.adManager.canPlay = false;\n\n            setTimeout(function () {\n                hall.adManager.checkVideoAd();\n            }, hall.adManager.checkVideoTime);\n        });\n    },\n\n    getSysInfo:function () {\n        if (!this.sysInfo){\n            this.sysInfo = wx.getSystemInfoSync();\n        }\n        return this.sysInfo;\n    },\n\n    canShowBanner:function () {\n        return wx.hasOwnProperty('createBannerAd');\n    },\n    /**\n     * 展示Banner广告\n     * @param adid 广告ID\n     */\n    showBannerAd:function (adid,refresh) {\n        if(!double.GameWorld.gunnerShareSchemeConfig || !double.GameWorld.gunnerShareSchemeConfig.showBanner){\n            return;\n        }\n        if (!this.canShowBanner){\n            hall.LOGW(null, '玩家基础库,不支持banner!');\n            return;\n        }\n\n        var sysInfo = this.getSysInfo();\n        var screenWidth = sysInfo.screenWidth;\n        var screenHeight = sysInfo.screenHeight;\n\n        // this.destroyBannerAd();\n\n        hall.LOGW('showBannerAd', '当前屏幕宽度:' + screenWidth + \"; screenHeight:\" + screenHeight);\n\n        var top = 0;\n        if(!double.curBannerAd){\n            double.curBannerAd = wx.createBannerAd({\n                adUnitId: adid,\n                style: {\n                    left:0,\n                    top:top,\n                    width: screenWidth\n                }\n            });\n        }else {\n            if(refresh){\n                this.destroyBannerAd();\n                double.curBannerAd = wx.createBannerAd({\n                    adUnitId: adid,\n                    style: {\n                        left:0,\n                        top:top,\n                        width: screenWidth\n                    }\n                });\n            }\n        }\n        // double.curBannerAd = wx.createBannerAd({\n        //     adUnitId: adid,\n        //     style: {\n        //         left:0,\n        //         top:top,\n        //         width: screenWidth\n        //     }\n        // });\n\n        double.curBannerAd.onResize(function (res) {\n            hall.LOGW('showBannerAd', '当前banner,width:' + res.width + \"; height:\" + res.height);\n            if(double.curBannerAd){\n                // double.curBannerAd.style.left = (screenWidth - res.width)/2;\n                // double.curBannerAd.style.left = 0;\n                // double.curBannerAd.style.top = screenHeight - res.height + 1+75;\n                // double.curBannerAd.style.top = screenHeight - 80;\n                // top = res.height > 92 ? 92 : res.height;\n\n                double.curBannerAd.style.left = 0;\n                top = res.height;\n                if(ty.UserInfo.systemType == ty.UserInfo.SYSTEMTYPE.iPhoneXType){\n                    double.curBannerAd.style.top = screenHeight- top - 30;\n                }else {\n                    double.curBannerAd.style.top = screenHeight- top;\n                }\n            }\n        });\n\n        double.curBannerAd.show();\n    },\n\n    hideBannerAd : function () {\n        if(double.curBannerAd){\n            double.curBannerAd.hide();\n        }\n    },\n\n    destroyBannerAd:function () {\n        if (double.curBannerAd){\n            double.curBannerAd.destroy();\n            double.curBannerAd = null;\n        }\n    },\n\n    //交叉导流\n\n    //创建导流icon，每调用一次就会创建一个\n    showAd: function(position, tag) {\n\n        var _adnode = new hall.adManager.adNodeClass();\n        _adnode.adInfoList = JSON.parse(JSON.stringify(hall.adManager.allAdInfoList));\n        _adnode.adType = 1;\n        _adnode.adTag = tag;\n\n        _adnode.createAdNode(position);\n\n        hall.adManager.adNodeList.push(_adnode);\n\n    },\n\n    //创建导流banner, 每调用一次就会创建一个\n    showBanner: function (position, tag) {\n\n        var _adnode = new hall.adManager.adNodeClass();\n        _adnode.adInfoList = JSON.parse(JSON.stringify(hall.adManager.allBannerInfoList));\n        _adnode.adType = 2;\n        _adnode.adTag = tag;\n\n        _adnode.createAdNode(position);\n\n        hall.adManager.bannerNodeList.push(_adnode);\n\n    },\n\n    //获取所有导流icon节点的列表\n    getAdNodeList : function () {\n        return this.adNodeList;\n    },\n\n    //根据自定义的tag, 获取添加到界面上的导流icon节点\n    getAdNodeByTag : function (tag) {\n\n        if(!tag) return null;\n        for(var n in this.adNodeList){\n            if(this.adNodeList[n].adTag.toString() == tag.toString()){\n                return this.adNodeList[n];\n            }\n\n        }\n        return null;\n    },\n\n    //获取所有导流banner节点的列表\n    getBannerNodeList : function () {\n        return this.bannerNodeList;\n    },\n\n    //根据自定义的tag, 获取添加导界面上的导流banner节点\n    getBannerNodeByTag : function (tag) {\n\n        if(!tag) return null;\n        for(var n in this.bannerNodeList){\n            if(this.bannerNodeList[n].adTag.toString() == tag.toString()){\n                return this.bannerNodeList[n];\n            }\n\n        }\n        return null;\n    },\n\n    //获取当前所有导流icon的信息\n    getAdInfoList : function () {\n        return this.allAdInfoList;\n    },\n\n    //获取当前所有导流banner的信息\n    getBannerInfoList :function () {\n        return this.allBannerInfoList;\n    },\n\n    adNodeClass : function () {\n        this.adType = 0; //1 icon   2 banner\n        this.adIconBtn = null;\n        this.currentAdInfo = null;\n        this.currentWebPage = null;\n        this.adInfoList = [];\n        this.adTag = '';\n    },\n\n    adNodeObj  : {\n\n\n        createAdNode : function (pos) {\n\n            this.genRandomFirstAdInfo();\n\n            if(!this.currentAdInfo){\n                return;\n            }\n\n            if(this.adIconBtn) {\n                this.adIconBtn.active = true;\n            } else {\n                var that = this;\n                //动态加载资源必须放在resources目录下,导流入口强制命名为adNode,放在resources/prefabs下\n                cc.loader.loadRes('double_prefabs/adNode', function (err, prefab) {\n                    var preFabNode = cc.instantiate(prefab);\n\n                    var _pos = pos?pos:{x:0, y:0};\n\n                    preFabNode.position = cc.p(_pos.x, _pos.y);\n                    that.adIconBtn = preFabNode;\n                    preFabNode.zIndex = 999;\n                    cc.game.addPersistRootNode(preFabNode);\n                    that.adIconNode();\n                    var adButton = that.adIconBtn.getChildByName('adButton');\n                    adButton.on('click', function () {\n                        that.onClickAdIconBtn();\n                    });\n                });\n            }\n\n        },\n\n        genRandomFirstAdInfo : function() {\n\n            var that = this;\n\n            if(this.adInfoList.length == 0){\n                return;\n            }\n\n            var weight_list = [\n                {\n                    'weight':0,\n                    'id':'000'\n                }\n            ];\n\n            for(var i in this.adInfoList){\n\n                var _randomObj = {\n                    'weight' : parseInt(that.adInfoList[i].icon_weight),\n                    'id' : that.adInfoList[i].icon_id,\n                };\n                weight_list.push(_randomObj);\n            }\n\n            weight_list.sort(function(a, b){\n                return a.weight > b.weight;\n            });\n\n            var _total = 0;\n\n            weight_list.forEach(function (element){\n                _total += element.weight;\n            });\n\n            var _randomIndex = parseInt(Math.random()*10000)%(_total+1);\n\n            var _tTotal = 0;\n\n            var _selectIndex = 0;\n\n            for(var i=0; i<(weight_list.length-1);i++){\n                _tTotal += weight_list[i].weight;\n                if(_tTotal < _randomIndex && (_tTotal+weight_list[i+1].weight) >= _randomIndex){\n                    _selectIndex = i+1;\n                    break;\n                }\n            }\n            var _selectObj= weight_list[_selectIndex];\n\n            this.adInfoList.forEach(function (element){\n                if(element.icon_id == _selectObj.id){\n                    that.currentAdInfo = element;\n                }\n            });\n\n        },\n\n        genRandomSecondAdInfo : function() {\n\n            var that = this;\n\n            var _webPages = this.currentAdInfo.webpages;\n\n            if(typeof _webPages === 'undefined' || _webPages.length == 0){\n                return;\n            }\n\n            var weight_list = [{'weight':0, 'id':'000'}];\n\n            for(var i in _webPages){\n\n                var _randomObj = {\n                    'weight' : parseInt(_webPages[i].webpage_weight),\n                    'id' : _webPages[i].config_id\n                }\n\n                weight_list.push(_randomObj);\n            }\n\n            weight_list.sort(function(a, b){\n                return a.weight > b.weight;\n            });\n\n            var _total = 0;\n\n            weight_list.forEach(function (element){\n                _total += element.weight;\n            });\n\n            var _randomIndex = parseInt(Math.random()*10000)%(_total+1);\n\n            var _tTotal = 0;\n\n            var _selectIndex = 0;\n            for(var i=0; i<(weight_list.length-1);i++){\n                _tTotal +=  weight_list[i].weight;\n                if(_tTotal < _randomIndex && (_tTotal+weight_list[i+1].weight) >= _randomIndex){\n                    _selectIndex = i+1;\n                    break;\n                }\n            }\n            var _selectObj = weight_list[_selectIndex];\n\n\n            _webPages.forEach(function(element){\n                if(element.config_id == _selectObj.id){\n                    that.currentWebPage = element;\n                }\n            });\n\n        },\n\n\n        adIconNode : function () {\n            if(!this.currentAdInfo || !this.adIconBtn){\n                return;\n            }\n            var _animaType = this.currentAdInfo.icon_type;\n            var that = this;\n\n            // var spriteIco = this.adIconBtn.getChildByName('adIcon');\n            // var adButton = this.adIconBtn.getChildByName('adButton');\n\n            var spriteIco = this.adIconBtn.getChildByName('adIconNode').getChildByName('adIcon');  \n            var adButton = this.adIconBtn.getChildByName('adButton');\n\n            spriteIco.stopAllActions();\n            spriteIco.removeComponent(cc.Animation);\n\n            spriteIco.setRotation(0);\n\n            // hall.LOGE(\"===\",\"===SHAKE==_animaType=====\"+_animaType);\n\n            // tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeShowAdBtn, [that.currentAdInfo.icon_id,\n            //     '0',\n            //     '',\n            //     that.currentAdInfo.toappid,\n            //     that.currentAdInfo.togame,\n            //     '0',\n            //     that.adType]);\n            switch (_animaType){\n\n                case hall.adManager.AnimType.STATIC:\n\n                    cc.loader.load({url: that.currentAdInfo.icon_url[0]}, function (err, texture) {\n                        if (!err) {\n\n                            spriteIco.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n                            if(texture && texture.width && texture.height){\n                                spriteIco.setContentSize(cc.size(texture.width, texture.height));\n                                adButton.setContentSize(cc.size(texture.width, texture.height));\n                            }\n                        }\n                        else {\n\n                        }\n                    });\n\n                    break;\n                case hall.adManager.AnimType.SHAKE:\n                    // hall.LOGE(\"===\",\"===SHAKE==hall.adManager.AnimType.SHAKE=====\"+that.currentAdInfo.icon_url[0]);\n\n                    cc.loader.load({url:that.currentAdInfo.icon_url[0]}, function(error, texture){\n                        // if(error){\n                        //     hall.LOGE(\"===\",\"===SHAKE==error=====\"+JSON.stringify(error));\n                        // }\n                        // hall.LOGE(\"===\",\"===SHAKE==texture=====\"+texture);\n\n                        spriteIco.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n                        if(texture && texture.width && texture.height){\n                            spriteIco.setContentSize(cc.size(texture.width, texture.height));\n                            adButton.setContentSize(cc.size(texture.width, texture.height));\n                        }\n                        // hall.LOGE(\"===\",\"===SHAKE==texture==width===width===\"+texture.width+\"===\"+texture.height);\n                        spriteIco.anchorX = 0.5;\n                        spriteIco.anchorY = 0.5;\n                        var _act1 = cc.rotateBy(0.06, -20);\n                        var _act2 = cc.rotateBy(0.12, 40);\n                        var _act3 = cc.rotateBy(0.12, -40);\n                        var _act4 = cc.rotateBy(0.06, 20);\n                        var _delay = cc.delayTime(1);\n                        spriteIco.runAction(cc.repeatForever(cc.sequence(_act1,\n                            cc.repeat(cc.sequence(_act2, _act3), 4),\n                            _act4,\n                            _delay)));\n                    });\n\n\n                    break;\n                case hall.adManager.AnimType.FRAME:\n\n                    var allFrames =[];\n\n                    var playFrameAction = function () {\n                        spriteIco.stopAllActions();\n                        spriteIco.removeComponent(cc.Animation);\n                        var _firstFrameIcon = allFrames[0].getTexture();\n                        if (_firstFrameIcon && _firstFrameIcon.width && _firstFrameIcon.height) {\n                            spriteIco.setContentSize(cc.size(_firstFrameIcon.width, _firstFrameIcon.height));\n                            adButton.setContentSize(cc.size(_firstFrameIcon.width, _firstFrameIcon.height))\n                        }\n\n                        var _time_interval = that.currentAdInfo.time_interval;\n                        var _frameRate = (_time_interval && _time_interval>0)? 1000/_time_interval :10;\n\n                        var animation = spriteIco.addComponent(cc.Animation);\n                        var clip = cc.AnimationClip.createWithSpriteFrames(allFrames, _frameRate);\n                        clip.name = 'anim_frame';\n                        clip.wrapMode = cc.WrapMode.Loop;\n                        animation.addClip(clip);\n                        animation.play('anim_frame');\n                    };\n\n                    cc.loader.load(that.currentAdInfo.icon_url,function (err, results) {\n\n                        if (err) {\n                            for (var i = 0; i < err.length; i++) {\n                                cc.log('Error url [' + err[i] + ']: ' + results.getError(err[i]));\n                            }\n                        }\n\n                        for(var i = 0; i < that.currentAdInfo.icon_url.length; i++) {\n                            if(results.getContent(that.currentAdInfo.icon_url[i])) {\n                                var _frame = new cc.SpriteFrame(results.getContent(that.currentAdInfo.icon_url[i]));\n                                allFrames.push(_frame);\n                            }\n                        }\n\n                        playFrameAction();\n                    });\n\n                    break;\n                default:\n                    break;\n\n            }\n\n        },\n\n        onClickAdIconBtn: function() {\n            hall.GlobalFuncs.setInLocalStorage(double.gameModel.OPEN_ADBTN_TYPE_TODAY,'CO');\n\n            try {\n\n                this.genRandomSecondAdInfo();\n\n                //先尝试直接跳转\n                var skip_type =  this.currentAdInfo.icon_skip_type;\n                var toappid = this.currentAdInfo.toappid;\n                var togame = this.currentAdInfo.togame;\n                var topath = this.currentAdInfo.path;\n                var second_toappid = this.currentAdInfo.second_toappid;\n\n                hall.LOGW('topath ====>' + topath);\n\n                var that = this;\n\n                var icon_id = this.currentAdInfo.icon_id;\n                var config_id = '0';\n                var webpage_url = '';\n                var webpage_id = '0';\n\n                if(this.currentWebPage && 1 == this.adType){\n                    webpage_url = this.currentWebPage.webpage_url;\n                    config_id = this.currentWebPage.config_id;\n                    webpage_id = this.currentWebPage.webpage_id;\n                }\n\n                var bi_paramlist = [icon_id, config_id, webpage_url, toappid, togame, webpage_id, that.adType];\n\n                hall.LOGW('bi_paramlist ====> ' + JSON.stringify(bi_paramlist));\n\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickAdBtn, bi_paramlist);\n\n\n                // //先尝试直接跳转\n                if(wx && wx.navigateToMiniProgram){\n                    if(1 == skip_type){\n\n                        wx.navigateToMiniProgram({\n                            appId: toappid,\n                            path : topath ? topath : '?from=adcross',\n                            envVersion: 'release',\n                            extraData: {\n                                from: topath ? topath : '?from=adcross',\n                            },\n                            success: function(res) {\n\n                                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameSuccess, bi_paramlist);\n\n                                hall.LOGW('wx.navigateToMiniProgram success');\n                                hall.LOGW(res);\n                            },\n                            fail: function (res) {\n                                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameFail, bi_paramlist);\n                                hall.LOGW('wx.navigateToMiniProgram fail');\n                                hall.LOGW(res);\n                            },\n                            complete: function (res) {\n                                hall.LOGW('navigateToMiniProgram ==== complete');\n                                that.resetBtnIcon();\n                            }\n                        });\n\n                        return;\n                    }else if(2 == skip_type){\n                        wx.navigateToMiniProgram({\n                            appId: second_toappid,\n                            path : topath ? topath : '?from=adcross',\n                            envVersion: 'release',\n                            extraData: {\n                                from: topath ? topath : '?from=adcross',\n                            },\n                            success: function(res) {\n                                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameSuccess, bi_paramlist);\n                                hall.LOGW('wx.navigateToMiniProgram success');\n                                hall.LOGW(res);\n                            },\n                            fail: function (res) {\n                                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickDirectToMiniGameFail, bi_paramlist);\n                                hall.LOGW('wx.navigateToMiniProgram fail');\n                                hall.LOGW(res);\n                            },\n                            complete: function (res) {\n                                that.resetBtnIcon();\n                                hall.LOGW('navigateToMiniProgram ==== complete');\n                            }\n                        });\n\n                    }else{\n                        console.error('Unsupported skip type! Please Check!');\n                    }\n\n                    return;\n                }\n\n                //直接跳转接口不好使，展示 小程序/小游戏 二维码图片\n\n                if(!that.currentWebPage || !that.currentWebPage.webpage_url){\n                    that.resetBtnIcon();\n                    return;\n                }\n\n                ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeClickShowQRCode, bi_paramlist);\n\n                // if(tywx.IsWechatPlatform()) {\n                    wx.previewImage({\n                        current: [that.currentWebPage.webpage_url],\n                        urls: [that.currentWebPage.webpage_url],\n                        success:function(res){\n                            hall.LOGD(null, \"预览图片成功！\");\n                        },\n                        fail:function (res) {\n                            hall.LOGD(null, \"预览图片失败！\");\n                        },\n                        complete :function (res) {\n                            hall.LOGW('预览图片完成');\n                            that.resetBtnIcon();\n                        }\n                    });\n                // }\n            } catch(err) {\n                hall.LOGW(\"error:\", \"tywx.AdManager.onClickAdIconBtn——\" + JSON.stringify(err));\n            }\n        },\n\n        resetBtnIcon : function() {\n\n            if(!this.adIconBtn){\n                return;\n            }else{\n                this.genRandomFirstAdInfo();\n                this.adIconNode();\n            }\n\n        },\n\n        onForeGround : function () {\n            this.adIconNode();\n        },\n\n        showAdNode : function () {\n            if(this.adIconBtn){\n                if(this.adIconBtn) {\n                    this.adIconBtn.active = true;\n                }\n            }\n\n        },\n\n        hideAdNode : function () {\n\n            if(this.adIconBtn){\n                if(this.adIconBtn) {\n                    this.adIconBtn.active = false;\n                }\n            }\n\n        }\n\n    },\n\n    //定时刷新导流icon\n    freshAdIconByTime : function () {\n\n        hall.adManager.adNodeList.forEach(function (_adNode) {\n            _adNode && _adNode.resetBtnIcon && _adNode.resetBtnIcon();\n        });\n    },\n\n    //定时刷新导流banner\n    freshAdBannerByTime :function () {\n        hall.adManager.bannerNodeList.forEach(function (_adNode) {\n            _adNode && _adNode.resetBtnIcon && _adNode.resetBtnIcon();\n        });\n    },\n\n    //开始定时刷新导流icon\n    startFreshAdIcon :function () {\n\n        //定时刷新icon\n        var icon_interval = 10 ;//默认是10s刷新一次\n        for(var i=0; i< this.allAdInfoList.length;i++){\n            var _icon_interval = this.allAdInfoList[i].icon_interval;\n            if(_icon_interval){\n                icon_interval = parseInt(_icon_interval) > 0?  parseInt(_icon_interval):icon_interval;\n                break;\n            }\n        }\n        ty.Timer.cancelTimer(cc.director, hall.adManager.freshAdIconByTime);\n        ty.Timer.setTimer(cc.director, hall.adManager.freshAdIconByTime,icon_interval, cc.macro.REPEAT_FOREVER,icon_interval);\n\n        //定时刷新banner\n        var banner_interval = 10 ;//默认是10s刷新一次\n        for(var i=0; i< this.allBannerInfoList.length;i++){\n            var _icon_interval = this.allBannerInfoList[i].icon_interval;\n            if(_icon_interval){\n                banner_interval = parseInt(_icon_interval) > 0?  parseInt(_icon_interval):banner_interval;\n                break;\n            }\n        }\n        ty.Timer.cancelTimer(cc.director, hall.adManager.freshAdBannerByTime);\n        ty.Timer.setTimer(cc.director, hall.adManager.freshAdBannerByTime,banner_interval, cc.macro.REPEAT_FOREVER,banner_interval);\n\n    },\n\n    //从后台回到前台\n    onForeGround : function () {\n\n        this.freshAdIconByTime();\n        this.freshAdBannerByTime();\n        this.startFreshAdIcon();\n    },\n\n    /**\n     * 计算签名字符串\n     * @param reqObj\n     * @returns {string}\n     */\n    getConfigSignStr: function(reqObj) {\n        var sortedKeys = Object.keys(reqObj).sort();\n        var signStr = '';\n        for(var i=0;i<sortedKeys.length;i++){\n            var key = sortedKeys[i];\n            if(key == 'act' || key == 'sign') {\n                continue;\n            } else {\n                signStr += key + '=' + reqObj[key];\n            }\n        }\n        var finalSign = hall.hex_md5('market.tuyoo.com-api-' + signStr + '-market.tuyoo-api') || '';\n        return finalSign;\n    },\n\n    /**\n     * 请求交叉倒流的信息\n     */\n    requestADInfo : function () {\n        try {\n            // if(!tywx.IsWechatPlatform()) {\n            //     return;\n            // }\n            this.retryCrossTimes--;\n            var reqObj = {};\n            var timeStamp = new Date().getTime();\n            reqObj.act = 'api.getCrossConfig';\n            reqObj.time = timeStamp;\n            reqObj.game_mark = ty.SystemInfo.cloudid + \"-\" + ty.SystemInfo.gameId;\n            var signStr = this.getConfigSignStr(reqObj);\n            var paramStrList = [];\n            for(var key in reqObj) {\n                paramStrList.push(key + '=' + reqObj[key]);\n            }\n            paramStrList.push('sign=' + signStr);\n            var finalUrl = ty.SystemInfo.shareManagerUrlShare + '?' + paramStrList.join('&');\n            var that = this;\n\n            wx.request({\n                url : finalUrl,\n                method : 'GET',\n                success : function (res) {\n                    if (res.statusCode == 200){\n\n                        var ret = res.data;\n                        that.allAdInfoList = [];\n                        if(ret.retmsg){\n                            that.rawAdInfoList = ret.retmsg;\n                            that.processRawConfigInfo();\n                            // tywx.NotificationCenter.trigger(tywx.EventType.GET_ADMANAGER_ICON_INFO_SUCCESS);\n                        }\n                        that.retryCrossTimes=3;\n\n                    }else{\n                        if(that.retryCrossTimes >0) {\n                            that.requestADInfo();\n                        }else{\n                            that.retryCrossTimes = 3;\n                        }\n                    }\n\n                },\n                fail : function (res) {\n\n                    if(that.retryCrossTimes >0) {\n                        that.requestADInfo();\n                    }else{\n                        that.retryCrossTimes = 3;\n                    }\n                }\n            });\n        } catch(err) {\n            hall.LOGE(\"error:\", \"tywx.AdManager.requestADInfo——\" + JSON.stringify(err));\n        }\n    },\n\n\n    /**\n     * 请求交叉倒流banner的信息\n     */\n    requestBannerInfo : function () {\n        try {\n            // if(!tywx.IsWechatPlatform()) {\n            //     return;\n            // }\n            this.retryBannerTimes--;\n            var reqObj = {};\n            var timeStamp = new Date().getTime();\n            reqObj.act = 'api.getBannerConfig';\n            reqObj.time = timeStamp;\n            reqObj.game_mark = ty.SystemInfo.cloudid + \"-\" + ty.SystemInfo.gameId;\n            var signStr = this.getConfigSignStr(reqObj);\n            var paramStrList = [];\n            for(var key in reqObj) {\n                paramStrList.push(key + '=' + reqObj[key]);\n            }\n            paramStrList.push('sign=' + signStr);\n            var finalUrl = ty.SystemInfo.shareManagerUrlShare + '?' + paramStrList.join('&');\n            var that = this;\n\n            wx.request({\n                url : finalUrl,\n                method : 'GET',\n                success : function (res) {\n                    if (res.statusCode == 200){\n\n                        var ret = res.data;\n                        that.allBannerInfoList = [];\n                        if(ret.retmsg){\n                            that.rawBannerInfoList = ret.retmsg;\n                            that.processRawConfigInfo();\n                            // ty.NotificationCenter.trigger(tywx.EventType.GET_ADMANAGER_BANNER_INFO_SUCCESS);\n                        }\n                        that.retryBannerTimes=3;\n\n                    }else{\n                        if(that.retryBannerTimes>0) {\n                            that.requestBannerInfo();\n                        }else{\n                            that.retryBannerTimes=3;\n                        }\n                    }\n\n                },\n                fail : function (res) {\n\n                    if(that.retryBannerTimes >0) {\n                        that.requestBannerInfo();\n                    }else{\n                        that.retryBannerTimes = 3;\n                    }\n                }\n            });\n        } catch(err) {\n            hall.LOGE(\"error:\", \"tywx.AdManager.requestADInfo——\" + JSON.stringify(err));\n        }\n    },\n\n    /**\n     * 请求本地的IP、地域等信息\n     */\n    requestLocalIPInfo : function () {\n        var that = this;\n        var _url = 'https://iploc.ywdier.com/api/iploc5/search/city';\n        wx.request({\n            url: _url,\n            success: function (res) {\n                if (res.statusCode == 200) {\n                    if (res.data && res.data.loc) {\n                        that.ipLocInfo = res.data;\n                    }\n\n                    that.processRawConfigInfo();\n                }\n                if(res.data.loc && res.data.loc[2]){\n                    ty.UserInfo.isInBSGS = hall.GlobalFuncs.checkBSGS(res.data.loc[2]); //是否在北上广深\n                }\n                // console.error('requestLocalIPInfo ==>' + JSON.stringify(res));\n            },\n            fail: function (res) {\n            }\n        });\n\n    },\n\n    /**\n     * 处理服务端返回的信息（根据城市白名单等进行过滤筛选）\n     */\n    processRawConfigInfo : function () {\n\n        var that = this;\n        this.allBannerInfoList = [];\n        this.allAdInfoList = [];\n        if(this.ipLocInfo && this.ipLocInfo.loc && this.ipLocInfo.loc[1]){         //获取到了本地的ip信息\n\n            var _locProvince = this.ipLocInfo.loc[1];\n\n            this.rawAdInfoList.forEach(function (v) {\n\n                if(v.icon_weight == undefined || Math.floor(v.icon_weight) <= 0.1){\n                    v.icon_weight = 0;\n                }\n\n                v.icon_weight =10;\n\n                var isForbidden = true;\n                if(v.province && (v.province instanceof Array)){\n\n                    if(v.province.length == 0){\n                        isForbidden = false;\n                    }else {\n                        for (var i in v.province) {\n                            var _iProvince = v.province[i];\n                            if (_iProvince.indexOf(_locProvince) > -1) {          //在允许显示的城市配置内\n                                isForbidden = false;\n                                break;\n                            }\n                        }\n                    }\n                }else{\n                    isForbidden = false;\n                }\n\n                if(!isForbidden){\n                    that.allAdInfoList.push(v);\n                }\n            });\n\n            this.rawBannerInfoList.forEach(function (v) {\n                if(v.icon_weight == undefined || Math.floor(v.icon_weight) <= 0.1){\n                    v.icon_weight = 0;\n                }\n\n                v.icon_weight=10;\n                var isForbidden = true;\n                if(v.province && (v.province instanceof Array)){\n\n                    if(v.province.length == 0){\n                        isForbidden = false;\n                    }else {\n                        for (var i in v.province) {\n                            var _iProvince = v.province[i];\n                            if (_iProvince.indexOf(_locProvince) > -1) {          //在允许显示的城市配置内\n                                isForbidden = false;\n                                break;\n                            }\n                        }\n                    }\n                }else{\n                    isForbidden = false;\n                }\n\n                if(!isForbidden){\n                    that.allBannerInfoList.push(v);\n                }\n            });\n\n        }else{\n\n            this.rawAdInfoList.forEach(function (v) {\n                if(v.icon_weight == undefined || Math.floor(v.icon_weight) <= 0.1){\n                    v.icon_weight = 0;\n                }\n\n                if(!v.province || ((v.province instanceof Array) && v.province.length == 0)){\n                    that.allAdInfoList.push(v);\n                }\n            });\n            this.rawBannerInfoList.forEach(function (v) {\n                if(v.icon_weight == undefined || Math.floor(v.icon_weight) <= 0.1){\n                    v.icon_weight = 0;\n                }\n\n                if(!v.province || ((v.province instanceof Array) && v.province.length == 0)){\n                    that.allBannerInfoList.push(v);\n                }\n            });\n\n        }\n    },\n\n    /**\n     * 初始化交叉导流模块\n     */\n    init : function () {\n        this.requestLocalIPInfo();\n        this.requestADInfo();\n        this.requestBannerInfo();\n\n    }\n};\n\nhall.adManager.adNodeClass.prototype = hall.adManager.adNodeObj;\nhall.adManager.requestADInfo();"]}
{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/component/assets/Script/ComponentScript/component/double_object.js"],"names":["cc","Class","ctor","addScorePool","arrowPool","dajiChengPool","dajiHongPool","dajiHuangPool","dajiLanPool","dajiZongPool","extends","Component","properties","windowWidth","windowHeight","objectSprite","default","type","Sprite","objectSpriteFrameList","SpriteFrame","objectPrefabList","Prefab","dajiChengPrefab","dajiHongPrefab","dajiHuangPrefab","dajiLanPrefab","dajiZongPrefab","moveNode","Node","rotationNode","bombAniNode","gunHitAniNode","arrowPrefab","leftArrowNode","rightArrowNode","arrowSpriteFrameList","arrowIndex","gunSpriteFrame","leftAddScoreNode","rightAddScoreNode","addScorePrefab","rotationSpeed","horizontalSpeed","verticalSpeed","parentScene","serializable","onLoad","winSize","director","getWinSize","width","height","k","addAniNode","NodePool","instantiate","put","getComponent","ty","NotificationCenter","listen","double","EventType","CHANGE_GUN_TYPE","changeGunType","index","GameWorld","weaponType","changeObjectType","spriteFrame","doubleObjectList","indexOf","objectType","objectNowLocationX","x","objectNowLocationY","y","objectNowRotation","rotation","objectInitializedSpeed","node","active","doubleBowNameList","gunType","sendArrowForObject","from","direction","arrowNode","size","get","addChild","reSetArrowSprite","beginSendAnimation","receiveArrow","removeFromParent","vec1","convertToNodeSpace","convertToWorldSpace","position","changeEffectFromWeaponToObject","playAddScoreAnimation","receiveBullet","tempPool","doubleObjectAniPoolList","tempNode","ani","Animation","animation","getAnimationState","getClips","name","once","play","impactForce","Math","sin","cos","addNode","changeLabel","clipName","that","gameBomb","afterObjectBomb","gameOver","removeAllGunHitAniNodeChild","tempNodeList","children","length","stopAction","tempNodeList2","tempNodeList3","update","dt","gamePause","objectAccelerated","gameLevelUp","onDestroy","clear","ignoreScope","unscheduleAllCallbacks"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,UAAO,gBAAY;AACf,aAAKC,YAAL,GAAoB,IAApB;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACA,aAAKC,aAAL,GAAqB,IAArB;AACA,aAAKC,YAAL,GAAoB,IAApB;AACA,aAAKC,aAAL,GAAqB,IAArB;AACA,aAAKC,WAAL,GAAmB,IAAnB;AACA,aAAKC,YAAL,GAAoB,IAApB;AACH,KATI;AAULC,aAASV,GAAGW,SAVP;;AAYLC,gBAAY;;AAERC,qBAAc,CAFN;AAGRC,sBAAe,CAHP;;AAKRC,sBAAe;AACXC,qBAAU,IADC;AAEXC,kBAAOjB,GAAGkB;AAFC,SALP;AASRC,+BAAuB,CAACnB,GAAGoB,WAAJ,CATf;AAURC,0BAAkB,CAACrB,GAAGsB,MAAJ,CAVV;;AAYRC,yBAAkB;AACdP,qBAAU,IADI;AAEdC,kBAAOjB,GAAGsB;AAFI,SAZV;AAgBRE,wBAAiB;AACbR,qBAAU,IADG;AAEbC,kBAAOjB,GAAGsB;AAFG,SAhBT;AAoBRG,yBAAkB;AACdT,qBAAU,IADI;AAEdC,kBAAOjB,GAAGsB;AAFI,SApBV;AAwBRI,uBAAgB;AACZV,qBAAU,IADE;AAEZC,kBAAOjB,GAAGsB;AAFE,SAxBR;AA4BRK,wBAAiB;AACbX,qBAAU,IADG;AAEbC,kBAAOjB,GAAGsB;AAFG,SA5BT;;AAiCR;AACAM,kBAAW;AACPZ,qBAAU,IADH;AAEPC,kBAAOjB,GAAG6B;AAFH,SAlCH;AAsCRC,sBAAe;AACXd,qBAAU,IADC;AAEXC,kBAAOjB,GAAG6B;AAFC,SAtCP;AA0CRE,qBAAc;AACVf,qBAAU,IADA;AAEVC,kBAAOjB,GAAG6B;AAFA,SA1CN;AA8CRG,uBAAgB;AACZhB,qBAAU,IADE;AAEZC,kBAAOjB,GAAG6B;AAFE,SA9CR;;AAmDR;AACAI,qBAAc;AACVjB,qBAAU,IADA;AAEVC,kBAAOjB,GAAGsB;AAFA,SApDN;AAwDRY,uBAAgB;AACZlB,qBAAU,IADE;AAEZC,kBAAOjB,GAAG6B;AAFE,SAxDR;AA4DRM,wBAAiB;AACbnB,qBAAU,IADG;AAEbC,kBAAOjB,GAAG6B;AAFG,SA5DT;AAgERO,8BAAuB,CAACpC,GAAGoB,WAAJ,CAhEf;AAiERiB,oBAAa,CAAC,CAjEN;AAkERC,wBAAiBtC,GAAGoB,WAlEZ;;AAoER;AACAmB,0BAAmB;AACfvB,qBAAU,IADK;AAEfC,kBAAOjB,GAAG6B;AAFK,SArEX;AAyERW,2BAAoB;AAChBxB,qBAAU,IADM;AAEhBC,kBAAOjB,GAAG6B;AAFM,SAzEZ;AA6ERY,wBAAiBzC,GAAGsB,MA7EZ;;AA+ERoB,uBAAgB,CA/ER;AAgFRC,yBAAkB,CAhFV;AAiFRC,uBAAgB,CAjFR;;AAmFRC,qBAAa;AACT7B,qBAAS,IADA;AAET8B,0BAAc;AAFL;AAnFL,KAZP;;AAqGL;;AAEAC,YAAS,kBAAW;AAChB,YAAIC,UAAUhD,GAAGiD,QAAH,CAAYC,UAAZ,EAAd;AACA,aAAKrC,WAAL,GAAmBmC,QAAQG,KAA3B;AACA,aAAKrC,YAAL,GAAoBkC,QAAQI,MAA5B;;AAEA,YAAIC,CAAJ;AACA,YAAIC,UAAJ;;AAEA,aAAKnD,YAAL,GAAoB,IAAIH,GAAGuD,QAAP,EAApB;AACA,aAAKF,IAAI,CAAT,EAAaA,IAAI,EAAjB,EAAsBA,GAAtB,EAA2B;AACvBC,yBAAatD,GAAGwD,WAAH,CAAe,KAAKf,cAApB,CAAb;AACA,iBAAKtC,YAAL,CAAkBsD,GAAlB,CAAsBH,UAAtB;AACH;AACD,aAAKlD,SAAL,GAAiB,IAAIJ,GAAGuD,QAAP,EAAjB;AACA,aAAKF,IAAI,CAAT,EAAaA,IAAI,EAAjB,EAAsBA,GAAtB,EAA2B;AACvBC,yBAAatD,GAAGwD,WAAH,CAAe,KAAKvB,WAApB,CAAb;AACAqB,uBAAWI,YAAX,CAAwB,cAAxB,EAAwCb,WAAxC,GAAsD,IAAtD;AACA,iBAAKzC,SAAL,CAAeqD,GAAf,CAAmBH,UAAnB;AACH;AACD,aAAKjD,aAAL,GAAqB,IAAIL,GAAGuD,QAAP,EAArB;AACA,aAAKF,IAAI,CAAT,EAAaA,IAAI,EAAjB,EAAsBA,GAAtB,EAA2B;AACvBC,yBAAatD,GAAGwD,WAAH,CAAe,KAAKjC,eAApB,CAAb;AACA,iBAAKlB,aAAL,CAAmBoD,GAAnB,CAAuBH,UAAvB;AACH;AACD,aAAKhD,YAAL,GAAoB,IAAIN,GAAGuD,QAAP,EAApB;AACA,aAAKF,IAAI,CAAT,EAAaA,IAAI,EAAjB,EAAsBA,GAAtB,EAA2B;AACvBC,yBAAatD,GAAGwD,WAAH,CAAe,KAAKhC,cAApB,CAAb;AACA,iBAAKlB,YAAL,CAAkBmD,GAAlB,CAAsBH,UAAtB;AACH;AACD,aAAK/C,aAAL,GAAqB,IAAIP,GAAGuD,QAAP,EAArB;AACA,aAAKF,IAAI,CAAT,EAAaA,IAAI,EAAjB,EAAsBA,GAAtB,EAA2B;AACvBC,yBAAatD,GAAGwD,WAAH,CAAe,KAAK/B,eAApB,CAAb;AACA,iBAAKlB,aAAL,CAAmBkD,GAAnB,CAAuBH,UAAvB;AACH;AACD,aAAK9C,WAAL,GAAmB,IAAIR,GAAGuD,QAAP,EAAnB;AACA,aAAKF,IAAI,CAAT,EAAaA,IAAI,EAAjB,EAAsBA,GAAtB,EAA2B;AACvBC,yBAAatD,GAAGwD,WAAH,CAAe,KAAK9B,aAApB,CAAb;AACA,iBAAKlB,WAAL,CAAiBiD,GAAjB,CAAqBH,UAArB;AACH;AACD,aAAK7C,YAAL,GAAoB,IAAIT,GAAGuD,QAAP,EAApB;AACA,aAAKF,IAAI,CAAT,EAAaA,IAAI,EAAjB,EAAsBA,GAAtB,EAA2B;AACvBC,yBAAatD,GAAGwD,WAAH,CAAe,KAAK7B,cAApB,CAAb;AACA,iBAAKlB,YAAL,CAAkBgD,GAAlB,CAAsBH,UAAtB;AACH;;AAEDK,WAAGC,kBAAH,CAAsBC,MAAtB,CAA6BC,OAAOC,SAAP,CAAiBC,eAA9C,EAA8D,KAAKC,aAAnE,EAAiF,IAAjF;AACH,KArJI;;AAuJLA,mBAAgB,uBAAUC,KAAV,EAAiB;AAC7B,YAAGJ,OAAOK,SAAP,CAAiBC,UAAjB,IAA+B,CAAlC,EAAoC;AAAC;AACjC,iBAAK/B,UAAL,GAAkB,CAAC,CAAnB;AACH,SAFD,MAEM;AAAC;AACH,iBAAKA,UAAL,GAAkB6B,KAAlB;AACH;AACJ,KA7JI;;AA+JL;AACAG,sBAAmB,4BAAY;AAC3B;AACA,aAAKtD,YAAL,CAAkBuD,WAAlB,GAAgC,KAAKnD,qBAAL,CAA2B2C,OAAOK,SAAP,CAAiBI,gBAAjB,CAAkCC,OAAlC,CAA0CV,OAAOK,SAAP,CAAiBM,UAA3D,CAA3B,CAAhC;;AAEAX,eAAOK,SAAP,CAAiBO,kBAAjB,GAAsC,CAAtC;AACA,aAAK9C,QAAL,CAAc+C,CAAd,GAAkBb,OAAOK,SAAP,CAAiBO,kBAAnC;AACAZ,eAAOK,SAAP,CAAiBS,kBAAjB,GAAsC,CAAC,KAAK9D,YAAN,GAAmB,CAAnB,GAAqB,GAA3D;AACA,aAAKc,QAAL,CAAciD,CAAd,GAAkBf,OAAOK,SAAP,CAAiBS,kBAAnC;AACAd,eAAOK,SAAP,CAAiBW,iBAAjB,GAAqC,CAArC;AACA,aAAKhD,YAAL,CAAkBiD,QAAlB,GAA6BjB,OAAOK,SAAP,CAAiBW,iBAA9C;;AAEA,aAAKpC,aAAL,GAAqB,EAArB;AACA,aAAKC,eAAL,GAAuB,CAAvB;AACA,aAAKC,aAAL,GAAqBkB,OAAOK,SAAP,CAAiBa,sBAAtC;;AAEA,aAAKC,IAAL,CAAUC,MAAV,GAAmB,IAAnB;;AAEA,aAAKjB,aAAL,CAAmBH,OAAOK,SAAP,CAAiBgB,iBAAjB,CAAmCX,OAAnC,CAA2CV,OAAOK,SAAP,CAAiBiB,OAA5D,CAAnB;AACH,KAlLI;;AAoLLC,wBAAqB,4BAAUC,IAAV,EAAeC,SAAf,EAA0B;AAC3C,YAAIC,SAAJ;AACA,YAAG,KAAKpF,SAAL,CAAeqF,IAAf,KAAwB,CAA3B,EAA6B;AACzBD,wBAAY,KAAKpF,SAAL,CAAesF,GAAf,EAAZ;AACH,SAFD,MAEM;AACFF,wBAAYxF,GAAGwD,WAAH,CAAe,KAAKvB,WAApB,CAAZ;AACAuD,sBAAU3C,WAAV,GAAwB,IAAxB;AACH;AACD2C,kBAAUb,CAAV,GAAc,CAAd;AACAa,kBAAUX,CAAV,GAAc,CAAd;AACA,YAAGS,IAAH,EAAQ;AACJ,iBAAKnD,cAAL,CAAoBwD,QAApB,CAA6BH,SAA7B;AACH,SAFD,MAEM;AACF,iBAAKtD,aAAL,CAAmByD,QAAnB,CAA4BH,SAA5B;AACH;AACD,YAAG,KAAKnD,UAAL,IAAmB,CAAC,CAAvB,EAAyB;AACrBmD,sBAAU9B,YAAV,CAAuB,cAAvB,EAAuCkC,gBAAvC,CAAwD,KAAKtD,cAA7D;AACH,SAFD,MAEM;AACFkD,sBAAU9B,YAAV,CAAuB,cAAvB,EAAuCkC,gBAAvC,CAAwD,KAAKxD,oBAAL,CAA0B,KAAKC,UAA/B,CAAxD;AACH;AACDmD,kBAAU9B,YAAV,CAAuB,cAAvB,EAAuCmC,kBAAvC,CAA0DN,SAA1D,EAAoED,IAApE;AACH,KAzMI;;AA2ML;AACAQ,kBAAe,sBAAUN,SAAV,EAAoBD,SAApB,EAA8BD,IAA9B,EAAoC;AAC/CE,kBAAUO,gBAAV;AACA,YAAIC,IAAJ;AACA,YAAGV,IAAH,EAAQ;AACJU,mBAAO,KAAKhE,aAAL,CAAmBiE,kBAAnB,CAAsC,KAAK9D,cAAL,CAAoB+D,mBAApB,CAAwCV,UAAUW,QAAlD,CAAtC,CAAP;AACH,SAFD,MAEM;AACFH,mBAAO,KAAKhE,aAAL,CAAmBiE,kBAAnB,CAAsC,KAAK/D,aAAL,CAAmBgE,mBAAnB,CAAuCV,UAAUW,QAAjD,CAAtC,CAAP;AACH;AACDX,kBAAUb,CAAV,GAAcqB,KAAKrB,CAAnB;AACAa,kBAAUX,CAAV,GAAcmB,KAAKnB,CAAnB;AACAW,kBAAUT,QAAV,GAAqBS,UAAUT,QAAV,GAAmB,KAAKjD,YAAL,CAAkBiD,QAA1D;AACA,aAAK/C,aAAL,CAAmB2D,QAAnB,CAA4BH,SAA5B;;AAEA,aAAKY,8BAAL,CAAoCb,SAApC;;AAEA,aAAKc,qBAAL,CAA2Bf,IAA3B;AACH,KA5NI;AA6NL;AACAgB,mBAAgB,uBAAUd,SAAV,EAAoBD,SAApB,EAA8BD,IAA9B,EAAoC;AAChD,aAAKlF,SAAL,CAAeqD,GAAf,CAAmB+B,SAAnB;;AAEA,YAAIe,WAAW,KAAKzC,OAAOK,SAAP,CAAiBqC,uBAAjB,CAAyC1C,OAAOK,SAAP,CAAiBI,gBAAjB,CAAkCC,OAAlC,CAA0CV,OAAOK,SAAP,CAAiBM,UAA3D,CAAzC,CAAL,CAAf;AACA,YAAIgC,QAAJ;AACA,YAAGF,SAASd,IAAT,KAAkB,CAArB,EAAuB;AACnBgB,uBAAWF,SAASb,GAAT,EAAX;AACA,iBAAK1D,aAAL,CAAmB2D,QAAnB,CAA4Bc,QAA5B;AACA,gBAAIC,MAAMD,SAAS/C,YAAT,CAAsB1D,GAAG2G,SAAzB,CAAV;AACA,gBAAIC,YAAYF,IAAIG,iBAAJ,CAAsBH,IAAII,QAAJ,GAAe,CAAf,EAAkBC,IAAxC,CAAhB;AACAH,sBAAUI,IAAV,CAAe,UAAf,EAA2B,YAAY;AACnC;AACAT,yBAAS9C,GAAT,CAAagD,QAAb;AACH,aAHD;AAIAG,sBAAUK,IAAV;AACH;AACD,aAAKb,8BAAL,CAAoCb,SAApC;AACA,aAAKc,qBAAL,CAA2Bf,IAA3B;AACH,KAhPI;;AAkPLc,oCAAiC,wCAAUb,SAAV,EAAqB;AAClD,aAAK3C,aAAL,GAAqBkB,OAAOK,SAAP,CAAiB+C,WAAjB,GAA+BC,KAAKC,GAAL,CAAS7B,SAAT,CAApD;AACA,aAAK5C,eAAL,GAAuBmB,OAAOK,SAAP,CAAiB+C,WAAjB,GAA+BC,KAAKE,GAAL,CAAS9B,SAAT,CAAtD;AACA,aAAK1C,WAAL,CAAiBiD,YAAjB;AACH,KAtPI;AAuPLO,2BAAwB,+BAAUf,IAAV,EAAgB;AACpC;AACA,YAAIgC,OAAJ;AACA,YAAG,KAAKnH,YAAL,CAAkBsF,IAAlB,KAA2B,CAA9B,EAAgC;AAC5B6B,sBAAU,KAAKnH,YAAL,CAAkBuF,GAAlB,EAAV;AACH,SAFD,MAEM;AACF4B,sBAAUtH,GAAGwD,WAAH,CAAe,KAAKf,cAApB,CAAV;AACH;AACD6E,gBAAQ5D,YAAR,CAAqB,UAArB,EAAiC6D,WAAjC;AACA,YAAGjC,IAAH,EAAQ;AACJ,iBAAK9C,iBAAL,CAAuBmD,QAAvB,CAAgC2B,OAAhC;AACH,SAFD,MAEM;AACF,iBAAK/E,gBAAL,CAAsBoD,QAAtB,CAA+B2B,OAA/B;AACH;AACD,YAAIZ,MAAMY,QAAQ5D,YAAR,CAAqB1D,GAAG2G,SAAxB,CAAV;AACA,YAAIa,WAAWd,IAAII,QAAJ,GAAe,CAAf,EAAkBC,IAAjC;AACA,YAAIH,YAAYF,IAAIG,iBAAJ,CAAsBW,QAAtB,CAAhB;AACA,YAAIC,OAAO,IAAX;AACAb,kBAAUI,IAAV,CAAe,UAAf,EAA2B,YAAY;AACnCM,oBAAQvB,gBAAR;AACA0B,iBAAKtH,YAAL,CAAkBsD,GAAlB,CAAsB6D,OAAtB;AACH,SAHD;AAIAV,kBAAUK,IAAV;AACH,KA9QI;AA+QL;AACAS,cAAW,oBAAY;AACnB,YAAG5D,OAAOK,SAAP,CAAiBM,UAAjB,IAA8B,KAAjC,EAAuC;AACnC;AACA,iBAAK5B,WAAL,CAAiB8E,eAAjB;AACA;AACH;AACD,YAAG,CAAC,KAAK7D,OAAOK,SAAP,CAAiBM,UAAtB,CAAJ,EAAsC;AAClC,iBAAKX,OAAOK,SAAP,CAAiBM,UAAtB,IAAoCzE,GAAGwD,WAAH,CAAe,KAAKnC,gBAAL,CAAsByC,OAAOK,SAAP,CAAiBI,gBAAjB,CAAkCC,OAAlC,CAA0CV,OAAOK,SAAP,CAAiBM,UAA3D,CAAtB,CAAf,CAApC;AACA,iBAAKX,OAAOK,SAAP,CAAiBM,UAAtB,EAAkCE,CAAlC,GAAqC,CAArC;AACA,iBAAKb,OAAOK,SAAP,CAAiBM,UAAtB,EAAkCI,CAAlC,GAAsC,CAAtC;AACH;AACD,YAAI6B,MAAM,KAAK5C,OAAOK,SAAP,CAAiBM,UAAtB,EAAkCf,YAAlC,CAA+C1D,GAAG2G,SAAlD,CAAV;AACA,YAAIC,YAAYF,IAAIG,iBAAJ,CAAsBH,IAAII,QAAJ,GAAe,CAAf,EAAkBC,IAAxC,CAAhB;AACA,aAAKhF,WAAL,CAAiB4D,QAAjB,CAA0B,KAAK7B,OAAOK,SAAP,CAAiBM,UAAtB,CAA1B;AACA,YAAIgD,OAAO,IAAX;AACAb,kBAAUI,IAAV,CAAe,UAAf,EAA2B,YAAY;AACnCS,iBAAK3D,OAAOK,SAAP,CAAiBM,UAAtB,EAAkCsB,gBAAlC;AACA0B,iBAAK5E,WAAL,CAAiB8E,eAAjB;AACH,SAHD;AAIAf,kBAAUK,IAAV;AACH,KApSI;AAqSLW,cAAW,oBAAY;AACnB,aAAK3C,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACA,aAAKxC,aAAL,GAAqB,CAArB;AACA,aAAKC,eAAL,GAAuB,CAAvB;AACA,aAAKC,aAAL,GAAqB,CAArB;AACA,aAAKiF,2BAAL;AACA,aAAKhF,WAAL,CAAiB+E,QAAjB;AACH,KA5SI;;AA8SLC,iCAA8B,uCAAY;AACtC,YAAIC,eAAe,KAAK9F,aAAL,CAAmB+F,QAAtC;AACA,eAAOD,aAAaE,MAAb,IAAuB,CAA9B,EAAgC;AAC5BF,yBAAa,CAAb,EAAgBG,UAAhB;AACA,iBAAK7H,SAAL,CAAeqD,GAAf,CAAmBqE,aAAa,CAAb,CAAnB;AACH;AACD,YAAII,gBAAgB,KAAK1F,iBAAL,CAAuBuF,QAA3C;AACA,eAAOG,cAAcF,MAAd,IAAwB,CAA/B,EAAiC;AAC7BE,0BAAc,CAAd,EAAiBD,UAAjB;AACA,iBAAK9H,YAAL,CAAkBsD,GAAlB,CAAsByE,cAAc,CAAd,CAAtB;AACH;AACD,YAAIC,gBAAgB,KAAK5F,gBAAL,CAAsBwF,QAA1C;AACA,eAAOI,cAAcH,MAAd,IAAwB,CAA/B,EAAiC;AAC7BG,0BAAc,CAAd,EAAiBF,UAAjB;AACA,iBAAK9H,YAAL,CAAkBsD,GAAlB,CAAsB0E,cAAc,CAAd,CAAtB;AACH;AACJ,KA9TI;;AAgULC,YAAS,gBAASC,EAAT,EAAa;AAClB,YAAGvE,OAAOK,SAAP,CAAiByD,QAAjB,IAA6B9D,OAAOK,SAAP,CAAiBmE,SAAjD,EAA2D;AACvD;AACH;AACDxE,eAAOK,SAAP,CAAiBO,kBAAjB,IAAuC,KAAK/B,eAAL,GAAqB0F,EAA5D;AACA,aAAKzG,QAAL,CAAc+C,CAAd,GAAkBb,OAAOK,SAAP,CAAiBO,kBAAnC;;AAEA,aAAK9B,aAAL,IAAsBkB,OAAOK,SAAP,CAAiBoE,iBAAjB,GAAmCF,EAAzD;AACAvE,eAAOK,SAAP,CAAiBS,kBAAjB,IAAuC,KAAKhC,aAAL,GAAmByF,EAA1D;AACA,aAAKzG,QAAL,CAAciD,CAAd,GAAkBf,OAAOK,SAAP,CAAiBS,kBAAnC;;AAEAd,eAAOK,SAAP,CAAiBW,iBAAjB,IAAsC,KAAKpC,aAAL,GAAmB2F,EAAzD;AACA,aAAKvG,YAAL,CAAkBiD,QAAlB,GAA6BjB,OAAOK,SAAP,CAAiBW,iBAA9C;;AAEA,YAAGhB,OAAOK,SAAP,CAAiBO,kBAAjB,GAAsC,CAAC,KAAK7D,WAA5C,IAA2DiD,OAAOK,SAAP,CAAiBO,kBAAjB,GAAsC,KAAK7D,WAAtG,IACHiD,OAAOK,SAAP,CAAiBS,kBAAjB,GAAsC,CAAC,KAAK9D,YADzC,IACyDgD,OAAOK,SAAP,CAAiBS,kBAAjB,GAAsC,KAAK9D,YADvG,EACoH;AAChH;AACA,gBAAG,CAACgD,OAAOK,SAAP,CAAiBqE,WAArB,EAAiC;AAC7B,qBAAKZ,QAAL;AACH;AACJ;AACJ,KArVI;;AAuVLa,eAAY,qBAAY;AACpB,aAAKtI,YAAL,CAAkBuI,KAAlB;AACA,aAAKtI,SAAL,CAAesI,KAAf;AACA,aAAKrI,aAAL,CAAmBqI,KAAnB;AACA,aAAKpI,YAAL,CAAkBoI,KAAlB;AACA,aAAKnI,aAAL,CAAmBmI,KAAnB;AACA,aAAKlI,WAAL,CAAiBkI,KAAjB;AACA,aAAKjI,YAAL,CAAkBiI,KAAlB;AACA/E,WAAGC,kBAAH,CAAsB+E,WAAtB,CAAkC,IAAlC;AACA,aAAKC,sBAAL;AACH;AAjWI,CAAT","file":"double_object.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/component","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    ctor : function () {\n        this.addScorePool = null;\n        this.arrowPool = null;\n        this.dajiChengPool = null;\n        this.dajiHongPool = null;\n        this.dajiHuangPool = null;\n        this.dajiLanPool = null;\n        this.dajiZongPool = null;\n    },\n    extends: cc.Component,\n\n    properties: {\n\n        windowWidth : 0,\n        windowHeight : 0,\n\n        objectSprite : {\n            default : null,\n            type : cc.Sprite\n        },\n        objectSpriteFrameList :[cc.SpriteFrame],\n        objectPrefabList :[cc.Prefab],\n\n        dajiChengPrefab : {\n            default : null,\n            type : cc.Prefab\n        },\n        dajiHongPrefab : {\n            default : null,\n            type : cc.Prefab\n        },\n        dajiHuangPrefab : {\n            default : null,\n            type : cc.Prefab\n        },\n        dajiLanPrefab : {\n            default : null,\n            type : cc.Prefab\n        },\n        dajiZongPrefab : {\n            default : null,\n            type : cc.Prefab\n        },\n\n        //特殊节点\n        moveNode : {\n            default : null,\n            type : cc.Node\n        },\n        rotationNode : {\n            default : null,\n            type : cc.Node\n        },\n        bombAniNode : {\n            default : null,\n            type : cc.Node\n        },\n        gunHitAniNode : {\n            default : null,\n            type : cc.Node\n        },\n\n        //箭\n        arrowPrefab : {\n            default : null,\n            type : cc.Prefab\n        },\n        leftArrowNode : {\n            default : null,\n            type : cc.Node\n        },\n        rightArrowNode : {\n            default : null,\n            type : cc.Node\n        },\n        arrowSpriteFrameList : [cc.SpriteFrame],\n        arrowIndex : -1,\n        gunSpriteFrame : cc.SpriteFrame,\n\n        //增加分数\n        leftAddScoreNode : {\n            default : null,\n            type : cc.Node\n        },\n        rightAddScoreNode : {\n            default : null,\n            type : cc.Node\n        },\n        addScorePrefab : cc.Prefab,\n\n        rotationSpeed : 0,\n        horizontalSpeed : 0,\n        verticalSpeed : 0,\n\n        parentScene: {\n            default: null,\n            serializable: false\n        }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad : function() {\n        var winSize = cc.director.getWinSize();\n        this.windowWidth = winSize.width;\n        this.windowHeight = winSize.height;\n\n        var k;\n        var addAniNode;\n\n        this.addScorePool = new cc.NodePool();\n        for (k = 0 ; k < 10 ; k ++){\n            addAniNode = cc.instantiate(this.addScorePrefab);\n            this.addScorePool.put(addAniNode);\n        }\n        this.arrowPool = new cc.NodePool();\n        for (k = 0 ; k < 30 ; k ++){\n            addAniNode = cc.instantiate(this.arrowPrefab);\n            addAniNode.getComponent(\"double_arrow\").parentScene = this;\n            this.arrowPool.put(addAniNode);\n        }\n        this.dajiChengPool = new cc.NodePool();\n        for (k = 0 ; k < 20 ; k ++){\n            addAniNode = cc.instantiate(this.dajiChengPrefab);\n            this.dajiChengPool.put(addAniNode);\n        }\n        this.dajiHongPool = new cc.NodePool();\n        for (k = 0 ; k < 20 ; k ++){\n            addAniNode = cc.instantiate(this.dajiHongPrefab);\n            this.dajiHongPool.put(addAniNode);\n        }\n        this.dajiHuangPool = new cc.NodePool();\n        for (k = 0 ; k < 20 ; k ++){\n            addAniNode = cc.instantiate(this.dajiHuangPrefab);\n            this.dajiHuangPool.put(addAniNode);\n        }\n        this.dajiLanPool = new cc.NodePool();\n        for (k = 0 ; k < 20 ; k ++){\n            addAniNode = cc.instantiate(this.dajiLanPrefab);\n            this.dajiLanPool.put(addAniNode);\n        }\n        this.dajiZongPool = new cc.NodePool();\n        for (k = 0 ; k < 20 ; k ++){\n            addAniNode = cc.instantiate(this.dajiZongPrefab);\n            this.dajiZongPool.put(addAniNode);\n        }\n\n        ty.NotificationCenter.listen(double.EventType.CHANGE_GUN_TYPE,this.changeGunType,this);\n    },\n\n    changeGunType : function (index) {\n        if(double.GameWorld.weaponType == 0){//枪\n            this.arrowIndex = -1;\n        }else {//弓箭\n            this.arrowIndex = index;\n        }\n    },\n\n    //TODO:更换击打对象的样式/碰撞区域\n    changeObjectType : function () {\n        // double.GameWorld.objectType\n        this.objectSprite.spriteFrame = this.objectSpriteFrameList[double.GameWorld.doubleObjectList.indexOf(double.GameWorld.objectType)];\n\n        double.GameWorld.objectNowLocationX = 0;\n        this.moveNode.x = double.GameWorld.objectNowLocationX;\n        double.GameWorld.objectNowLocationY = -this.windowHeight/2-200;\n        this.moveNode.y = double.GameWorld.objectNowLocationY;\n        double.GameWorld.objectNowRotation = 0;\n        this.rotationNode.rotation = double.GameWorld.objectNowRotation;\n\n        this.rotationSpeed = 30;\n        this.horizontalSpeed = 0;\n        this.verticalSpeed = double.GameWorld.objectInitializedSpeed;\n\n        this.node.active = true;\n\n        this.changeGunType(double.GameWorld.doubleBowNameList.indexOf(double.GameWorld.gunType));\n    },\n\n    sendArrowForObject : function (from,direction) {\n        var arrowNode  ;\n        if(this.arrowPool.size() > 0){\n            arrowNode = this.arrowPool.get();\n        }else {\n            arrowNode = cc.instantiate(this.arrowPrefab);\n            arrowNode.parentScene = this;\n        }\n        arrowNode.x = 0;\n        arrowNode.y = 0;\n        if(from){\n            this.rightArrowNode.addChild(arrowNode);\n        }else {\n            this.leftArrowNode.addChild(arrowNode);\n        }\n        if(this.arrowIndex == -1){\n            arrowNode.getComponent(\"double_arrow\").reSetArrowSprite(this.gunSpriteFrame);\n        }else {\n            arrowNode.getComponent(\"double_arrow\").reSetArrowSprite(this.arrowSpriteFrameList[this.arrowIndex]);\n        }\n        arrowNode.getComponent(\"double_arrow\").beginSendAnimation(direction,from);\n    },\n\n    //被箭头射中\n    receiveArrow : function (arrowNode,direction,from) {\n        arrowNode.removeFromParent();\n        var vec1;\n        if(from){\n            vec1 = this.gunHitAniNode.convertToNodeSpace(this.rightArrowNode.convertToWorldSpace(arrowNode.position));\n        }else {\n            vec1 = this.gunHitAniNode.convertToNodeSpace(this.leftArrowNode.convertToWorldSpace(arrowNode.position));\n        }\n        arrowNode.x = vec1.x;\n        arrowNode.y = vec1.y;\n        arrowNode.rotation = arrowNode.rotation-this.rotationNode.rotation;\n        this.gunHitAniNode.addChild(arrowNode);\n\n        this.changeEffectFromWeaponToObject(direction);\n\n        this.playAddScoreAnimation(from);\n    },\n    //被子弹射中,子弹动画\n    receiveBullet : function (arrowNode,direction,from) {\n        this.arrowPool.put(arrowNode);\n\n        var tempPool = this[double.GameWorld.doubleObjectAniPoolList[double.GameWorld.doubleObjectList.indexOf(double.GameWorld.objectType)]];\n        var tempNode;\n        if(tempPool.size() > 0){\n            tempNode = tempPool.get();\n            this.gunHitAniNode.addChild(tempNode);\n            var ani = tempNode.getComponent(cc.Animation);\n            var animation = ani.getAnimationState(ani.getClips()[0].name);\n            animation.once(\"finished\", function () {\n                // tempNode.removeFromParent();\n                tempPool.put(tempNode);\n            });\n            animation.play();\n        }\n        this.changeEffectFromWeaponToObject(direction);\n        this.playAddScoreAnimation(from);\n    },\n\n    changeEffectFromWeaponToObject : function (direction) {\n        this.verticalSpeed = double.GameWorld.impactForce * Math.sin(direction);\n        this.horizontalSpeed = double.GameWorld.impactForce * Math.cos(direction);\n        this.parentScene.receiveArrow();\n    },\n    playAddScoreAnimation : function (from) {\n        // 加分动画\n        var addNode  ;\n        if(this.addScorePool.size() > 0){\n            addNode = this.addScorePool.get();\n        }else {\n            addNode = cc.instantiate(this.addScorePrefab);\n        }\n        addNode.getComponent(\"addScore\").changeLabel();\n        if(from){\n            this.rightAddScoreNode.addChild(addNode);\n        }else {\n            this.leftAddScoreNode.addChild(addNode);\n        }\n        var ani = addNode.getComponent(cc.Animation);\n        var clipName = ani.getClips()[0].name;\n        var animation = ani.getAnimationState(clipName);\n        var that = this;\n        animation.once(\"finished\", function () {\n            addNode.removeFromParent();\n            that.addScorePool.put(addNode);\n        });\n        animation.play();\n    },\n    //TODO:爆炸动画\n    gameBomb : function () {\n        if(double.GameWorld.objectType ==\"box\"){\n            //TODO:宝箱\n            this.parentScene.afterObjectBomb();\n            return;\n        }\n        if(!this[double.GameWorld.objectType]){\n            this[double.GameWorld.objectType] = cc.instantiate(this.objectPrefabList[double.GameWorld.doubleObjectList.indexOf(double.GameWorld.objectType)]);\n            this[double.GameWorld.objectType].x= 0;\n            this[double.GameWorld.objectType].y = 0;\n        }\n        var ani = this[double.GameWorld.objectType].getComponent(cc.Animation);\n        var animation = ani.getAnimationState(ani.getClips()[0].name);\n        this.bombAniNode.addChild(this[double.GameWorld.objectType]);\n        var that = this;\n        animation.once(\"finished\", function () {\n            that[double.GameWorld.objectType].removeFromParent();\n            that.parentScene.afterObjectBomb();\n        });\n        animation.play();\n    },\n    gameOver : function () {\n        this.node.active = false;\n        this.rotationSpeed = 0;\n        this.horizontalSpeed = 0;\n        this.verticalSpeed = 0;\n        this.removeAllGunHitAniNodeChild();\n        this.parentScene.gameOver();\n    },\n\n    removeAllGunHitAniNodeChild : function () {\n        var tempNodeList = this.gunHitAniNode.children;\n        while (tempNodeList.length != 0){\n            tempNodeList[0].stopAction();\n            this.arrowPool.put(tempNodeList[0]);\n        }\n        var tempNodeList2 = this.rightAddScoreNode.children;\n        while (tempNodeList2.length != 0){\n            tempNodeList2[0].stopAction();\n            this.addScorePool.put(tempNodeList2[0]);\n        }\n        var tempNodeList3 = this.leftAddScoreNode.children;\n        while (tempNodeList3.length != 0){\n            tempNodeList3[0].stopAction();\n            this.addScorePool.put(tempNodeList3[0]);\n        }\n    },\n\n    update : function(dt) {\n        if(double.GameWorld.gameOver || double.GameWorld.gamePause){\n            return ;\n        }\n        double.GameWorld.objectNowLocationX += this.horizontalSpeed*dt;\n        this.moveNode.x = double.GameWorld.objectNowLocationX;\n\n        this.verticalSpeed -= double.GameWorld.objectAccelerated*dt;\n        double.GameWorld.objectNowLocationY += this.verticalSpeed*dt;\n        this.moveNode.y = double.GameWorld.objectNowLocationY;\n\n        double.GameWorld.objectNowRotation += this.rotationSpeed*dt;\n        this.rotationNode.rotation = double.GameWorld.objectNowRotation;\n\n        if(double.GameWorld.objectNowLocationX < -this.windowWidth || double.GameWorld.objectNowLocationX > this.windowWidth ||\n        double.GameWorld.objectNowLocationY < -this.windowHeight || double.GameWorld.objectNowLocationY > this.windowHeight){\n            //本局结束\n            if(!double.GameWorld.gameLevelUp){\n                this.gameOver();\n            }\n        }\n    },\n\n    onDestroy : function () {\n        this.addScorePool.clear();\n        this.arrowPool.clear();\n        this.dajiChengPool.clear();\n        this.dajiHongPool.clear();\n        this.dajiHuangPool.clear();\n        this.dajiLanPool.clear();\n        this.dajiZongPool.clear();\n        ty.NotificationCenter.ignoreScope(this);\n        this.unscheduleAllCallbacks();\n    }\n});\n"]}
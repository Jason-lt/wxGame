{"version":3,"sources":["shot_begin.js"],"names":["cc","Class","extends","Component","properties","bestScoreLabel","default","type","Label","diamondNode","Node","freeToolNode","onGetGift","ty","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeButtonClick","shot","GlobalFuncs","showDiamondGift","onFreeTool","showFreeTool","startGame","sceneName","onLaunched","director","loadScene","friendRank","showRankList","onLoad","NotificationCenter","listen","EventType","UPDATE_USERINFO","updateUserInfo","string","Share","shareKeywordReplace","bestScoreForSelf","gameModel","getUserInfoForShot","AudioHelper","playMusic","EffectPath_mp3","musicStart","REPLAY_BG_MUSIC","rePlayBgMusic","hall","adManager","checkVideoAd","GlobalTimer","getCurWeek","changeDiamondNodeActive","changeGameClubButtonActive","GUNNER_SHARE_SCHEME","BSGS_CHECK_RESULT","getAdMsg","GET_AD_MSG_SUCCESS","checkRewardWithSharePoint","SharePointType","getFreeTool","GET_CHECK_REWARD","changeFreeToolNodeActive","result","onShowParam","scene","query","shareTicket","sourceCode","isFirstOpen","onShareType","clickStatShareTypeRankList","getAllCheckConfig","getAdNodeList","length","sceneSize","getWinSize","showAd","x","y","height","showAdNode","active","isInBSGS","GameWorld","toolUserTimeConfig","diamondShow","bsgs","nBsgs","leftCount","gunnerShareSchemeConfig","showGameClubButton","gameClubButton","sysInfo","getSysInfo","screenHeight","LOGD","wx","createGameClubButton","image","icon","style","left","top","width","show","playinfo","max_score","upDateRankData","history_score","update","dt","onDestroy","destroy","i","hideAdNode","ignoreScope"],"mappings":"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","file":"shot_begin.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/Scenes","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // aniSpriteNode :{\n        //     default : null,\n        //     type : cc.Node\n        // },\n        bestScoreLabel : {\n            default : null,\n            type : cc.Label\n        },\n        diamondNode : {\n            default : null,\n            type : cc.Node\n        },\n        freeToolNode : {\n            default : null,\n            type : cc.Node\n        }\n    },\n\n    onGetGift : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"getDiamond\"]);\n        shot.GlobalFuncs.showDiamondGift(0);\n    },\n\n    onFreeTool : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"freeTool\"]);\n        shot.GlobalFuncs.showFreeTool();\n    },\n\n    startGame : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"startGame\"]);\n        var sceneName = 'shot_main';\n        var onLaunched = function () {\n            // var logicScene = cc.director.getScene();\n            // var no = logicScene.children[0];\n            // var window = no.getComponent('shot_rank');\n            // window.showRankListForShare();\n        };\n        cc.director.loadScene(sceneName,onLaunched);\n    },\n\n    friendRank : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"friendRank\"]);\n        shot.GlobalFuncs.showRankList(\"\");\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad :function() {\n\n        ty.NotificationCenter.listen(shot.EventType.UPDATE_USERINFO,this.updateUserInfo, this);\n        this.bestScoreLabel.string = \"最佳得分:\"+shot.Share.shareKeywordReplace.bestScoreForSelf;\n        shot.gameModel.getUserInfoForShot();\n\n        shot.AudioHelper.playMusic(shot.EffectPath_mp3.musicStart,true);\n        ty.NotificationCenter.listen(shot.EventType.REPLAY_BG_MUSIC,this.rePlayBgMusic, this);\n\n        hall.adManager.checkVideoAd(); //Load广告\n        hall.GlobalTimer.getCurWeek();\n\n        this.changeDiamondNodeActive();\n        this.changeGameClubButtonActive();\n        ty.NotificationCenter.listen(shot.EventType.GUNNER_SHARE_SCHEME,this.changeDiamondNodeActive,this);\n        ty.NotificationCenter.listen(shot.EventType.BSGS_CHECK_RESULT,this.changeDiamondNodeActive,this);\n        ty.NotificationCenter.listen(shot.EventType.GUNNER_SHARE_SCHEME,this.changeGameClubButtonActive,this);\n\n        this.getAdMsg();\n        ty.NotificationCenter.listen(ty.EventType.GET_AD_MSG_SUCCESS,this.getAdMsg,this);\n\n        shot.gameModel.checkRewardWithSharePoint(shot.Share.SharePointType.getFreeTool);\n        ty.NotificationCenter.listen(shot.EventType.GET_CHECK_REWARD,this.changeFreeToolNodeActive,this);\n\n        var result = ty.UserInfo.onShowParam;\n        if(!result){\n            return;\n        }\n        //取相关参数\n        var scene = result.scene;\n        var query = result.query;\n        var shareTicket;\n        if(query && query.sourceCode && result.isFirstOpen){//从小程序消息卡片中点入\n            if(query.sourceCode == shot.Share.onShareType.clickStatShareTypeRankList && scene == 1044){//群排行榜\n                shareTicket = result.shareTicket;\n                if(shareTicket){\n                    shot.GlobalFuncs.showRankList(shareTicket);\n                }\n            }\n        }\n\n        ty.UserInfo.onShowParam.isFirstOpen = false;\n    },\n\n    getAdMsg : function () {\n        if(!shot.gameModel.getAllCheckConfig()){\n            if(hall.adManager.getAdNodeList().length < 1){\n                var sceneSize = cc.director.getWinSize();\n                hall.adManager.showAd({x:72,y:sceneSize.height/2+50});\n            }else {\n                hall.adManager.getAdNodeList()[0].showAdNode();\n            }\n        }\n    },\n\n    changeDiamondNodeActive : function () {\n        if(shot.gameModel.getAllCheckConfig()){\n            this.diamondNode.active = false;\n        }else {\n            if(ty.UserInfo.isInBSGS){\n                this.diamondNode.active = shot.GameWorld.toolUserTimeConfig.diamondShow.bsgs;\n            }else {\n                this.diamondNode.active = shot.GameWorld.toolUserTimeConfig.diamondShow.nBsgs;\n            }\n        }\n    },\n    changeFreeToolNodeActive : function (result) {\n        //{\"cmd\":\"hall_share2\",\"result\":{\"action\":\"check_reward\",\"gameId\":6,\"userId\":10042,\"pointId\":67890009,\"leftCount\":0}}\n        this.freeToolNode.active = result.leftCount;\n    },\n    changeGameClubButtonActive : function () {\n\n\n        if(shot.GameWorld.gunnerShareSchemeConfig && shot.GameWorld.gunnerShareSchemeConfig.showGameClubButton){\n            if(!shot.gameClubButton){\n                var sysInfo = hall.adManager.getSysInfo();\n                var screenHeight = sysInfo.screenHeight;\n                hall.LOGD(\"===\",\"===screenHeight===\"+screenHeight);\n                shot.gameClubButton = wx.createGameClubButton({\n                    type : \"image\",\n                    image : \"https://nslyqn.nalrer.cn/nsly/crazygun/icon/game.png\",\n                    icon: 'green',\n                    style: {\n                        left: 10,\n                        top: screenHeight-68,\n                        width: 42,\n                        height: 42\n                    }\n                });\n            }\n            shot.gameClubButton.show();\n        }\n    },\n\n    rePlayBgMusic:function(){\n        shot.AudioHelper.playMusic(shot.EffectPath_mp3.musicStart,true);\n        // shot.AudioHelper.rePlayMusic();\n    },\n\n    updateUserInfo : function (result) {\n\n        if(result.playinfo.max_score){\n            shot.Share.shareKeywordReplace.bestScoreForSelf = result.playinfo.max_score;\n            shot.GlobalFuncs.upDateRankData(result.playinfo.max_score);\n        }\n        // this.bestScoreLabel.string = \"最佳得分:\"+shot.Share.shareKeywordReplace.bestScoreForSelf;\n\n        if(result.playinfo.history_score){\n            this.bestScoreLabel.string = \"历史最佳:\"+result.playinfo.history_score;\n        }\n    },\n\n    update : function (dt) {\n        // this.aniSpriteNode.rotation += 1;\n    },\n    onDestroy:function(){\n        if(shot.gameClubButton){\n            shot.gameClubButton.destroy();\n        }\n\n        if(hall.adManager.getAdNodeList().length >= 1){\n            for (var i = 0 ; i < hall.adManager.getAdNodeList().length ; i ++){\n                hall.adManager.getAdNodeList()[i].hideAdNode();\n            }\n        }\n\n        shot.gameClubButton = null;\n        ty.NotificationCenter.ignoreScope(this);\n    }\n    // start () {shot.GlobalFuncs.showRankList\n    //\n    // },\n\n});\n"]}
{"version":3,"sources":["shot_diamond.js"],"names":["cc","Class","extends","Component","properties","diamondContentNode","Node","haveFriendNode","nameLabel","default","type","Label","countLabel","descLabel","buttonTitleLabel","RichText","state","inviteButton","Button","onCloseButton","node","stopAllActions","destroy","onInviteAction","ty","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeButtonClick","shot","Share","shareWithType","onShareType","clickStatShareTypeDiamond","onBlack","onLoad","hall","GlobalFuncs","btnScaleEffect","NotificationCenter","listen","EventType","UPDATE_DIAMOND_NUMBER","updateDiamond","changeStateWithInfo","result","UPDATE_ASSETS_COUNT","getAsstsCount","active","string","counts","name","sliceStringToLength","ME","udataInfo","diamondCount","gameModel","assetsCounts","onDestroy","ignoreScope","unscheduleAllCallbacks"],"mappings":"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","file":"shot_diamond.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        diamondContentNode : cc.Node,\n        haveFriendNode : cc.Node,\n        nameLabel : {\n            default : null,\n            type : cc.Label\n        },\n\n        countLabel : {\n            default : null,\n            type : cc.Label\n        },\n\n        descLabel:cc.Label,\n\n        buttonTitleLabel : {\n            default : null,\n            type : cc.RichText\n        },\n\n        state : 0,\n        inviteButton : cc.Button\n    },\n    onCloseButton : function () {\n        this.inviteButton.node.stopAllActions();\n        this.node.destroy();\n    },\n    onInviteAction : function () {\n        if(this.state == 0){\n            ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"diamondInvitation\"]);\n            shot.Share.shareWithType(shot.Share.onShareType.clickStatShareTypeDiamond);\n            // var _config = shot.GameWorld.gunnerShareSchemeConfig;\n            // if (_config && _config.resurgenceShare){\n            //     shot.Share.shareWithType(shot.Share.onShareType.clickStatShareTypeRevial);\n            // }else {\n            //     shot.Share.shareWithType(shot.Share.onShareType.clickStatShareTypeDiamond);\n            // }\n            //\n\n        }else {\n            this.onCloseButton();\n        }\n    },\n    // LIFE-CYCLE CALLBACKS:\n\n    onBlack : function () {\n    },\n\n    onLoad :function() {\n        hall.GlobalFuncs.btnScaleEffect(this.inviteButton.node,1.13);\n        ty.NotificationCenter.listen(shot.EventType.UPDATE_DIAMOND_NUMBER,this.updateDiamond, this);\n        this.updateDiamond();\n        this.state = 0;\n    },\n    \n    changeStateWithInfo : function (state,result) {\n        this.state = state;\n        if(state == 0){\n            // shot.gameModel.queryMutualInviteAssets();\n            ty.NotificationCenter.listen(shot.EventType.UPDATE_ASSETS_COUNT,this.getAsstsCount,this);\n\n            // this.countLabel.string = \" x\"+shot.gameModel.assetsCounts;\n            this.diamondContentNode.active = true;\n            this.haveFriendNode.active = false;\n            this.buttonTitleLabel.string = \"<color=#ffffff><b>邀请群友</b></color>\";\n            this.descLabel.string = \"已有\";\n        }else {\n            //帮助该好友获得的钻石数量\n            this.diamondContentNode.active = false;\n            this.haveFriendNode.active = true;\n            if (result && result.counts != null) {\n                this.countLabel.string = \" x\" + result.counts;\n            }\n            this.descLabel.string = \"获得\";\n            if (result && result.name) {\n                this.nameLabel.string = hall.GlobalFuncs.sliceStringToLength(result.name,10);\n            }\n            this.buttonTitleLabel.string = \"<color=#ffffff><b>确 定</b></color>\";\n        }\n    },\n\n    updateDiamond:function(){\n        if (this.state == 0) {\n            this.countLabel.string = \"x\" + hall.ME.udataInfo.diamondCount;\n        }\n    },\n\n    getAsstsCount : function (result) {\n        this.countLabel.string = \" x\"+shot.gameModel.assetsCounts;\n        this.diamondContentNode.active = true;\n        this.haveFriendNode.active = false;\n        this.buttonTitleLabel.string = \"<color=#ffffff><b>邀请群友</b></color>\";\n    },\n    onDestroy:function(){\n        ty.NotificationCenter.ignoreScope(this);\n        this.unscheduleAllCallbacks();\n    }\n\n    // update (dt) {},\n});\n"]}
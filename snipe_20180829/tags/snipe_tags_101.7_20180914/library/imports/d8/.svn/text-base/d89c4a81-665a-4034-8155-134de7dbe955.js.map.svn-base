{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/window/assets/Script/ComponentScript/window/shot_shareResult.js"],"names":["cc","Class","extends","Component","ctor","tempCanvas","context","properties","shareMomentSprite","default","type","Sprite","texture","Texture2D","spriteFrame","SpriteFrame","aniSprite","aniSpriteFrame","aniSpriteNode","Node","countDown","saveImageUrl","windowHeight","onShareToFriend","ty","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeButtonClick","shot","Share","shareWithType","onShareType","clickStatShareTypeScore","onShareMoments","saveImageToPhoneWithUrl","node","active","animation","getComponent","Animation","getAnimationState","that","once","changeAniSprite","play","shareBackAction","backAction","destroy","onBlack","onLoad","winSize","director","getWinSize","height","width","levelNameList","wx","createCanvas","getContext","image1","createImage","onload","event","img1","target","drawImage","font","fillStyle","textAlign","fillText","shareKeywordReplace","bestScoreForSelf","level","judgeScoreLevel","changeShowSprite","image3","img3","src","SystemInfo","cdnPath_shareMoment","initWithElement","handleLoadedTexture","_refreshTexture","getSaveImageUrl","update","dt","x","toTempFilePathSync","y","destWidth","destHeight","score","tempFilePath","saveImageToPhone","saveImageToPhotosAlbum","filePath","success","res","hall","MsgBoxManager","showToast","fail","params","LOGW","JSON","stringify","complete","getSetting","authSetting","authorize","scope","showModal","title","content","showCancel","cancelText","confirmText","confirm","openSetting"],"mappings":"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","file":"shot_shareResult.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    ctor : function () {\n        this.tempCanvas = null;\n        this.context = null;\n    },\n\n    properties: {\n\n        shareMomentSprite : {\n            default : null,\n            type : cc.Sprite\n        },\n        texture:cc.Texture2D,\n        spriteFrame:{\n            default : null,\n            type : cc.SpriteFrame\n        },\n\n        aniSprite : {\n            default : null,\n            type : cc.Sprite\n        },\n        aniSpriteFrame : cc.SpriteFrame,\n        aniSpriteNode : {\n            default : null,\n            type : cc.Node\n        },\n        countDown : 0,\n        saveImageUrl : null,\n\n        // exWidth : 0,\n        // exHeight : 0,\n        windowHeight : 1136\n    },\n\n    onShareToFriend : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"showToFriend\"]);\n        shot.Share.shareWithType(shot.Share.onShareType.clickStatShareTypeScore);\n    },\n\n    onShareMoments : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"shareMoments\"]);\n        if(this.saveImageUrl){\n            this.saveImageToPhoneWithUrl(this.saveImageUrl);\n            this.shareMomentSprite.node.active = true;\n            this.aniSprite.spriteFrame = this.aniSpriteFrame;\n            var animation = this.aniSpriteNode.getComponent(cc.Animation).getAnimationState(\"share_bg_ani\");\n            var that = this;\n            animation.once(\"finished\", function () {\n                that.changeAniSprite();\n            });\n            animation.play();\n        }\n    },\n    shareBackAction : function () {\n        this.shareMomentSprite.node.active = false;\n    },\n    backAction : function () {\n        this.node.destroy();\n    },\n    onBlack : function () {\n\n    },\n    onLoad : function() {\n        var winSize = cc.director.getWinSize();\n        if(winSize.height/1136 > winSize.width/640){\n            // this.exWidth = ((winSize.height*640/1136)-640)/2;\n            // this.exHeight = (winSize.height-1136)/2;\n            this.windowHeight = winSize.height;\n        }\n        this.windowHeight = winSize.height;\n        this.shareMomentSprite.node.active = false;\n        var that = this;\n        var levelNameList = [\"见习枪手\",\"初级枪手\",\"高级枪手\",\"资深枪手\",\"精英枪手\",\"宗师枪手\",\"神枪手\"];\n        var tempCanvas = wx.createCanvas();\n        tempCanvas.width = 640;\n        tempCanvas.height = this.windowHeight;\n        var context = tempCanvas.getContext(\"2d\");\n        this.tempCanvas = tempCanvas;\n        this.context = context;\n        var image1 = wx.createImage();\n        image1.onload = function (event) {\n            var img1 = event.target;\n            context.drawImage(img1,0,0,640,that.windowHeight);\n            //分数\n            context.font = \"bold 60px arial\";\n            context.fillStyle=\"#4a0707\";\n            context.textAlign = \"center\";\n            context.fillText(shot.Share.shareKeywordReplace.bestScoreForSelf+\"\",320,203);\n            //等级\n            var level = that.judgeScoreLevel();\n            if(level < 5){\n                context.font = \"bold 92px arial\";\n                context.fillText(levelNameList[level-1],320,350);\n                that.changeShowSprite(tempCanvas,context);\n            }else {\n                var image3 = wx.createImage();\n                image3.onload = function (event) {\n                    var img3 = event.target;\n                    context.drawImage(img3,(640-img3.width)/2,that.windowHeight-img3.height,img3.width,img3.height);\n                    that.changeShowSprite(tempCanvas,context);\n                };\n                image3.src = ty.SystemInfo.cdnPath_shareMoment + \"shot_shareMoment_level\"+level+\".png\";\n            }\n        };\n        image1.src = ty.SystemInfo.cdnPath_shareMoment + \"shot_shareMoment_bg_2.png\";\n    },\n\n    changeShowSprite : function (tempCanvas,context) {\n        this.texture = new cc.Texture2D();\n        this.spriteFrame = new cc.SpriteFrame(this.texture);\n        this.texture.initWithElement(tempCanvas);\n        this.texture.handleLoadedTexture();\n        this.shareMomentSprite.spriteFrame = this.spriteFrame;\n        this.shareMomentSprite.spriteFrame._refreshTexture(this.texture);\n        this.shareMomentSprite.node.height = this.windowHeight;\n        this.getSaveImageUrl(context,tempCanvas);\n    },\n    changeAniSprite : function () {\n        this.texture = new cc.Texture2D();\n        this.spriteFrame = new cc.SpriteFrame(this.texture);\n        this.texture.initWithElement(this.tempCanvas);\n        this.texture.handleLoadedTexture();\n        this.aniSprite.spriteFrame = this.spriteFrame;\n        this.aniSprite.spriteFrame._refreshTexture(this.texture);\n        this.aniSprite.node.height = this.windowHeight;\n        this.aniSprite.node.active = true;\n        this.countDown = 120;\n    },\n    update :function(dt) {\n        if(this.countDown){\n            this.countDown -- ;\n            if(this.countDown == 0){\n                this.aniSprite.node.active = false;\n            }\n            if(this.countDown < 60){\n                this.aniSprite.node.x -= 3;\n            }\n        }\n    },\n    getSaveImageUrl : function (context,tempCanvas) {\n        var image3 = wx.createImage();\n        var that = this;\n        image3.onload = function (event) {\n            var img3 = event.target;\n            context.drawImage(img3,0,that.windowHeight-269,640,269);\n            that.saveImageUrl = tempCanvas.toTempFilePathSync({\n                x: 0,\n                y: 0,\n                width: 640,\n                height:that.windowHeight,\n                destWidth: 640,\n                destHeight:that.windowHeight\n            });\n        };\n        image3.src = ty.SystemInfo.cdnPath_shareMoment + \"shot_shareMoment_bottom_2.png\";\n    },\n\n    judgeScoreLevel : function () {\n        var score = shot.Share.shareKeywordReplace.bestScoreForSelf;\n        var level = 0;\n        if(score < 2000){\n            level = 1;//见习枪手\n        }else if(score < 10000){\n            level = 2;//初级枪手\n        }else if(score < 20000){\n            level = 3;//高级枪手\n        }else if(score < 50000){\n            level = 4;//资深枪手\n        }else if(score < 100000){\n            level = 5;//精英枪手(图)\n        }else if(score < 500000){\n            level = 6;//宗师枪手(图)\n        }else {\n            level = 7;//神枪手(图)\n        }\n        return level;\n    },\n\n    saveImageToPhoneWithUrl : function (tempFilePath) {\n        var saveImageToPhone = function () {\n            wx.saveImageToPhotosAlbum({\n                filePath : tempFilePath,\n                success:function(res) {\n                    hall.MsgBoxManager.showToast({\"title\":\"图片已保存到手机相册\\n请到朋友圈分享\",\"time\":3});\n                    // hall.LOGW(\"========\",\"=======success========\"+JSON.stringify(res));\n                },\n                fail: function(params) {\n                    hall.LOGW(\"========\",\"=======fail========\"+JSON.stringify(params));\n                },\n                complete: function(params) {\n                }\n            });\n        };\n        wx.getSetting({\n            success:function(res) {\n                if (!res.authSetting['scope.writePhotosAlbum']) {\n                    wx.authorize({\n                        scope : \"scope.writePhotosAlbum\",\n                        success : function () {\n                            saveImageToPhone();\n                        },\n                        fail:function () {\n                            hall.LOGW(null, \"授权使用相册失败!\");\n                            wx.showModal({\n                                title:'提示',\n                                content:'保存图片,需要您授权使用相册,点击确定手动进行授权!',\n                                showCancel:true,\n                                cancelText:'取消',\n                                confirmText:'确定',\n                                success:function (res) {\n                                    if (res.confirm) {\n                                        wx.openSetting();\n                                    }\n                                }\n                            });\n\n                        },\n                        complete:function () {\n                        }\n                    });\n                }\n                else{\n                    saveImageToPhone();\n                }\n            }\n        });\n    }\n\n    // LIFE-CYCLE CALLBACKS:\n\n\n\n    // start () {\n    //\n    // },\n});\n"]}
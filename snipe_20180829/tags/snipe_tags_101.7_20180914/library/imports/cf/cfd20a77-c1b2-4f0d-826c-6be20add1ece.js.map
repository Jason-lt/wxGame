{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/window/assets/Script/ComponentScript/window/shot_secret_box.js"],"names":["cc","Class","extends","Component","properties","textRich","default","type","RichText","boxSprite","Sprite","boxSpriteFrameList","SpriteFrame","checkBoxButton","Button","checkBoxSprite","boxType","openType","parentScene","serializable","onLoad","openConfig","shot","gameModel","getAllCheckConfig","GameWorld","treasureConfig","showAtWindow","tishen","ty","UserInfo","isInBSGS","bsgs","nBsgs","openTypeList","shareProbability","node","active","chooseOpenTypeWithTypeListAndIndex","NotificationCenter","listen","EventType","UPDATE_SHARE_STATE","playAnimationAfterShareWithType","REWARD_VIDEO_COMPLETE","rewardVideoComplete","REWARD_VIDEO_COMPLETE_ERROR","rewardVideoCompleteError","index","hall","adManager","canPlay","string","number","GlobalFuncs","getRandomNumberBefore","ReadNumFromLocalStorage","OPEN_BOX_CLOSE_STATE","OPEN_BOX_CLOSE_STATE_CHECK","setBoxTypeWithType","delegate","spriteIndex","bottleNameList","indexOf","spriteFrame","onCheckBoxChange","onClose","BiLog","clickStat","clickStatEventType","clickStatEventTypeButtonClick","dayCount","OPEN_BOX_CLOSE_TIME","setInLocalStorage","toolUserTimeConfig","closeBoxTime","gameOver","afterGameOver","gamePause","gameGetBox","bottleCount","levelUp","destroy","onOpenBox","OPEN_BOX_CLOSE_TIME_CHECK","changeStateToGet","Share","shareWithType","onShareType","clickStatShareTypeOpenSecretBoxB","clickStatShareTypeOpenSecretBoxN","showRewardedVideo","isEnd","rewardedVideoType","MsgBoxManager","showToast","errorMsg","isCheck","resurgenceTime","showGameOverWithMyScore","showResurgence","shareType","resultType","title","rewardConfig","rand","Math","random","rewardType","rewardIndex","nowPercent","haveReward","i","treasureBoxTypeList","length","shareToGetreward","playGetPropBoxAni","setBulletType","propertyConfig","bulletType","onDestroy","ignoreScope","unscheduleAllCallbacks"],"mappings":"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","file":"shot_secret_box.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        textRich : {\n            default : null,\n            type : cc.RichText\n        },\n        boxSprite : {\n            default : null,\n            type : cc.Sprite\n        },\n        boxSpriteFrameList : [cc.SpriteFrame],\n        checkBoxButton : {\n            default : null,\n            type : cc.Button\n        },\n        checkBoxSprite : {\n            default : null,\n            type : cc.Sprite\n        },\n        // checkBoxSpriteFrameList : [cc.SpriteFrame],\n\n        boxType : \"\",\n        openType : \"\",\n        parentScene: {\n            default: null,\n            serializable: false\n        }\n    },\n    onLoad : function() {\n        var openConfig ;\n        if(shot.gameModel.getAllCheckConfig()){\n            openConfig = shot.GameWorld.treasureConfig.showAtWindow.tishen;\n        }else {\n            if(ty.UserInfo.isInBSGS ){\n                openConfig = shot.GameWorld.treasureConfig.showAtWindow.bsgs;\n            }else {\n                openConfig = shot.GameWorld.treasureConfig.showAtWindow.nBsgs;\n            }\n        }\n        var openTypeList = openConfig.openType;\n\n        var shareProbability = openConfig.shareProbability;\n        this.checkBoxButton.node.active = false;\n        this.chooseOpenTypeWithTypeListAndIndex(openTypeList,0,shareProbability);\n\n        ty.NotificationCenter.listen(shot.EventType.UPDATE_SHARE_STATE, this.playAnimationAfterShareWithType, this);\n        ty.NotificationCenter.listen(shot.EventType.REWARD_VIDEO_COMPLETE,this.rewardVideoComplete, this);\n        ty.NotificationCenter.listen(shot.EventType.REWARD_VIDEO_COMPLETE_ERROR,this.rewardVideoCompleteError, this);\n    },\n\n    chooseOpenTypeWithTypeListAndIndex : function (openTypeList,index,shareProbability) {\n        if(index > 3){\n            return;\n        }\n        this.checkBoxButton.node.active = false;\n        var type = openTypeList[index];\n        switch (type){\n            case \"ad\":{\n                if(hall.adManager.canPlay){\n                    this.openType = \"openAd\";\n                    this.textRich.string = \"<color=#ffffff><b>看视频开启</b></color>\";\n                }else {\n                   this.chooseOpenTypeWithTypeListAndIndex(openTypeList,index+1,shareProbability);\n                }\n                break\n            }\n            case \"share\":{\n                var number = hall.GlobalFuncs.getRandomNumberBefore(100);\n                if(number < shareProbability){\n                    if(hall.GlobalFuncs.ReadNumFromLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_STATE,0)){\n                        this.chooseOpenTypeWithTypeListAndIndex(openTypeList,index+1,shareProbability);\n                    }else {\n                        if(ty.UserInfo.isInBSGS){\n                            this.textRich.string = \"<color=#ffffff><b>免费开启</b></color>\";\n                        }else {\n                            this.textRich.string = \"<color=#ffffff><b>炫耀一下并开启</b></color>\";\n                        }\n                        this.openType = \"openShare\";\n                    }\n                }else {\n                    if(hall.adManager.canPlay){\n                        this.openType = \"openAd\";\n                        this.textRich.string = \"<color=#ffffff><b>看视频开启</b></color>\";\n                    }else {\n                        this.chooseOpenTypeWithTypeListAndIndex(openTypeList,index+1,shareProbability);\n                    }\n                }\n                break\n            }\n            case \"checkbox\":{\n                if(hall.GlobalFuncs.ReadNumFromLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_STATE_CHECK,0)){\n                    this.chooseOpenTypeWithTypeListAndIndex(openTypeList,index+1,shareProbability);\n                }else {\n                    this.textRich.string = \"<color=#ffffff><b>开启</b></color>\";\n                    this.openType = \"openShare\";\n                    this.checkBoxButton.node.active = true;\n                }\n                break\n            }\n            case \"direct\":{\n                this.textRich.string = \"<color=#ffffff><b>开启</b></color>\";\n                this.openType = \"open\";\n                break\n            }\n            default:break;\n        }\n    },\n    setBoxTypeWithType : function (boxType,delegate) {\n        this.boxType = boxType;\n        this.parentScene = delegate;\n\n        if(this.boxType == \"treasureBox1\"){\n            this.checkBoxButton.node.active = false;\n            this.textRich.string = \"<color=#ffffff><b>开启</b></color>\";\n            this.openType = \"open\";\n        }\n\n        var spriteIndex = shot.GameWorld.bottleNameList.indexOf(this.boxType);\n        this.boxSprite.spriteFrame = this.boxSpriteFrameList[spriteIndex-4];\n    },\n    onCheckBoxChange : function () {\n        if(this.openType == \"openShare\"){\n            this.textRich.string = \"<color=#ffffff><b>开启</b></color>\";\n            this.openType = \"open\";\n        }else {\n            this.textRich.string = \"<color=#ffffff><b>开启</b></color>\";\n            this.openType = \"openShare\";\n        }\n        this.checkBoxSprite.node.active = this.openType == \"openShare\";\n    },\n    onClose : function () {\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"closeBox\",this.openType,this.boxType]);\n\n        if(this.boxType == \"treasureBox\" && this.openType == \"openShare\"){\n            var dayCount = hall.GlobalFuncs.ReadNumFromLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_TIME,0);\n            hall.GlobalFuncs.setInLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_TIME,dayCount+1);\n            if(dayCount+1 >= shot.GameWorld.toolUserTimeConfig.closeBoxTime){\n                hall.GlobalFuncs.setInLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_STATE,1);\n            }\n        }\n\n        if(shot.GameWorld.gameOver){\n            this.afterGameOver();\n            return;\n        }\n        shot.GameWorld.gamePause = false;\n        shot.GameWorld.gameGetBox = false;\n        if(shot.GameWorld.bottleCount <= 0) { //一局的瓶子打完了\n            this.parentScene.levelUp();\n        }\n        this.node.destroy();\n    },\n\n    onOpenBox : function () {\n        // if(debugMode){\n        //     this.changeStateToGet();\n        //     return;\n        // }\n        if(this.boxType == \"treasureBox\" && this.openType == \"openShare\"){\n            hall.GlobalFuncs.setInLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_TIME,0);\n        }\n\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,[\"openBox\",this.openType,this.boxType]);\n        if(shot.GameWorld.gameOver){\n           this.afterGameOver();\n            return;\n        }\n        switch (this.openType){\n            case \"open\":{\n                if(this.checkBoxButton.node.active){\n                    var dayCount = hall.GlobalFuncs.ReadNumFromLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_TIME_CHECK,0);\n                    hall.GlobalFuncs.setInLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_TIME_CHECK,dayCount+1);\n                    if(dayCount+1 >= shot.GameWorld.toolUserTimeConfig.closeBoxTime){\n                        hall.GlobalFuncs.setInLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_STATE_CHECK,1);\n                    }\n                }\n                this.changeStateToGet();\n            }\n            break;\n            case \"openShare\":{\n                if(this.checkBoxButton.node.active){\n                    hall.GlobalFuncs.setInLocalStorage(shot.gameModel.OPEN_BOX_CLOSE_TIME_CHECK,0);\n                }\n                if(ty.UserInfo.isInBSGS ){\n                    shot.Share.shareWithType(shot.Share.onShareType.clickStatShareTypeOpenSecretBoxB);\n                }else {\n                    shot.Share.shareWithType(shot.Share.onShareType.clickStatShareTypeOpenSecretBoxN);\n                }\n            }\n                break;\n            case \"openAd\":{\n                hall.adManager.showRewardedVideo(\"openBox\");\n            }\n                break;\n            default : break;\n        }\n    },\n\n    rewardVideoComplete : function(isEnd){\n        if(hall.adManager.rewardedVideoType != \"openBox\"){\n            return;\n        }\n        if(isEnd){\n            this.changeStateToGet();\n        }else {\n            hall.MsgBoxManager.showToast({\"title\":\"视频播放未完成\"});\n        }\n    },\n\n    rewardVideoCompleteError : function (errorMsg) {\n        if(hall.adManager.rewardedVideoType != \"openBox\"){\n            return;\n        }\n        hall.MsgBoxManager.showToast({\"title\":errorMsg});\n        this.changeStateToGet();\n    },\n\n    afterGameOver : function () {\n        shot.GameWorld.gameGetBox = false;\n        hall.MsgBoxManager.showToast({\"title\":\"游戏已结束\"});\n        var isCheck = shot.gameModel.getAllCheckConfig();\n        if(shot.GameWorld.resurgenceTime >= shot.GameWorld.toolUserTimeConfig.resurgenceTime || isCheck){\n            shot.GlobalFuncs.showGameOverWithMyScore();\n        }else {\n            shot.GlobalFuncs.showResurgence();\n        }\n        this.node.destroy();\n    },\n\n    playAnimationAfterShareWithType : function (shareType) {\n\n        if (shareType && (shareType == shot.Share.onShareType.clickStatShareTypeOpenSecretBoxB ||\n            shareType == shot.Share.onShareType.clickStatShareTypeOpenSecretBoxN)) {\n            var resultType = shot.Share.resultType;\n            switch (resultType) {\n                case 1:\n                    hall.MsgBoxManager.showToast({title : '分享到群才有效哦~'});\n                    break;\n                case 2:\n                    hall.MsgBoxManager.showToast({title : '这个群今天已经打扰过了哦~'});\n                    break;\n                case 3:\n                    this.changeStateToGet();\n                    break;\n                case 6:\n                    hall.MsgBoxManager.showToast({title : '分享失败'});\n                    break;\n                default:\n                    hall.MsgBoxManager.showToast({title : '分享失败了'});\n                    break;\n            }\n        }\n        shot.Share.resultType = 0;\n    },\n\n    changeStateToGet : function () {\n        var rewardConfig = shot.GameWorld.treasureConfig.rewardConfig[this.boxType];\n        var rand = Math.random();\n        var rewardType;\n        var rewardIndex;\n        var nowPercent = 0;\n        var haveReward = false;\n        for (var i = 0 ; i < shot.GameWorld.treasureBoxTypeList.length ; i ++){\n            rewardIndex = i;\n            rewardType = shot.GameWorld.treasureBoxTypeList[i];\n            nowPercent += rewardConfig[rewardType];\n            if(rand <= nowPercent){\n                haveReward = true;\n                break;\n            }\n        }\n        if(!haveReward){\n            rewardIndex = hall.GlobalFuncs.getRandomNumberBefore(shot.GameWorld.treasureBoxTypeList.length);\n            rewardType = shot.GameWorld.treasureBoxTypeList[rewardIndex];\n        }\n\n        if(rewardType == \"laserGun\"){\n            shot.gameModel.shareToGetreward(10600002);//获得激光瞄准器\n        }else if(rewardType == \"infiniteBullet\"){\n            shot.gameModel.shareToGetreward(10600001);//获得无限子弹\n        }else if(rewardType == \"grenade\"){\n            shot.gameModel.shareToGetreward(10600005);//获得手榴弹\n        }else{\n            // shot.GlobalFuncs.playGetPropBoxAni(rewardIndex,shot.GameWorld.propertyConfig[rewardType].bulletType);\n            shot.GlobalFuncs.playGetPropBoxAni(rewardIndex);\n            shot.GlobalFuncs.setBulletType(shot.GameWorld.propertyConfig[rewardType].bulletType);\n        }\n        this.node.destroy();\n    },\n\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n        this.unscheduleAllCallbacks();\n    }\n    // LIFE-CYCLE CALLBACKS:\n\n    // start () {\n    //\n    // },\n\n    // update (dt) {},\n});\n"]}
{"version":3,"sources":["MsgFactory.js"],"names":["hall","MsgFactory","_TAG","_sendCmd","json","params","userId","ty","UserInfo","gameId","SystemInfo","hallId","clientId","TCP","sendMsg","bindUser","cmd","EventType","CMD_BIND_USER","authorCode","getUserInfo","LOGD","CMD_USER_INFO","sendHeartBeat","argument","HEART_BEAT","deviceId","getTimeStamp","shot","CMD_USER","getBagInfo","CMD_BAG_INFO","getGameData","CMD_GAME_DATA"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACAA,KAAKC,UAAL,GAAkB;AACdC,UAAM,iBADQ;;AAGd;AACAC,cAAU,kBAASC,IAAT,EAAe;AACrB;AACA;AACA,YAAI,CAACA,KAAKC,MAAV,EAAiB;AACbD,iBAAKC,MAAL,GAAc,EAAd;AACH;AACDD,aAAKC,MAAL,CAAYC,MAAZ,GAAqBF,KAAKC,MAAL,CAAYC,MAAZ,IAAsBC,GAAGC,QAAH,CAAYF,MAAvD;AACAF,aAAKC,MAAL,CAAYI,MAAZ,GAAqBL,KAAKC,MAAL,CAAYI,MAAZ,IAAsBF,GAAGG,UAAH,CAAcC,MAAzD;AACAP,aAAKC,MAAL,CAAYO,QAAZ,GAAuBL,GAAGG,UAAH,CAAcE,QAArC;;AAEAL,WAAGM,GAAH,CAAOC,OAAP,CAAeV,IAAf;AACH,KAfa;AAgBdW,cAAU,oBAAW;AACjB;AACA;AACA;AACA;;AAEA,YAAIC,MAAM;AACN,mBAAOT,GAAGU,SAAH,CAAaC,aADd;AAEN,sBAAU;AACN,8BAAcX,GAAGC,QAAH,CAAYW;AADpB;AAFJ,SAAV;AAMA,aAAKhB,QAAL,CAAca,GAAd;AACH,KA7Ba;;AAgCd;;;;AAIAI,iBAAa,qBAASX,MAAT,EAAiB;AAC1BT,aAAKqB,IAAL,CAAU,KAAKnB,IAAf,EAAqB,aAArB;AACA,YAAIO,UAAU,IAAV,IAAkB,OAAOA,MAAP,IAAkB,WAAxC,EAAqD;AACjDA,qBAASF,GAAGG,UAAH,CAAcC,MAAvB;AACH;;AAEDX,aAAKqB,IAAL,CAAU,KAAKnB,IAAf,EAAqB,0BAA0BO,MAA/C;AACA,YAAIJ,SAAS;AACT,mBAAOE,GAAGU,SAAH,CAAaK,aADX;AAET,sBAAW;AACP,0BAAUb;AADH;AAFF,SAAb;AAMA,aAAKN,QAAL,CAAcE,MAAd;AACH,KAlDa;AAmDd;AACAkB,mBAAe,uBAASC,QAAT,EAAmB;AAC9B,YAAIR,MAAM;AACN,mBAAOT,GAAGU,SAAH,CAAaQ,UADd;AAEN,sBAAU;AACN,4BAAYlB,GAAGG,UAAH,CAAcgB;AADpB;AAFJ,SAAV;AAMA,aAAKvB,QAAL,CAAca,GAAd;AACH,KA5Da;AA6DdW,kBAAc,wBAAW;AACrB3B,aAAKqB,IAAL,CAAU,KAAKnB,IAAf,EAAqB,cAArB;AACA,YAAIG,SAAS;AACT,mBAAUuB,KAAKX,SAAL,CAAeY,QADhB;AAET,sBAAU;AACN,0BAAU;AADJ;AAFD,SAAb;AAMA,aAAK1B,QAAL,CAAcE,MAAd;AACH,KAtEa;;AAwEd;AACAyB,gBAAY,sBAAW;AACnB,YAAIzB,SAAS;AACT,mBAAOuB,KAAKX,SAAL,CAAec,YADb;AAET,sBAAU;AACN,0BAAU;AADJ;AAFD,SAAb;AAMA,aAAK5B,QAAL,CAAcE,MAAd;AACH,KAjFa;;AAmFd;;;AAGA2B,iBAAa,qBAASvB,MAAT,EAAiB;AAC1B,YAAIJ,SAAS;AACT,mBAAOuB,KAAKX,SAAL,CAAegB,aADb;AAET,sBAAU;AACN,0BAAUxB;AADJ;AAFD,SAAb;;AAOA,aAAKN,QAAL,CAAcE,MAAd;AACH;AA/Fa,CAAlB","file":"MsgFactory.js","sourceRoot":"../../../../../assets/Script/hall","sourcesContent":["//\n//  MsgFactory.js\n//\n//  Created by xujing on 18-01-29.\n// 将向server发消息的逻辑统一放在这里\nhall.MsgFactory = {\n    _TAG: 'hall.MsgFactory',\n\n    // 发送出去消息\n    _sendCmd: function(json) {\n        // var strValue = JSON.stringify(json) + '\\r\\n';\n        // shot.LOGD(null, 'send msg in msg_factory :' + strValue);\n        if (!json.params){\n            json.params = {};\n        }\n        json.params.userId = json.params.userId || ty.UserInfo.userId;\n        json.params.gameId = json.params.gameId || ty.SystemInfo.hallId;\n        json.params.clientId = ty.SystemInfo.clientId;\n\n        ty.TCP.sendMsg(json);\n    },\n    bindUser: function() {\n        // 发送完bind_user，需要重置msg_center里的_bBindGame\n        // if (!hall.MsgCenter._bBindGame) {\n        //     hall.MsgCenter._bBindGame = true;\n        // }\n\n        var cmd = {\n            'cmd': ty.EventType.CMD_BIND_USER,\n            'params': {\n                'authorCode': ty.UserInfo.authorCode\n            }\n        };\n        this._sendCmd(cmd);\n    },\n\n\n    /**\n     * 获取UserInfo，大厅获取9999的UserInfo，单版获取6的\n     * 大厅也有获取6的user_info的时候，地主的新手奖励实在地主服的bind_game时发放的\n     */\n    getUserInfo: function(gameId) {\n        hall.LOGD(this._TAG, 'getUserInfo');\n        if (gameId == null || typeof(gameId) == 'undefined') {\n            gameId = ty.SystemInfo.hallId;\n        }\n\n        hall.LOGD(this._TAG, 'getUserInfo gameId = ' + gameId);\n        var params = {\n            'cmd': ty.EventType.CMD_USER_INFO,\n            'params' : {\n                'gameId': gameId\n            }\n        };\n        this._sendCmd(params);\n    },\n    // 心跳的消息\n    sendHeartBeat: function(argument) {\n        var cmd = {\n            'cmd': ty.EventType.HEART_BEAT,\n            'params': {\n                'deviceId': ty.SystemInfo.deviceId\n            }\n        };\n        this._sendCmd(cmd);\n    },\n    getTimeStamp: function() {\n        hall.LOGD(this._TAG, 'getTimeStamp');\n        var params = {\n            \"cmd\"   : shot.EventType.CMD_USER,\n            \"params\": {\n                \"action\" :\"sync_timestamp\"\n            }\n        };\n        this._sendCmd(params);\n    },\n\n    //获取背包信息\n    getBagInfo: function() {\n        var params = {\n            'cmd': shot.EventType.CMD_BAG_INFO,\n            'params': {\n                'action': 'update'\n            }\n        };\n        this._sendCmd(params);\n    },\n\n    /**\n     * 获取gameData，大厅版本需要区分是获取9999的gameId还是6的gameId\n     */\n    getGameData: function(gameId) {\n        var params = {\n            'cmd': shot.EventType.CMD_GAME_DATA,\n            'params': {\n                'gameId': gameId\n            }\n        };\n\n        this._sendCmd(params);\n    },\n};"]}
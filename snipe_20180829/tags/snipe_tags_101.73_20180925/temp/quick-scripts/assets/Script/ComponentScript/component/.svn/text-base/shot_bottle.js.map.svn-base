{"version":3,"sources":["shot_bottle.js"],"names":["cc","Class","extends","Component","ctor","bottleInfoDictionary","properties","windowWidth","bottleSprite","default","type","Sprite","bottleSpriteList","SpriteFrame","bottleSpriteList1","bottleSpriteList2","bottleSpriteList3","bottleSpriteList4","bucket","isAction","lifeCount","sitNumber","jugglingNodeX","byRotation","verticalJugglingSpeed","horizontalJugglingSpeed","fromRight","onLoad","winSize","director","getWinSize","width","getJugglingNodeX","getJugglingNodeY","node","y","setBottleOriginInformationForJuggling","x","setBottleTypeForJuggling","typeConfig","originX","originY","originRotation","shot","GameWorld","bottleConfig","spriteFrame","bottleNameList","indexOf","active","rotation","radius","hall","GlobalFuncs","getRandomNumberBefore","maxRadius","minRadius","Math","PI","sin","speed","cos","changeNodeStateForJuggling","setBottleType","height","bottleHit","direction","nowBulletPenetrate","bulletBlood","receiveBottleLifeCount","AudioHelper","playEffect","EffectPath_mp3","endSmash","headSmash","centerSmash","update","dt","missBottleOne","verticalAccelerate","onDestroy","ty","NotificationCenter","ignoreScope","unscheduleAllCallbacks"],"mappings":"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","file":"shot_bottle.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/component","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n    ctor : function () {\n        this.bottleInfoDictionary ={};\n    },\n\n    properties: {\n        windowWidth : 0,\n        bottleSprite : {\n            default : null,\n            type : cc.Sprite\n        },\n        bottleSpriteList : [cc.SpriteFrame],\n        bottleSpriteList1 : [cc.SpriteFrame],\n        bottleSpriteList2 : [cc.SpriteFrame],\n        bottleSpriteList3 : [cc.SpriteFrame],\n        bottleSpriteList4 : [cc.SpriteFrame],\n\n        type : \"\",\n        bucket : {\n            default : null\n        },\n\n        isAction : false,\n        lifeCount : 0,\n        sitNumber : 0,\n\n        jugglingNodeX : 0,\n        byRotation : 0,\n        verticalJugglingSpeed : 0,\n        horizontalJugglingSpeed : 0,\n        fromRight : false\n    },\n\n    onLoad : function() {\n        var winSize = cc.director.getWinSize();\n        this.windowWidth = winSize.width/2;\n\n        this.bottleInfoDictionary = {};\n        this.bottleInfoDictionary.lifeCount = this.lifeCount;\n        this.bottleInfoDictionary.type = this.type;\n        this.bottleInfoDictionary.sitNumber = this.sitNumber;\n    },\n\n    //飞碟模式\n    getJugglingNodeX : function () {\n      return this.jugglingNodeX;\n    },\n    getJugglingNodeY : function () {\n        return this.node.y;\n    },\n    setBottleOriginInformationForJuggling : function (bucket,jugglingNodeX) {\n        this.bucket = bucket;\n        this.jugglingNodeX = jugglingNodeX;\n        this.node.x = this.jugglingNodeX;\n        this.verticalJugglingSpeed = 0;\n        this.horizontalJugglingSpeed = 0;\n    },\n    setBottleTypeForJuggling : function (type,typeConfig,originX,originY,originRotation,byRotation,fromRight) {\n        this.type = type;\n        this.lifeCount = shot.GameWorld.bottleConfig[type].lifeCount;\n        this.bottleInfoDictionary.type = this.type;\n        this.bottleInfoDictionary.lifeCount = this.lifeCount;\n        this.bottleSprite.spriteFrame = this.bottleSpriteList[shot.GameWorld.bottleNameList.indexOf(type)];\n        this.bottleSprite.node.active = true;\n        this.node.active = true;\n\n        this.jugglingNodeX = originX;\n        this.node.x = this.jugglingNodeX;\n        this.node.y = originY;\n        this.node.rotation = originRotation;\n        this.byRotation = byRotation;\n        // this.minRadius = typeConfig.minRadius;\n        // this.maxRadius = typeConfig.maxRadius;\n        // this.speed = typeConfig.speed;\n        var radius = (hall.GlobalFuncs.getRandomNumberBefore(typeConfig.maxRadius-typeConfig.minRadius+1) + typeConfig.minRadius)*2*Math.PI/360;\n\n        this.verticalJugglingSpeed = Math.sin(radius)*typeConfig.speed;\n        this.horizontalJugglingSpeed = Math.cos(radius)*typeConfig.speed;\n        this.fromRight = fromRight;\n\n    },\n    changeNodeStateForJuggling : function () {\n        this.bottleSprite.node.active = true;\n    },\n\n    //正常模式\n    setBottleType : function (type,bucket,height,sitNumber) {\n        this.bucket = bucket;\n        this.type = type;\n        this.sitNumber = sitNumber;\n        this.lifeCount = shot.GameWorld.bottleConfig[type].lifeCount;\n        // this.bottleInfoDictionary.bucketType = this.bucketType;\n        this.bottleInfoDictionary.type = this.type;\n        this.bottleInfoDictionary.lifeCount = this.lifeCount;\n        this.bottleInfoDictionary.sitNumber = this.sitNumber;\n        this.bottleSprite.spriteFrame = this.bottleSpriteList[shot.GameWorld.bottleNameList.indexOf(type)];\n        this.bottleSprite.node.active = true;\n        this.bottleSprite.node.y = height;\n    },\n\n    bottleHit : function (direction) {\n        if(shot.GameWorld.nowBulletPenetrate <= 0){\n            return false;\n        }\n        if(this.lifeCount <= 0){\n            return false;\n        }\n        shot.GameWorld.nowBulletPenetrate --;\n        this.lifeCount -= shot.GameWorld.bulletBlood;\n        this.lifeCount = this.lifeCount < 0 ? 0 : this.lifeCount;\n        this.bottleInfoDictionary.lifeCount = this.lifeCount;\n        if(direction){\n            this.bottleInfoDictionary.direction = direction;\n        }\n        this.bucket.receiveBottleLifeCount(this.bottleInfoDictionary,this);\n        if(this.lifeCount == 0){\n            shot.AudioHelper.playEffect(shot.EffectPath_mp3.endSmash,false);\n            this.node.active = false;\n        }else {\n            if (shot.GameWorld.bottleConfig[this.type].lifeCount == this.lifeCount + 1) {\n                shot.AudioHelper.playEffect(shot.EffectPath_mp3.headSmash,false);\n            }else {\n                shot.AudioHelper.playEffect(shot.EffectPath_mp3.centerSmash,false);\n            }\n            this.bottleSprite.spriteFrame = this[\"bottleSpriteList\"+this.lifeCount][shot.GameWorld.bottleNameList.indexOf(this.type)];\n        }\n        return true;\n        // hall.LOGW(\"=====\",\"======bottleHit======\"+this.lifeCount);\n    },\n\n    update : function(dt) {\n        if(this.horizontalJugglingSpeed != 0){\n            if(this.fromRight){\n                this.jugglingNodeX -= this.horizontalJugglingSpeed*dt;\n                this.node.x = this.jugglingNodeX;\n                if(this.node.x < -this.windowWidth){\n                    this.bucket.missBottleOne(this,this.fromRight);\n                }\n            }else {\n                this.jugglingNodeX += this.horizontalJugglingSpeed*dt;\n                this.node.x = this.jugglingNodeX;\n                if(this.node.x > this.windowWidth){\n                    this.bucket.missBottleOne(this,this.fromRight);\n                }\n            }\n\n            this.verticalJugglingSpeed -= shot.GameWorld.verticalAccelerate*dt;\n            this.node.y += this.verticalJugglingSpeed*dt;\n            this.node.rotation += this.byRotation;\n\n        }\n    },\n\n    // afterAnimation : function () {\n    //     this.isAction = false;\n    // },\n\n    onDestroy : function () {\n        ty.NotificationCenter.ignoreScope(this);\n        this.unscheduleAllCallbacks();\n    }\n\n    // start () {\n    //\n    // },\n\n});\n"]}
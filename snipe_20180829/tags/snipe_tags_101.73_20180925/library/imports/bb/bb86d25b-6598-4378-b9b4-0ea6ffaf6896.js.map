{"version":3,"sources":["../../../../../assets/Script/shot/assets/Script/shot/shotAudioHelper.js"],"names":["shot","AudioHelper","getMusicPlayManager","stopMusic","musicPlayManager","wx","createInnerAudioContext","obeyMuteSwitch","playMusic","file","isloop","volume","stop","_curMusicFile","playManager","arguments","length","autoplay","loop","src","ty","SystemInfo","cdnPath","rePlayMusic","play","destroy","playEffect","onStop","stopEffectWithInnerAudioContext","innerAudioContext","stopEffect","effectId","cc","audioEngine","stopAllEffects","unloadAll","uncacheAll","setEffectsVolume","val","hall","GlobalFuncs","setInLocalStorage","SETTING_EFFECT_KEY","setMusicVolume","SETTING_MUSIC_KEY","getMusicVolume","ReadNumFromLocalStorage","getEffectsVolume"],"mappings":"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","file":"shotAudioHelper.js","sourceRoot":"../../../../../assets/Script/shot","sourcesContent":["/**\n * 声音播放工具\n */\nshot.AudioHelper = {\n\n\tgetMusicPlayManager:function () {\n\n\t\tthis.stopMusic();\n\n\t\tthis.musicPlayManager = wx.createInnerAudioContext();\n\t\tthis.musicPlayManager.obeyMuteSwitch = true;\n\t\treturn this.musicPlayManager;\n\t},\n\n\t/**\n\t * 播放音乐 (音效只可以播放一个,如果再调用此方法,之前的音乐会被停止)\n\t * @param file 文件名,例如: '/resources/sound/table_sound_After_the_bomb.mp3'\n\t * @param isloop 是否循环\n\t * @param volume 可选参数,音量\n     */\n\tplayMusic : function (file, isloop, volume) {\n\n\t\t// if (this._curMusicFile && this._curMusicFile == file){\n\t\t// \tthis.musicPlayManager.stop();\n\t\t// \treturn;\n\t\t// }\n\n\t\tif(this.musicPlayManager){\n\t\t\tthis.musicPlayManager.stop();\n\t\t}\n\n\t\tthis._curMusicFile = file;\n\n\t\t// if (arguments.length == 3){\n\t\t// \tthis.setMusicVolume(volume);\n\t\t// }\n\t\t// cc.audioEngine.playMusic(cc.url.raw(file), isloop);\n\t\tvar playManager = this.getMusicPlayManager();\n\n\t\tif (arguments.length == 3){\n\t\t\tplayManager.volume = volume;\n\t\t}\n\n\t\tplayManager.autoplay = true;\n\t\tplayManager.loop = isloop;\n\t\t// playManager.src = ty.SystemInfo.cdnPath + cc.url.raw(file);\n\t\tplayManager.src = ty.SystemInfo.cdnPath+file;\n\t},\n\n\trePlayMusic:function () {\n\t\tif (this.musicPlayManager && this.musicPlayManager.loop){\n\t\t\tthis.musicPlayManager.play();\n\t\t}\n\t},\n\n\tstopMusic:function () {\n\t\tif (this.musicPlayManager){\n\t\t\tthis.musicPlayManager.stop();\n\t\t\tthis.musicPlayManager.destroy();\n\t\t\tthis.musicPlayManager = null;\n\t\t}\n\t},\n\n\n\t/**\n\t * 播放音效 (音效可以同时播放多个)\n\t * @param file 文件名,例如: '/resources/sound/table_sound_After_the_bomb.mp3'\n\t * @param isloop 是否循环\n\t * @param volume 可选参数,音量\n\t */\n\tplayEffect : function (file, isloop, volume) {\n\t\tvar  playManager = wx.createInnerAudioContext();\n\t\tplayManager.obeyMuteSwitch = true;\n\n\t\t// var playManager = this.getMusicPlayManager();\n\t\t// if (arguments.length == 3){\n\t\t// \tthis.setEffectsVolume(volume);\n\t\t// }\n\t\tif (arguments.length == 3){\n\t\t\tplayManager.volume = volume;\n\t\t}else {\n\t\t\tplayManager.volume = 1;\n\t\t}\n\t\tplayManager.autoplay = true;\n\t\tplayManager.loop = isloop;\n\t\t// playManager.src = ty.SystemInfo.cdnPath + cc.url.raw(file);\n\t\tplayManager.src = ty.SystemInfo.cdnPath+file;\n\t\tif(file == \"/resources/sound/gunshot.mp3\"){\n\t\t\tplayManager.src = file;\n\t\t}\n\n\t\t// cc.audioEngine.playEffect(ty.SystemInfo.cdnPath + cc.url.raw(file), isloop);\n\t\tplayManager.onStop(function () {\n\t\t\tplayManager.destroy();\n\t\t\tplayManager = null;\n\t\t});\n\t\treturn playManager;\n\t},\n\n\tstopEffectWithInnerAudioContext : function (innerAudioContext) {\n\t\tif(!innerAudioContext){\n\t\t\treturn;\n\t\t}\n\t\tinnerAudioContext.stop();\n\t\tinnerAudioContext.destroy();\n\t\tinnerAudioContext = null;\n\t},\n\n\t/**\n\t * 停止音效\n\t * @param effectId\n     */\n\tstopEffect: function(effectId) {\n\t\tif(effectId < 0) {\n\t\t\treturn;\n\t\t}\n\t\tcc.audioEngine.stopEffect(effectId);\n\t},\n\n\t/**\n\t * 停止所有音效\n     */\n\tstopAllEffects: function() {\n\t\tcc.audioEngine.stopAllEffects();\n\t},\n\n\t/**\n\t * 卸载所有文件\n     */\n\tunloadAll: function() {\n\t\tcc.audioEngine.uncacheAll();\n\t},\n\n\t/**\n\t * 更改音效音量\n\t * @param val 音量\n     */\n\tsetEffectsVolume : function (val) {\n\t\thall.GlobalFuncs.setInLocalStorage(shot.SETTING_EFFECT_KEY, val);\n\t\tcc.audioEngine.setEffectsVolume(val);\n\t},\n\n\t/**\n\t * 更改音乐音量\n\t * @param val 音量\n\t */\n\tsetMusicVolume : function (val) {\n\t\thall.GlobalFuncs.setInLocalStorage(shot.SETTING_MUSIC_KEY, val);\n\t\tcc.audioEngine.setMusicVolume(val);\n\t},\n\n\t/**\n\t * 获取音乐音量\n     */\n\tgetMusicVolume: function() {\n\t\treturn hall.GlobalFuncs.ReadNumFromLocalStorage(shot.SETTING_MUSIC_KEY, cc.audioEngine.getMusicVolume());\n\t},\n\n\t/**\n\t * 获取音效音量\n     */\n\tgetEffectsVolume: function() {\n\t\treturn hall.GlobalFuncs.ReadNumFromLocalStorage(shot.SETTING_EFFECT_KEY, cc.audioEngine.getEffectsVolume());\n\t}\n};\n"]}
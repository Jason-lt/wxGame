{"version":3,"sources":["TableInfo.js"],"names":["ddz","_TableInfo","cc","Class","ctor","config","m_mincoin","m_maxseat","m_sfee","m_base","m_maxcoin","m_coin2chip","m_optime","m_grab","m_basemulti","m_roommulti","m_untiCheat","m_autoChange","m_passtime","m_tbbox","m_isMingPai","m_optimedis","m_maxMulti","m_couponrule","complain","m_nComplainFee","m_nComplainCompensation","m_strComplainGameNum","normal","m_tableId","m_roomId","m_name","m_pwd","m_boxConfig","ftInfo","typeName","smiliesConf","mCardNote","isMatch","matchNote","m_customTableId","nameList","disbind","roomName","playMode","seats","hall","LOGD","getSceneType","type","Enums","SceneType","ARENA","MATCH","FRIEND","NORMAL","roomId","tableId","getConfig","tag","destroy","cleanup","parseConfigInfo","json","parseNormalInfo","info","parseTableInfo","hasOwnProperty","customTableId","FtInfo","name","mixId","ty","NotificationCenter","trigger","EventType","TABLE_INFO_CHAGE","parseComplain","result","gamenum","com","Reset"],"mappings":"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","file":"TableInfo.js","sourceRoot":"../../../../../../assets/Script/ddz/models","sourcesContent":["// Create by Zhanghaibin on 14-03-05\n\n// 一个桌子的基本信息，游戏开始时候初始化，在整个牌局中保持不变。\n//牌局中变化的信息在table_state中\nddz._TableInfo = cc.Class({\n\n    ctor:function(){\n\n        // 配置信息\n        this.config = {\n            m_mincoin:0,        // 最小金币携带数\n            m_maxseat:0,        // 桌子最多人数，仅在比赛场有效，标记4、5、6人桌。\n            m_sfee:0,           // 抽水\n            m_base:0,           // 基数\n            m_maxcoin:0,        // 最大金币携带数\n            m_coin2chip:0,      // 金币筹码兑换比例\n            m_optime:0,         // 超时时间\n            m_grab:0,           // 抢地主或者是叫地主玩法, 默认为1，即欢乐抢地主玩法\n            m_basemulti:0,      // 基本(初始)倍数\n            m_roommulti:1,      // 房间倍数\n            m_untiCheat:0,      // 是否防作弊桌(0是no，1是yes)\n            m_autoChange:0,     // 是否自动换桌(0是no，1是yes)\n            m_passtime:0,       // 管不上的时间\n            m_tbbox:0,          // 是否有宝箱(0是no，1是yes)\n            m_isMingPai:0,      // 是否有明牌功能\n            m_optimedis:\"\",\n            m_maxMulti:0,\n            m_couponrule:''     //奖券规则\n        };\n        // 投诉信息\n        this.complain = {\n           m_nComplainFee:-1,           // 投诉所需要的费用\n           m_nComplainCompensation:-1,  // 投诉补偿金\n           m_strComplainGameNum:\"\"      // 局号\n        };\n\n        // 基本信息\n        //谁在哪个房间哪个桌子\n        this.normal = {\n            m_tableId:0,            // 桌子id\n            m_roomId:0,            // 桌子所属的房间号\n            m_name:\"\",          // 名字\n            m_pwd:\"\"            // 密码\n        };\n\n        // 投诉信息\n        this.m_boxConfig= [{\n            \"windoubles\": \"12\",\n            \"isHaveCoupon\": 0,\n            \"boxType\": \"青铜宝箱\"\n        }, {\n            \"windoubles\": \"24\",\n            \"isHaveCoupon\": 0,\n            \"boxType\": \"白银宝箱\"\n        }, {\n            \"windoubles\": \"48\",\n            \"isHaveCoupon\": 1,\n            \"boxType\": \"黄金宝箱\"\n        },{\n            \"windoubles\": \"\",\n            \"isHaveCoupon\": 1,\n            \"boxType\": \"春天宝箱\"\n        }];\n\n\n        this.ftInfo = null;\n        this.typeName = null;\n        //配置信息\n        this.smiliesConf = null;\n        this.mCardNote= null;\n\n        //比赛场信息\n        this.isMatch = 0;\n        this.matchNote = null;\n        this.m_customTableId = 0;\n        this.nameList = [];\n        this.disbind = null;\n        this.roomName = \"\";\n        // this.roomName = \"\";\n        this.playMode = \"\";\n        this.seats = [];\n        hall.LOGD(null, \"in ctor new ddz.TableInfo\");\n    },\n\n    /**\n     * 获取当前的场景类型\n     * @returns {number}\n     */\n    getSceneType:function () {\n        var type = null;\n        switch(this.typeName) {\n            case 'async_common_arena_match':\n                type = ddz.Enums.SceneType.ARENA;\n                break;\n            case 'async_upgrade_hero_match':\n                type = ddz.Enums.SceneType.MATCH;\n                break;\n            case 'dizhu_friend':\n                type = ddz.Enums.SceneType.FRIEND;\n                break;\n            case 'dizhu_normal':\n                type = ddz.Enums.SceneType.NORMAL;\n                break;\n        }\n        // if(type === null) {\n        //     if (this.isMatch){\n        //         return ddz.Enums.SceneType.MATCH;\n        //     }else if (this.ftInfo){\n        //         return ddz.Enums.SceneType.FRIEND;\n        //     }\n        //     return ddz.Enums.SceneType.NORMAL;\n        // } else {\n            return type;\n        // }\n    },\n\n    //提供几个接口函数\n    roomId: function() {\n        return this.normal.m_roomId;\n    },\n    tableId: function() {\n        return this.normal.m_tableId;\n    },\n    getConfig: function(tag) {\n        return this.config[tag];\n    },\n    //默认的析构函数\n    destroy:function(){\n        this.config = null;\n        this.complain = null;\n        this.normal = null;\n        this.mCardNote = null;\n        this.typeName = null;\n        this.nameList = [];\n        this.disbind = null;\n        if (this.ftInfo){\n            this.ftInfo.cleanup();\n            this.ftInfo = null;\n        }\n        hall.LOGD(null, \"destroy in ddz.TableInfo\");\n    },\n\n    // 转化配置信息\n    parseConfigInfo:function(json){\n        var config = this.config;\n        config.m_mincoin = json[\"mincoin\"];\n        config.m_maxseat = json[\"maxseat\"];\n        config.m_maxMulti = json[\"maxMulti\"];\n        config.m_sfee = json[\"sfee\"];\n        config.m_base = json[\"base\"];\n        config.m_maxcoin = json[\"maxcoin\"];\n        config.m_coin2chip = json[\"coin2chip\"];\n        config.m_optime = json[\"optime\"];\n        config.m_grab = json[\"grab\"];\n        config.m_basemulti = json[\"basemulti\"];\n        config.m_roommulti = json[\"roommulti\"];\n        config.m_untiCheat = json[\"untiCheat\"];\n        config.m_autoChange = json[\"autoChange\"];\n        config.m_passtime = json[\"passtime\"];\n        config.m_tbbox = json[\"tbbox\"];\n        config.m_isMingPai = json[\"isMingPai\"];\n        config.m_optimedis = json[\"optimedis\"];\n\n        if(2 >= config.m_passtime){\n            config.m_passtime = 5;\n        }\n\n        config.m_couponrule = json[\"couponrule\"];\n    },\n\n    // 转化基本信息\n    parseNormalInfo:function(info){\n        var normal = this.normal;\n        normal.m_tableId = info[\"tableId\"];\n        normal.m_roomId = info[\"roomId\"];\n        normal.m_name = info[\"name\"];\n        normal.m_pwd = info[\"pwd\"];\n\n        hall.LOGD(null, \"parseNormalInfo in ddz.TableInfo\");\n    },\n\n    //转化json数据\n    parseTableInfo:function(json){\n        if(json.hasOwnProperty('info')){\n            hall.LOGD(null, 'parseNormalInfo...');\n            this.parseNormalInfo(json[\"info\"]);\n        }\n\n        this.isMatch = json[\"isMatch\"];\n\n        if(json.hasOwnProperty('config')){\n            hall.LOGD(null, 'parseConfigInfo...');\n            this.parseConfigInfo(json[\"config\"]);\n        }\n\n        var customTableId = json[\"customTableId\"];\n\n        if(json.hasOwnProperty('customTableId')) {\n            this.m_customTableId = customTableId;\n        }\n\n        this.smiliesConf = json[\"smiliesConf\"];\n\n        if(json.hasOwnProperty('cardNote')){\n            this.mCardNote = json[\"cardNote\"];\n        }\n\n        if(json.hasOwnProperty('boxConfig')){\n            // json[\"boxConfig\"].sort(function(a, b) {\n            //     if (a.windoubles == \"\" || b.windoubles == \"\") {\n            //         return 1;\n            //     } else {\n            //         return a.windoubles - b.windoubles;\n            //     }});\n            this.m_boxConfig = json[\"boxConfig\"];\n        }\n\n        if (json.hasOwnProperty('ftInfo')){\n            if (!this.ftInfo){\n                this.ftInfo = new ddz.FtInfo();\n            }\n            this.ftInfo.parseTableInfo(json)\n        }\n        if(json.hasOwnProperty('seat1')){\n            this.nameList = [json[\"seat1\"].name,json[\"seat2\"].name,json[\"seat3\"].name];\n            this.seats = [];\n            this.seats = [json[\"seat1\"], json[\"seat2\"], json[\"seat3\"]];\n        }\n        if(json.hasOwnProperty('disbind')){\n            this.disbind = json.disbind;\n        }\n        if(json.hasOwnProperty('mixId')){\n            this.mixId = json.mixId;\n        }\n        if(json.hasOwnProperty('roomName')){\n            this.roomName = json.roomName;\n        }\n        if(json.hasOwnProperty('playMode')){\n            this.playMode = json.playMode;\n        }\n\n        this.typeName = json.typeName;\n        ty.NotificationCenter.trigger(ddz.EventType.TABLE_INFO_CHAGE, this);\n    },\n\n    parseComplain : function(result) {\n        var complain = this.complain;\n        var gamenum = result[\"gameNum\"];\n        if(gamenum) {\n            complain.m_strComplainGameNum = gamenum;\n        }\n        var com = result[\"complain\"];\n        if(com){\n            complain.m_nComplainFee = com[\"fee\"] || -1;\n            complain.m_nComplainCompensation = com[\"compensation\"] || -1;\n        }\n    },\n\n    //重置\n    Reset:function(){\n        var config = this.config;\n        config.m_base = 0;\n        config.m_grab = 0;\n        config.m_roommulti = 1;\n        config.m_untiCheat = 0;\n        config.m_tbbox = 0;\n        config.m_isMingPai = 0;\n        this.matchNote = null;\n        this.isMatch = 0;\n    }\n});"]}
{"version":3,"sources":["Card.js"],"names":["cc","Class","extends","Component","ctor","_info","ddz","CardInfo","_redNumTypes","Enums","CardColor","CARD_COLOR_HONGTAO","CARD_COLOR_FANGPIAN","_oldP","_moveTime","properties","tagSprites","SpriteFrame","numBlackSprites","numRedSprites","numGoldenSprites","numJokSprites","laiziSmallTag","foreBack","default","type","Sprite","cardNum","cardNumJok","tagSmall","tagBig","dizhuTag","cardMask","cardType","setDiZhuTag","value","CardSize","CARD_SIZE_BIG","setVisible","resetWithNum","num","refreshInfoFromNum","numArr","indexOf","_color","_type","CardType","CARD_TYPE_NORMAL","spriteFrame","_point","CARD_TYPE_KING","CARD_TYPE_LAIZI","tagSpriteFrame","smallSpriteFrame","up","toY","y","node","height","toX","x","acMove","moveTo","p","stopAllActions","runAction","down","withOutAni","arguments","length","setPosition","setOldPosition","setZIndex","zIndex","_isking","_isLaizi","showMask","bVisible","showTag","dump","onLoad","start","onDestroy"],"mappings":"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","file":"Card.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/component","sourcesContent":["/**\n * 扑克牌，手牌\n */\ncc.Class({\n    extends: cc.Component,\n    ctor:function () {\n        this._info = new ddz.CardInfo();\n        //红色数字的牌类型\n        this._redNumTypes = [ddz.Enums.CardColor.CARD_COLOR_HONGTAO, ddz.Enums.CardColor.CARD_COLOR_FANGPIAN];\n        this._oldP = null;\n        this._moveTime = 0.05;\n    },\n\n    properties: {\n\n        tagSprites : [\n            cc.SpriteFrame\n        ],\n\n        numBlackSprites : [\n            cc.SpriteFrame\n        ],\n\n        numRedSprites : [\n            cc.SpriteFrame\n        ],\n\n        numGoldenSprites : [ //癞子牌的数字\n            cc.SpriteFrame\n        ],\n\n        numJokSprites : [\n            cc.SpriteFrame\n        ],\n\n        laiziSmallTag : cc.SpriteFrame, //癞子牌的小花\n\n        foreBack : {\n            default : null,\n            type : cc.Sprite\n        },\n        cardNum : {\n            default : null,\n            type : cc.Sprite\n        },\n        cardNumJok : {\n            default : null,\n            type : cc.Sprite\n        },\n        tagSmall : {\n            default : null,\n            type : cc.Sprite\n        },\n        tagBig : {\n            default : null,\n            type : cc.Sprite\n        },\n        dizhuTag : {\n            default : null,\n            type : cc.Sprite\n        },\n        cardMask : {\n            default : null,\n            type : cc.Sprite\n        },\n        cardType : 1\n    },\n\n    /**\n     * 设置地主角标\n     * @param value true or false\n     */\n    setDiZhuTag : function(value) {\n        if (this.cardType == ddz.Enums.CardSize.CARD_SIZE_BIG) {\n            this.dizhuTag.setVisible(value);\n        }\n    },\n\n    resetWithNum: function(num) {\n        this._info.refreshInfoFromNum(num);\n        //设置点数\n        var numArr = this._redNumTypes.indexOf(this._info._color) > -1 ? this.numRedSprites : this.numBlackSprites;\n        if (this._info._type == ddz.Enums.CardType.CARD_TYPE_NORMAL){\n            //非王牌\n            this.cardNum.setVisible(true);\n            this.tagSmall.setVisible(true);\n            this.cardNumJok.setVisible(false);\n            this.cardNum.spriteFrame = numArr[this._info._point];\n        }\n        else if (this._info._type == ddz.Enums.CardType.CARD_TYPE_KING){\n            this.cardNum.setVisible(false);\n            this.tagSmall.setVisible(false);\n            this.cardNumJok.setVisible(true);\n            this.cardNumJok.spriteFrame = this._info._point == 13 ? this.numJokSprites[1] : this.numJokSprites[0];\n        }\n        else if (this._info._type == ddz.Enums.CardType.CARD_TYPE_LAIZI){\n            this.cardNum.setVisible(true);\n            this.tagSmall.setVisible(true);\n            this.cardNumJok.setVisible(false);\n            this.cardNum.spriteFrame = this.numGoldenSprites[this._info._point];\n        }\n\n        //设置花\n        var tagSpriteFrame, smallSpriteFrame;\n        if (this._info._type == ddz.Enums.CardType.CARD_TYPE_NORMAL){\n            //正常牌\n            tagSpriteFrame = this.tagSprites[this._info._color - 1];\n            smallSpriteFrame = tagSpriteFrame;\n        }\n        else if (this._info._type == ddz.Enums.CardType.CARD_TYPE_KING){\n            //王牌\n            tagSpriteFrame = this._info._point == 13 ? this.tagSprites[5] : this.tagSprites[4];\n            smallSpriteFrame = tagSpriteFrame;\n        }\n        else if (this._info._type == ddz.Enums.CardType.CARD_TYPE_LAIZI){\n            //癞子\n            tagSpriteFrame = this.tagSprites[6];\n            smallSpriteFrame = this.laiziSmallTag;\n        }\n\n        this.tagSmall.spriteFrame = smallSpriteFrame;\n        if (this.cardType == ddz.Enums.CardSize.CARD_SIZE_BIG && this.tagBig){\n            this.tagBig.spriteFrame = tagSpriteFrame;\n        }\n\n    },\n\n    up:function () {\n        //有问题:this._oldP不存在\n        if (!this._oldP) return;\n        var toY = this._oldP.y + this.node.height * 0.1;\n        var toX = this.node.x;\n        // this.node.y = this._oldP.y + this.node.height * 0.1;\n        var acMove = cc.moveTo(this._moveTime, cc.p(toX, toY));\n        this.node.stopAllActions();\n        this.node.runAction(acMove);\n    },\n\n    down:function (withOutAni) {\n        if (arguments.length == 0){\n            withOutAni = false;\n        }\n        // this.node.y = this._oldP.y;\n        this.node.stopAllActions();\n        if (!this._oldP) return;\n        if (withOutAni){\n            this.node.y = this._oldP.y;\n        }\n        else{\n            var acMove = cc.moveTo(this._moveTime, cc.p(this.node.x, this._oldP.y));\n            this.node.runAction(acMove);\n        }\n    },\n\n    setPosition:function (value) {\n        this.setOldPosition(value);\n        this.node.setPosition(value);\n    },\n\n    setOldPosition:function (value) {\n        this._oldP = value;\n    },\n\n    setZIndex:function (value) {\n        this.node.zIndex = value;\n    },\n\n    /**\n     * 是否是王\n     * @param num\n     * @returns {boolean}\n     * @private\n     */\n    _isking: function(num) {\n        return num == 52 || num == 53;\n    },\n\n    /**\n     * 是否是癞子点\n     * @param num\n     * @returns {boolean}\n     * @private\n     */\n    _isLaizi: function(num) {\n        return num > 53;\n    },\n\n    /**\n     * 显示半透明遮罩\n     * @param bVisible\n     */\n    showMask: function(bVisible) {\n        if (this.cardType == ddz.Enums.CardSize.CARD_SIZE_BIG) {\n            this.cardMask.setVisible(bVisible);\n        }\n    },\n\n    showTag:function (value) {\n        this.tagBig.setVisible(value);\n    },\n\n    dump : function() {\n        this._info.dump();\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad :function() {},\n\n    start : function () {\n    },\n    onDestroy : function () {\n\n    }\n\n    // update (dt) {},\n});"]}
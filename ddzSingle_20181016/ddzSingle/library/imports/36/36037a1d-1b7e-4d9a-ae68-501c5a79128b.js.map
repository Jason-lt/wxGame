{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/singleAI/assets/Script/ComponentScript/singleAI/ddzsingle_prop_logic.js"],"names":["ddz","offLinePropLogic","tag","playContent","isDoubleGain","isAvoidLose","fromLeftCard","toLeftCard","exchangeGetCardSprite","exchangeGetId","obj","useDoubleGain","_bottomController","setVisible","useAvoidLose","checkPropWorkOnCard","_selectedCards","length","str","STRING","DDZ_OFFLINE_PROP_LOGIC_STRING_1000","DDZ_OFFLINE_PROP_LOGIC_STRING_1001","ty","NotificationCenter","trigger","hall","EventType","HALL_POP_COMMON_MSG_BOX_SMALL","text","duration","useDicardCard","cards","i","push","_info","_number","_mySeatinfo","playCards","_removeSelectedCards","_refreshCardsLayer","refreshNoteCardWhenUseProp","useRedealCard","_initCardsInSingle","_isDizhu","_mySeatIndex","_insertExtraCards","isType","Enums","PlayType","PLAY_TYPE_LAIZI","_resetPlayerCardsWithLaizi","_rankCardsWithLaizi","findCard","id","_cards","findCardSprite","getSprite","useChangeCard","srcIdx","initCardPos","getPosition","AIRobots","exchangeCard","_setSingleCardsInfo","dstPos","convertToWorldSpace","Card","CardSize","CARD_SIZE_MIDDLE","resetWithNum","fromSprite","setPosition","_leftPlayerController","getHeadPosOnScr","view","ccbRootNode","addChild","moveAction","cc","Spawn","create","MoveTo","ScaleTo","call","CallFunc","reachPlayerHand","runAction","Sequence","CARD_SIZE_BIG","toLeftSprite","moveAction2","call2","reachLeftPlayerHand","_isUserInteractive","removeFromParent","destroy","setExchangeCardSelected","init","gameContent","listen","SingleEventType","SINGLE_EVT_APPLY_FOR_USING_PROP","onApplyForUsingProp","clear","ignore","reset","propId","LOGD","useSucess","reportEvt","singlePropButton","btnTags","EXCHANGE_CARD","countEvent","ddz_PROP_USE_CHANGE_CARD","REDEAL_CARD","ddz_PROP_USE_REDEAL_CARD","DISCARD_CARD","ddz_PROP_USE_DISCARD_CARD","DOUBLE_CARD","ddz_PROP_USE_DOUBLE_CARD","PROTOTECT_CARD","ddz_PROP_USE_PROTECT_CARD","reportHelper","report","SINGLE_EVT_PROP_USED"],"mappings":"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","file":"ddzsingle_prop_logic.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/singleAI","sourcesContent":["// \n// File : offline_prop_logic.js\n// \n// Function : 单机道具的使用逻辑\n// \n// Author : WangHp\n// \n// Date : 2015/2/27\n// \n\nddz.offLinePropLogic = function() {\n\tvar tag = 'ddz.offlinePropLogic';\n\tvar playContent = null;\n\tvar isDoubleGain = false;\n\tvar isAvoidLose = false;\n\tvar fromLeftCard = null; // 从上家换来的牌对象\n\tvar toLeftCard = null; // 换给上家的牌\n\tvar exchangeGetCardSprite = null; // 换牌得来的精灵\n\tvar exchangeGetId = null;\n\n\tvar obj = {};\n\t\n\t// 使用双倍卡\n\tvar useDoubleGain = function() {\n\t\tisDoubleGain = true;\n\t\tplayContent._bottomController['icon_double'].setVisible(true);\n\t\treturn true;\n\t};\n\n\t// 使用保护卡\n\tvar useAvoidLose = function() {\n\t\tisAvoidLose = true;\n\t\tplayContent._bottomController['icon_protect'].setVisible(true);\n\t\treturn true;\n\t};\n\n\t// 检测选中的牌\n\t//监测选中的牌数\n\tvar checkPropWorkOnCard = function() {\n\t\tif(playContent._selectedCards.length == 1) {\n\t\t\treturn true;\n\t\t}\n\n\t\tvar str = ddz.STRING.DDZ_OFFLINE_PROP_LOGIC_STRING_1000;\n\t\tif (playContent._selectedCards.length > 1) {\n\t\t\tstr = ddz.STRING.DDZ_OFFLINE_PROP_LOGIC_STRING_1001;\n\t\t}\n\t\t//弹提示信息\n\t\tty.NotificationCenter.trigger(hall.EventType.HALL_POP_COMMON_MSG_BOX_SMALL, {\n\t\t            text:str,\n\t\t            duration:1\n\t\t});\n\n\t\treturn false;\n\t};\n\n\t// 使用弃牌卡\n\tvar useDicardCard = function() {\n\t\tif (!checkPropWorkOnCard()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar cards = [];\n\t\tfor (var i = 0; i < playContent._selectedCards.length; i++) {\n\t\t\tcards.push(playContent._selectedCards[i]._info._number);\n\t\t}\n\n\t\t//弃牌使用出牌的逻辑\n\t\tplayContent._mySeatinfo.playCards(cards);\n\t\tplayContent._removeSelectedCards();\n\t\tplayContent._refreshCardsLayer();\n\t\tplayContent.refreshNoteCardWhenUseProp();\n\t\t\n\t\treturn true;\n\t};\n\n\t// 使用重发卡\n\tvar useRedealCard = function() {\n\t\t//重发卡\n\t\tplayContent._initCardsInSingle();\n\t\tplayContent._refreshCardsLayer();\n\n\t\tif (playContent._isDizhu(playContent._mySeatIndex)){\n\t\t\tplayContent._insertExtraCards();\n\t\t}\n\t\t\n\t\t// 癞子场       \n\t\tif (playContent.isType(ddz.Enums.PlayType.PLAY_TYPE_LAIZI)) {\n\t\t\tplayContent._resetPlayerCardsWithLaizi();\n\t\t\tplayContent._rankCardsWithLaizi(); // 手牌中有癞子牌时从新对手牌进行排序\n\t\t\tplayContent._refreshCardsLayer();\n\t\t}\n\n\n\t\treturn true;\n\t};\n\n\tvar findCard = function(id) {\n\t\t//寻找换来的牌\n\t\tfor (var i=0; i<playContent._cards.length; i++) {\n\t\t\tif(playContent._cards[i]._info._number != id){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\treturn playContent._cards[i];\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tvar findCardSprite = function(id) {\n\t\t//寻找换来的牌\n\t\tfor (var i=0; i<playContent._cards.length; i++) {\n\t\t\tif(playContent._cards[i]._info._number != id){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\treturn playContent._cards[i].getSprite();\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tvar useChangeCard = function() {\n\t\tif (!checkPropWorkOnCard()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar srcIdx = playContent._selectedCards[0]._info._number;\n\t\tvar initCardPos = findCardSprite(srcIdx).getPosition();\n\n\t\texchangeGetId = ddz.AIRobots.exchangeCard(srcIdx);\n\t\t// 设置牌的信息\n\t\tplayContent._setSingleCardsInfo();\n\t\tplayContent._refreshCardsLayer();\n\n\t\texchangeGetCardSprite = null;\n\t\t//寻找换来的牌\n\t\texchangeGetCardSprite = findCardSprite(exchangeGetId);\n\t\texchangeGetCardSprite.setVisible(false);\n\n\t\tvar dstPos = playContent['cards_cover_layer'].convertToWorldSpace(exchangeGetCardSprite.getPosition());\n\n\t\t// 从头像左侧过来的牌\n\t\tfromLeftCard = new ddz.Card(ddz.Enums.CardSize.CARD_SIZE_MIDDLE);\n\t\tfromLeftCard.resetWithNum(exchangeGetId);\n\t\tvar fromSprite = fromLeftCard.getSprite();\n\t\tfromSprite.setPosition(playContent._leftPlayerController.getHeadPosOnScr());\n\t\tplayContent.view.ccbRootNode.addChild(fromSprite);\n\n\t\t// 直线运动、放大\n\t\tvar moveAction = cc.Spawn.create(cc.MoveTo.create(1, dstPos), cc.ScaleTo.create(0.9, 1.5));\n\t\tvar call = cc.CallFunc.create(obj.reachPlayerHand, obj);\n\t\tfromSprite.runAction(cc.Sequence.create(moveAction, call));\n\n\t\t// 从玩家处到左面玩家的牌\n\t\ttoLeftCard = new ddz.Card(ddz.Enums.CardSize.CARD_SIZE_BIG);\n\t\ttoLeftCard.resetWithNum(srcIdx);\n\t\tvar toLeftSprite = toLeftCard.getSprite();\n\t\ttoLeftSprite.setPosition(playContent['cards_cover_layer'].convertToWorldSpace(initCardPos));\n\t\tplayContent.view.ccbRootNode.addChild(toLeftSprite);\n\n\t\t// 直线运动 缩小运动\n\t\tvar moveAction2 = cc.Spawn.create(cc.MoveTo.create(1, playContent._leftPlayerController.getHeadPosOnScr()), cc.ScaleTo.create(0.9, 0.5));\n\t\tvar call2 = cc.CallFunc.create(obj.reachLeftPlayerHand, obj);\n\t\ttoLeftSprite.runAction(cc.Sequence.create(moveAction2, call2));\n\n\t\t// 不能操作手牌\n\t\tplayContent._isUserInteractive = false;\n\n\t\treturn true;\n\t};\n\n\tobj.reachPlayerHand = function() {\n\t\tvar fromSprite = fromLeftCard.getSprite();\n\t\tfromSprite.setVisible(false);\n\t\tfromSprite.removeFromParent();\n\t\tfromLeftCard.destroy();\n\t\tfromLeftCard = null;\n\t\texchangeGetCardSprite.setVisible(true);\n\t\texchangeGetCardSprite = null;\n\t};\n\n\tobj.reachLeftPlayerHand = function() {\n\t\tvar toLeftSprite = toLeftCard.getSprite();\n\t\ttoLeftSprite.setVisible(false);\n\t\ttoLeftSprite.removeFromParent();\n\t\ttoLeftCard.destroy();\n\t\ttoLeftCard = null;\n\t\tplayContent._isUserInteractive = true;\n\t\tplayContent.refreshNoteCardWhenUseProp();\n\n\t\tif (exchangeGetId != null) {\n\t\t\tvar exchangeCard = findCard(exchangeGetId);\n\t\t\tplayContent.setExchangeCardSelected(exchangeCard);\n\t\t\texchangeGetId = null;\n\t\t}\n\t},\n\n\tobj.init = function(gameContent) {\n\t\tplayContent = gameContent;\n\t\t// 监听事件\n\t\tty.NotificationCenter.listen(ddz.SingleEventType.SINGLE_EVT_APPLY_FOR_USING_PROP, obj.onApplyForUsingProp, obj);\n\t};\n\n\tobj.clear = function() {\n\t\t// 取消监听相关事件\n\t\tty.NotificationCenter.ignore(ddz.SingleEventType.SINGLE_EVT_APPLY_FOR_USING_PROP, obj.onApplyForUsingProp, obj);\n\t\tplayContent = null;\n\t};\n\n\tobj.reset = function() {\n\t\tisDoubleGain = false;\n\t\tisAvoidLose = false;\n\n\t\tplayContent._bottomController['icon_double'].setVisible(false);\n\t\tplayContent._bottomController['icon_protect'].setVisible(false);\n\t};\n\n\tobj.isDoubleGain = function() {\n\t\treturn isDoubleGain;\n\t};\n\n\tobj.isAvoidLose = function() {\n\t\treturn isAvoidLose;\n\t};\n\n\tobj.onApplyForUsingProp = function(propId) {\n\n\t\tddz.LOGD(tag, 'ddz_robot.js onApplyForUsingProp 000000000000000000000000');\n\n\t\tvar useSucess = false;\n\t\tvar reportEvt = '';\n\t\tswitch(propId){\n\t\t\tcase ddz.singlePropButton.btnTags.EXCHANGE_CARD:\n\t\t\t\t//换牌卡\n\t\t\t\tuseSucess = useChangeCard();\n\t\t\t\treportEvt = ddz.countEvent.ddz_PROP_USE_CHANGE_CARD;\n\t\t\t\tbreak;\n\n\t\t\tcase ddz.singlePropButton.btnTags.REDEAL_CARD:\n\t\t\t\t//重发卡\n\t\t\t\tuseSucess = useRedealCard();\n\t\t\t\treportEvt = ddz.countEvent.ddz_PROP_USE_REDEAL_CARD;\n\t\t\t\tbreak;\n\n\t\t\tcase ddz.singlePropButton.btnTags.DISCARD_CARD:\n\t\t\t\t//弃牌卡\n\t\t\t\tuseSucess = useDicardCard();\n\t\t\t\treportEvt = ddz.countEvent.ddz_PROP_USE_DISCARD_CARD;\n\t\t\t\tbreak;\n\n\t\t\tcase ddz.singlePropButton.btnTags.DOUBLE_CARD:\n\t\t\t\t//双倍卡\n\t\t\t\tuseSucess = useDoubleGain();\n\t\t\t\treportEvt = ddz.countEvent.ddz_PROP_USE_DOUBLE_CARD;\n\t\t\t\tbreak;\n\n\t\t\tcase ddz.singlePropButton.btnTags.PROTOTECT_CARD:\n\t\t\t\t//保护卡\n\t\t\t\tuseSucess = useAvoidLose();\n\t\t\t\treportEvt = ddz.countEvent.ddz_PROP_USE_PROTECT_CARD;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tddz.LOGD(tag, \"Error : get an bad prop id, please check it !\" );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (!useSucess) {\n\t\t\t//使用不成功\n\t\t\tddz.LOGD(tag, \"Use local prop failed, please check it !\");\n\t\t\treturn;\n\t\t}\n\t\t// 上报\n\t\tddz.reportHelper.report(reportEvt);\n\t\t\n\t\t//减少使用的道具数量，进行更信通知更新道具数量\n\t\tty.NotificationCenter.trigger(ddz.SingleEventType.SINGLE_EVT_PROP_USED, propId);\n\t};\n\n\treturn obj;\n};\n"]}
{"version":3,"sources":["../../../../../../assets/Script/ComponentScript/window/assets/Script/ComponentScript/window/ddz_game_result.js"],"names":["cc","Class","extends","Component","properties","betLabel_0","default","type","Label","betLabel_1","betLabel_2","betLabel_3","betLabel_4","failBetLabel_0","failBetLabel_1","failBetLabel_2","failBetLabel_3","failBetLabel_4","winLight","Node","loseLight","winNode","failNode","doubleHalve","winLabel","failLabel","nextBtn","Button","shareButton","btnText","timeNumber","shareType","shareData","rewardSpr","Sprite","rewardSpriteFrame","SpriteFrame","onLoad","ty","NotificationCenter","listen","ddz","EventType","UPDATE_SHARE_STATE","updateShareState","setTableScene","tableScene","_tableScene","nextBtnAction","node","active","stopAni","onClickSureBtn","Share","onShareType","clickStatShareTypeGoldDoubleHalve","win","spriteFrame","winLoseGold","chip","hall","ME","getChip","setChip","_mySeatinfo","model","m_buyinChip","anim","getComponent","Animation","play","_goldPanel","initScore","rewardBtn","BiLog","clickStat","UserInfo","clickStatEventType","clickStatEventTypeButtonClick","_config","gameConfig","getShareVideoConfigToCity","shareWithType","animationCom","ani","getAnimationState","stop","backAction","AudioHelper","playEffect","EffectPath_mp3","back_button_click_sound","show","result","mySeatIndex","dizhuWin","dizhuwin","isWin","stat","dizhu","call","bc","bomb","Math","pow","chuntian","base","ismulit","string","parseInt","gameResultPanel","update","dt","rotation","onDestroy","ignoreScope","almsWindow","adManager","destroyWidthBannerAd"],"mappings":"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","file":"ddz_game_result.js","sourceRoot":"../../../../../../assets/Script/ComponentScript/window","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // resultSpr : {\n        //     default : null,\n        //     type : cc.Sprite\n        // },\n        // sprFrame : [\n        //     cc.SpriteFrame\n        // ],\n        betLabel_0 : {\n            default : null,\n            type : cc.Label\n        },\n        betLabel_1 : {\n            default : null,\n            type : cc.Label\n        },\n        betLabel_2 : {\n            default : null,\n            type : cc.Label\n        },\n        betLabel_3 : {\n            default : null,\n            type : cc.Label\n        },\n        betLabel_4 : {\n            default : null,\n            type : cc.Label\n        },\n        failBetLabel_0 : {\n            default : null,\n            type : cc.Label\n        },\n        failBetLabel_1 : {\n            default : null,\n            type : cc.Label\n        },\n        failBetLabel_2 : {\n            default : null,\n            type : cc.Label\n        },\n        failBetLabel_3 : {\n            default : null,\n            type : cc.Label\n        },\n        failBetLabel_4 : {\n            default : null,\n            type : cc.Label\n        },\n\n        winLight:cc.Node,\n        loseLight:cc.Node,\n        winNode : cc.Node,\n        failNode : cc.Node,\n        doubleHalve:cc.Node,\n        winLabel : cc.Label,\n        failLabel : cc.Label,\n        nextBtn : cc.Button,\n        shareButton : cc.Button,\n        btnText:cc.Label,\n        timeNumber : 5,\n        shareType : \"\",\n        shareData : \"\",\n        // hasClickNext : false\n        rewardSpr:cc.Sprite,\n        rewardSpriteFrame:[cc.SpriteFrame],\n    },\n\n    onLoad:function () {\n        ty.NotificationCenter.listen(ddz.EventType.UPDATE_SHARE_STATE,this.updateShareState,this);\n    },\n\n    setTableScene:function (tableScene) {\n        this._tableScene = tableScene;\n    },\n\n    nextBtnAction:function () {\n        this.node.active = false;\n        this.stopAni();\n        this._tableScene.onClickSureBtn();\n    },\n\n    updateShareState:function(shareType){\n        if (shareType == ddz.Share.onShareType.clickStatShareTypeGoldDoubleHalve){\n            this.shareButton.node.active = false;\n            this.rewardSpr.node.active = true;\n            if (this.win) {\n                this.rewardSpr.spriteFrame = this.rewardSpriteFrame[0];\n            }else {\n                this.rewardSpr.spriteFrame = this.rewardSpriteFrame[1];\n                this.winLoseGold /= 2;\n            }\n            var chip = hall.ME.getChip() + this.winLoseGold;\n            hall.ME.setChip(chip);\n            this._tableScene._mySeatinfo.model.m_buyinChip = chip;\n            var anim = this.doubleHalve.getComponent(cc.Animation);\n            anim.play('djddz_jiesuan_fbjb');\n            this._tableScene._goldPanel.initScore();\n        }\n    },\n\n    rewardBtn:function(){\n        ty.BiLog.clickStat(ty.UserInfo.clickStatEventType.clickStatEventTypeButtonClick,\n            [\"rewardBtn\",\"click\"]);\n        var _config = ddz.gameConfig.getShareVideoConfigToCity();\n        if (_config && _config[\"doubleHalve\"].type == \"share\") {\n            ddz.Share.shareWithType(ddz.Share.onShareType.clickStatShareTypeGoldDoubleHalve);\n        }\n\n    },\n\n    stopAni:function(){\n        var animationCom = this.winNode.getComponent(cc.Animation);\n        var ani = animationCom.getAnimationState('djddz_jiesuan_sl');\n        ani.stop();\n\n        animationCom = this.failNode.getComponent(cc.Animation);\n        ani = animationCom.getAnimationState('djddz_jiesuan_sb');\n        ani.stop();\n\n        animationCom = this.doubleHalve.getComponent(cc.Animation);\n        ani = animationCom.getAnimationState('djddz_jiesuan_fbjb');\n        ani.stop();\n    },\n\n    backAction : function () {\n        ddz.AudioHelper.playEffect(ddz.EffectPath_mp3.back_button_click_sound, false);\n\n    },\n    \n    show:function (result) {\n        this.shareButton.node.active = true;\n        this.rewardSpr.node.active = false;\n        this.winLoseGold = 0;\n        var mySeatIndex = result.mySeatIndex;\n        var dizhuWin = result.dizhuwin;\n        var isWin = false;\n\n        if (mySeatIndex == result.stat.dizhu){\n            isWin = dizhuWin;\n        }\n        else{\n            isWin = !dizhuWin;\n        }\n        this.win = isWin;\n        // var mySeatInfo = result['seat' + mySeatIndex];\n        // var delta = mySeatInfo[0];\n        // var deltaAll = mySeatInfo[12];\n        //\n        // if (delta > 0){\n        //     delta = \"+\"+ delta;\n        // }\n\n        var anim;\n        var call = result.stat.call;\n        var bc = result.stat.bomb;\n        bc = Math.pow(2, bc);\n        var chuntian = result.stat.chuntian;\n        var base = result.stat.base;\n        var ismulit = 1;\n        if (mySeatIndex == result.stat.dizhu){\n            ismulit *= 2;\n        }\n        var _config = ddz.gameConfig.getShareVideoConfigToCity();\n        if (_config && _config[\"doubleHalve\"].type == \"none\") {\n            this.shareButton.node.active = false;\n        }\n        if(isWin){\n            this.winNode.active = true;\n            this.failNode.active = false;\n\n            anim = this.winNode.getComponent(cc.Animation);\n            anim.play('djddz_jiesuan_sl');\n\n            this.btnText.string = \"分享双倍\";\n\n            this.betLabel_0.string = base;\n            this.betLabel_1.string = call + \"倍\";\n            this.betLabel_2.string = bc > 1 ? parseInt(bc) + \"倍\" : \"--\";\n            this.betLabel_3.string = chuntian > 1 ? chuntian + \"倍\" : \"--\";\n            this.betLabel_4.string = parseInt(call * bc * chuntian) + \"倍\";\n\n            this.winLabel.string = \"+\" + parseInt(call * bc * chuntian * base * ismulit);\n            this.winLoseGold = parseInt(call * bc * chuntian * base * ismulit);\n        }else {\n            this.winNode.active = false;\n            this.failNode.active = true;\n            anim = this.failNode.getComponent(cc.Animation);\n            anim.play('djddz_jiesuan_sb');\n            this.btnText.string = \"分享减半\";\n            this.failBetLabel_0.string = base;\n            this.failBetLabel_1.string = call + \"倍\";\n            this.failBetLabel_2.string = bc > 1 ? parseInt(bc) + \"倍\" : \"--\";\n            this.failBetLabel_3.string = chuntian > 1 ? chuntian + \"倍\" : \"--\";\n            this.failBetLabel_4.string = parseInt(call * bc * chuntian) + \"倍\";\n            this.failLabel.string = \"-\" + parseInt(call * bc * chuntian * base * ismulit);\n            this.winLoseGold = parseInt(call * bc * chuntian * base * ismulit);\n            // if(!result.winShare && !result.loseShare) {\n            //     var chip = hall.ME.getChip();\n            //     if (chip < 1000){\n            //         ddz.gameModel.checkShareReward(ddz.Share.SharePointType.alms);\n            //     }\n            // }\n        }\n        // this.resultSpr.spriteFrame = this.sprFrame[isWin ? 0 : 1];\n        this.node.active = true;\n\n        ddz.gameResultPanel = this;\n    },\n\n    update:function(dt){\n        if (this.winLight.active) {\n            this.winLight.rotation += 0.3;\n        }\n        if (this.loseLight.active) {\n            this.winLight.rotation += 0.3;\n        }\n    },\n\n    onDestroy :function () {\n        ty.NotificationCenter.ignoreScope(this);\n        this._tableScene = null;\n        ddz.gameResultPanel = null;\n        ddz.almsWindow = null;\n        hall.adManager.destroyWidthBannerAd();\n    }\n});\n"]}